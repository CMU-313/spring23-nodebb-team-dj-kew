"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[2840,2344],{78989:(j,D,I)=>{var k,T;k=[I(31369)],T=function(E){const g={};return g.init=function(){$("body").on("click",'[component="pagination/select-page"]',function(){return E.prompt("[[global:enter_page_number]]",function(u){g.loadPage(u)}),!1})},g.loadPage=function(u,y){if(y=y||function(){},u=parseInt(u,10),!utils.isNumber(u)||u<1||u>ajaxify.data.pagination.pageCount)return;const o=utils.params();o.page=u;const c=window.location.pathname+"?"+$.param(o);ajaxify.go(c,y)},g.nextPage=function(u){g.loadPage(ajaxify.data.pagination.currentPage+1,u)},g.previousPage=function(u){g.loadPage(ajaxify.data.pagination.currentPage-1,u)},g}.apply(D,k),T!==void 0&&(j.exports=T)},7927:(j,D,I)=>{var k,T;k=[I(32230),I(7237),I(85233)],T=function(E,g,u){const y={};y.alert=function(n){n.alert_id="alert_button_"+(n.alert_id?n.alert_id:new Date().getTime()),n.title=n.title&&n.title.trim()||"",n.message=n.message?n.message.trim():"",n.type=n.type||"info";const l=$("#"+n.alert_id);l.length?c(l,n):o(n)},y.success=function(n,l){y.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:n,type:"success",timeout:l||5e3})},y.error=function(n,l){if(n=n&&n.message||n,n==="[[error:revalidate-failure]]"){socket.disconnect(),app.reconnect();return}y.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:n,type:"danger",timeout:l||1e4})},y.remove=function(n){$("#alert_button_"+n).remove()};function o(n){app.parseAndTranslate("alert",n,function(l){let f=$("#"+n.alert_id);if(f.length)return c(f,n);f=l,f.fadeIn(200),g.get("toaster/tray").prepend(f),typeof n.closefn=="function"&&f.find("button").on("click",function(){return n.closefn(),d(f),!1}),n.timeout&&B(f,n),typeof n.clickfn=="function"&&f.addClass("pointer").on("click",function(_){$(_.target).is(".close")||n.clickfn(f,n),d(f)}),u.fire("action:alert.new",{alert:f,params:n})})}function c(n,l){n.find("strong").translateHtml(l.title),n.find("p").translateHtml(l.message),n.attr("class","alert alert-dismissable alert-"+l.type+" clearfix"),clearTimeout(parseInt(n.attr("timeoutId"),10)),l.timeout&&B(n,l),u.fire("action:alert.update",{alert:n,params:l}),n.off("click").removeClass("pointer"),typeof l.clickfn=="function"&&n.addClass("pointer").on("click",function(f){$(f.target).is(".close")||l.clickfn(),d(n)})}function d(n){n.fadeOut(500,function(){$(this).remove()})}function B(n,l){const f=l.timeout,_=setTimeout(function(){d(n),typeof l.timeoutfn=="function"&&l.timeoutfn(n,l)},f);n.attr("timeoutId",_),n.css("transition-property","none"),n.removeClass("animate"),setTimeout(function(){n.css("transition-property",""),n.css("transition","width "+(f+450)+"ms linear, background-color "+(f+450)+"ms ease-in"),n.addClass("animate"),u.fire("action:alert.animate",{alert:n,params:l})},50),n.on("mouseenter",function(){$(this).css("transition-duration",0)})}return y}.apply(D,k),T!==void 0&&(j.exports=T)},42840:(j,D,I)=>{var k,T;k=[I(78989),I(7237),I(85233),I(7927)],T=function(E,g,u,y){const o={};let c=0,d=0,B,n,l,f,_,N=!1,A=!0;o.scrollActive=!1;let r=$(".pagination-block"),V=r.find(".pagination-text"),z=r.find("meter"),G=r.find(".progress-bar"),p,H,J,C,U;$(window).on("action:ajaxify.start",function(){$(window).off("keydown",X)}),o.init=function(t,e,i,s,h){c=0,o.selector=t,o.callback=h,o.toTop=i||function(){},o.toBottom=s||function(){},r=$(".pagination-block"),V=r.find(".pagination-text"),z=r.find("meter"),G=r.find(".progress-bar"),J=$(".scroller-thumb-icon"),C=J.height(),U=C/2,p=$(".scroller-thumb"),H=p.find(".thumb-text"),$(window).off("scroll",o.delayedUpdate).on("scroll",o.delayedUpdate),r.find(".dropdown-menu").off("click").on("click",function(m){m.stopPropagation()}),r.off("shown.bs.dropdown",".wrapper").on("shown.bs.dropdown",".wrapper",function(){setTimeout(async function(){utils.findBootstrapEnvironment()==="lg"&&$(".pagination-block input").focus(),await socket.emit("topics.getPostCountInTopic",ajaxify.data.tid)>0&&r.find("#myNextPostBtn").removeAttr("disabled")},100)}),r.find(".pageup").off("click").on("click",o.scrollUp),r.find(".pagedown").off("click").on("click",o.scrollDown),r.find(".pagetop").off("click").on("click",o.toTop),r.find(".pagebottom").off("click").on("click",o.toBottom),r.find("#myNextPostBtn").off("click").on("click",Q),r.find("input").on("keydown",function(m){if(m.which===13){const a=$(this);if(!utils.isNumber(a.val())){a.val("");return}const w=parseInt(a.val(),10),x=Y(w);a.val(""),$(".pagination-block .dropdown-toggle").trigger("click"),ajaxify.go(x)}}),ajaxify.data.template.topic&&Z(),q(),o.setCount(e),o.update(0)};let W=0;async function Q(){async function t(e){return await socket.emit("topics.getMyNextPostIndex",{tid:ajaxify.data.tid,index:Math.max(1,e),sort:config.topicPostSort})}if(ajaxify.data.template.topic){let e=await t(c);W===e&&(e=await t(e)),e&&c!==e+1?(W=e,$(window).one("action:ajaxify.end",function(){r.find(".dropdown-menu").is(":hidden")&&r.find(".dropdown-toggle").dropdown("toggle")}),o.scrollToIndex(e,!0,0)):(y.alert({message:"[[topic:no-more-next-post]]",type:"info"}),W=1)}}function R(t){const e=p.parent(),i=e.offset();return t<i.top?t=i.top:t>i.top+e.height()-C&&(t=i.top+e.height()-C),t}function S(t){if(!p.length||p.is(":hidden"))return;const e=p.parent(),i=e.offset();let s=(t-1)/ajaxify.data.postcount;t===d&&(s=1);const m={top:R(i.top+(e.height()-C)*s),left:p.offset().left};p.offset(m),H.text(t+"/"+ajaxify.data.postcount),O(t)}function Z(){if(!p.length)return;const t=p.parent();t.on("click",function(a){if($(a.target).hasClass("scroller-container")){const w=e(a.pageY);return o.scrollToIndex(w-1,!0,0),!1}});function e(a){const w=R(a-U),x=t.offset(),M=(w-x.top)/(t.height()-C);return c=Math.max(1,Math.ceil(ajaxify.data.postcount*M)),c>ajaxify.data.postcount?ajaxify.data.count:c}let i=!1;u.on("action:ajaxify.end",function(){_=null}),$(".pagination-block .dropdown-menu").parent().on("shown.bs.dropdown",function(){S(c)}),p.on("mousedown",function(){i=!0,$(window).on("mousemove",h),A=!0});function s(){$(window).off("mousemove",h),i&&(o.scrollToIndex(c-1,!0,0),r.find('[data-toggle="dropdown"]').trigger("click")),F(),i=!1,A=!1}function h(a){const w=R(a.pageY-U);p.offset({top:w,left:p.offset().left});const x=e(a.pageY);return o.updateTextAndProgressBar(),H.text(x+"/"+ajaxify.data.postcount),A&&m(),A=!1,a.stopPropagation(),!1}function m(){F(),n=setInterval(function(){O(c)},250)}$(window).off("mousemove",h),$(window).off("mouseup",s).on("mouseup",s),p.on("touchstart",function(a){N=!0,l=Math.min($(window).width(),Math.max(0,a.touches[0].clientX)),f=Math.min($(window).height(),Math.max(0,a.touches[0].clientY)),A=!0}),p.on("touchmove",function(a){const w=$(window).width(),x=$(window).height(),M=Math.abs(l-Math.min(w,Math.max(0,a.touches[0].clientX))),b=Math.abs(f-Math.min(x,Math.max(0,a.touches[0].clientY)));if(l=Math.min(w,Math.max(0,a.touches[0].clientX)),f=Math.min(x,Math.max(0,a.touches[0].clientY)),b>=M&&A&&(N=!0,m()),N&&a.cancelable){a.preventDefault(),a.stopPropagation();const v=R(f+$(window).scrollTop()-U);p.offset({top:v,left:p.offset().left});const P=e(f+$(window).scrollTop());o.updateTextAndProgressBar(),H.text(P+"/"+ajaxify.data.postcount),A&&O(P)}A=!1}),p.on("touchend",function(){F(),N&&(o.scrollToIndex(c-1,!0,0),N=!1,r.find('[data-toggle="dropdown"]').trigger("click"))})}function F(){n&&(clearInterval(n),n=0)}function O(t,e){e=e||function(){},!(_===t||r.find(".post-content").is(":hidden"))&&(_=t,socket.emit("posts.getPostSummaryByIndex",{tid:ajaxify.data.tid,index:t-1},function(i,s){if(i)return y.error(i);app.parseAndTranslate("partials/topic/navigation-post",{post:s},function(h){r.find(".post-content").html(h).find(".timeago").timeago()}),e()}))}function q(){config.usePagination||$(window).off("keydown",X).on("keydown",X)}function X(t){if(t.target.nodeName==="BODY"){if(t.shiftKey||t.ctrlKey||t.altKey)return;if(t.which===36&&o.toTop)return o.toTop(),!1;if(t.which===35&&o.toBottom)return o.toBottom(),!1}}function Y(t){const i=window.location.pathname.replace(config.relative_path,"").split("/");return i[1]+"/"+i[2]+"/"+i[3]+(t?"/"+t:"")}o.getCount=()=>d,o.setCount=function(t){t=parseInt(t,10),t!==d&&(d=t,o.updateTextAndProgressBar())},o.show=function(){L(!0)},o.disable=function(){d=0,c=1,o.callback=null,o.selector=null,$(window).off("scroll",o.delayedUpdate),L(!1)};function L(t){const e=ajaxify.removeRelativePath(window.location.pathname.slice(1));t&&!e.startsWith("topic")&&!e.startsWith("category")||r.toggleClass("ready",t)}return o.delayedUpdate=function(){B||(B=setTimeout(function(){o.update(),B=void 0},100))},o.update=function(t){t=typeof t=="number"?t:void 0;let e=c;const i=$(o.selector);i.length&&(e=parseInt(i.first().attr("data-index"),10)+1);const s=$(window).scrollTop(),h=$(window).height(),m=$(document).height(),a=s+h/2;let w=Number.MAX_VALUE;i.each(function(){const b=$(this),v=parseInt(b.attr("data-index"),10);if(v>=0){const P=Math.abs(a-(b.offset().top+b.outerHeight(!0)/2));if(P>w)return!1;P<w&&(e=v+1,w=P)}});const x=s===0&&parseInt(i.first().attr("data-index"),10)===0,M=s+h>m-100&&parseInt(i.last().attr("data-index"),10)===d-1;if(x?e=1:M&&(e=d),t===void 0&&ajaxify.data.template.topic)if(x)t=0;else{const b=g.get("post/anchor",c-1);b.length&&(t=b.get(0).getBoundingClientRect().top)}typeof o.callback=="function"&&o.callback(e,d,t),e!==c&&(c=e,o.updateTextAndProgressBar(),S(c)),L(!!d)},o.getIndex=()=>c,o.setIndex=t=>{c=t+1,o.updateTextAndProgressBar(),S(c)},o.updateTextAndProgressBar=function(){if(!utils.isNumber(c))return;c=c>d?d:c,V.translateHtml("[[global:pagination.out_of, "+c+", "+d+"]]");const t=(c-1)/(d-1||1);z.val(t),G.width(t*100+"%")},o.scrollUp=function(){const t=$(window);if(config.usePagination&&t.scrollTop()<=0)return E.previousPage(function(){$("body,html").scrollTop($(document).height()-t.height())});$("body,html").animate({scrollTop:t.scrollTop()-t.height()})},o.scrollDown=function(){const t=$(window);if(config.usePagination&&t.scrollTop()>=$(document).height()-t.height())return E.nextPage();$("body,html").animate({scrollTop:t.scrollTop()+t.height()})},o.scrollTop=function(t){$(o.selector+'[data-index="'+t+'"]').length?o.scrollToIndex(t,!0):ajaxify.go(Y())},o.scrollBottom=function(t){parseInt(t,10)<0||($(o.selector+'[data-index="'+t+'"]').length?o.scrollToIndex(t,!0):(t=parseInt(t,10)+1,ajaxify.go(Y(t))))},o.scrollToIndex=function(t,e,i){const s=!!g.get("topic").length,h=!!g.get("category").length;if(!utils.isNumber(t)||!s&&!h)return;if(i=i!==void 0?i:400,o.scrollActive=!0,s&&g.get("post/anchor",t).length)return o.scrollToPostIndex(t,e,i);if(h&&$('[component="category/topic"][data-index="'+t+'"]').length)return o.scrollToTopicIndex(t,e,i);if(!config.usePagination){o.scrollActive=!1,t=parseInt(t,10)+1,ajaxify.go(Y(t));return}const m=s?o.scrollToPostIndex:o.scrollToTopicIndex,a=1+Math.floor(t/config.postsPerPage);parseInt(a,10)!==ajaxify.data.pagination.currentPage?E.loadPage(a,function(){m(t,e,i)}):m(t,e,i)},o.scrollToPostIndex=function(t,e,i){const s=g.get("post","index",t);o.scrollToElement(s,e,i,t)},o.scrollToTopicIndex=function(t,e,i){const s=$('[component="category/topic"][data-index="'+t+'"]');o.scrollToElement(s,e,i,t)},o.scrollToElement=async(t,e,i,s=null)=>{if(!t.length){o.scrollActive=!1;return}await u.fire("filter:navigator.scroll",{scrollTo:t,highlight:e,duration:i,newIndex:s});const h=t.outerHeight(!0),m=g.get("navbar").outerHeight(!0)||0,a=$(".topic-header").outerHeight(!0)||0,w=$(window).height();$(window).off("scroll",o.delayedUpdate),i=i!==void 0?i:400,o.scrollActive=!0;let x=!1;function M(){function v(){setTimeout(()=>{$(window).on("scroll",o.delayedUpdate),u.fire("action:navigator.scrolled",{scrollTo:t,highlight:e,duration:i,newIndex:s})},50)}function P(){if(x){v();return}x=!0,o.scrollActive=!1,b();const tt=t.get(0).getBoundingClientRect();s?o.setIndex(s):o.update(tt.top)}let K=0;if(h<w-m-a?K=t.offset().top-w/2+h/2:K=t.offset().top-m-a,i===0){$(window).scrollTop(K),P(),v();return}$("html, body").animate({scrollTop:K+"px"},i,P)}function b(){e&&($('[component="post"],[component="category/topic"]').removeClass("highlight"),t.addClass("highlight"),setTimeout(function(){t.removeClass("highlight")},1e4))}M()},o}.apply(D,k),T!==void 0&&(j.exports=T)}}]);
