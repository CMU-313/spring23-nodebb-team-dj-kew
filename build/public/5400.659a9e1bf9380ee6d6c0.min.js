(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[5400,7986,2735,2160],{99398:(j,C,E)=>{"use strict";var A,m;A=[E(83713)],m=function(S){var e={};return e.insertIntoTextarea=function(t,i){var n={context:this,textarea:t,value:i,preventDefault:!1};if($(window).trigger("action:composer.insertIntoTextarea",n),!n.preventDefault){var o=$(n.textarea),r=o.val(),v=o.parents('[component="composer"]');o.val(r.slice(0,n.textarea.selectionStart)+n.value+r.slice(n.textarea.selectionStart)),S.render(v)}},e.wrapSelectionInTextareaWith=function(t,i,n){var o={context:this,textarea:t,leading:i,trailing:n,preventDefault:!1};if($(window).trigger("action:composer.wrapSelectionInTextareaWith",o),!o.preventDefault){n===void 0&&(n=i);var r=$(t),v=r.val(),f=/^(\s*)([\s\S]*?)(\s*)$/.exec(v.slice(t.selectionStart,t.selectionEnd));return f[2]||(f=[null,"",v.slice(t.selectionStart,t.selectionEnd),""]),r.val(v.slice(0,t.selectionStart)+f[1]+i+f[2]+n+f[3]+v.slice(t.selectionEnd)),[f[1].length,f[3].length]}},e.updateTextareaSelection=function(t,i,n){var o={context:this,textarea:t,start:i,end:n,preventDefault:!1};$(window).trigger("action:composer.updateTextareaSelection",o),!o.preventDefault&&(t.setSelectionRange(o.start,o.end),$(o.textarea).focus())},e.getBlockData=function(t,i,n){var o=t.value;i=i.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&");var r=new RegExp(i,"g"),v,f=[],b;for(o=o.split(`
`).reduce(function(s,T){return s!==null||(s=n<=T.length?T:null,s===null&&(n-=T.length+1)),s},null);(v=r.exec(o))!==null;)f.push(v.index);return b={in:!!(f.reduce(function(s,T){return n>=T+2&&(s+=1),s},0)%2),atEnd:f.reduce(function(s,T){return s||n===T},!1)},b.atEnd=b.in?b.atEnd:!1,b},e}.apply(C,A),m!==void 0&&(j.exports=m)},83713:(j,C,E)=>{"use strict";var A,m;A=[E(85233)],m=function(S){var e={};return e.render=function(t,i){if(i=i||function(){},!t.find(".preview-container").is(":visible"))return i();var n=t.find("textarea");socket.emit("plugins.composer.renderPreview",n.val(),function(o,r){o||(r=$("<div>"+r+"</div>"),r.find("img:not(.not-responsive)").addClass("img-responsive"),t.find(".preview").html(r),S.fire("action:composer.preview"),i())})},e.matchScroll=function(t){if(t.find(".preview-container").is(":visible")){var i=t.find("textarea"),n=t.find(".preview");if(i.length&&n.length){var o=i[0].scrollHeight-i.height();if(o===0)return;var r=i.scrollTop()/o;n.scrollTop(Math.max(n[0].scrollHeight-n.height(),0)*r)}}},e.handleToggler=function(t){e.env=utils.findBootstrapEnvironment();var i=t.find(".write-container .toggle-preview"),n=t.find(".preview-container .toggle-preview"),o=$(".preview-container"),r=$(".write-container");function v(){b(!1),e.env!=="xs"&&e.env!=="sm"&&localStorage.setItem("composer:previewToggled",!0)}function f(){b(!0),e.env!=="xs"&&e.env!=="sm"&&localStorage.removeItem("composer:previewToggled")}function b(s){e.env==="xs"||e.env==="sm"?(o.toggleClass("hide",!1),r.toggleClass("maximized",!1),i.toggleClass("hide",!0),o.toggleClass("hidden-xs hidden-sm",!s),r.toggleClass("hidden-xs hidden-sm",s),s&&e.render(t)):(o.toggleClass("hide",!s),r.toggleClass("maximized",!s),i.toggleClass("hide",s)),e.matchScroll(t)}e.toggle=b,n.on("click",function(){v(),t.find(".write").focus()}),i.on("click",function(){f(),t.find(".write").focus()}),localStorage.getItem("composer:previewToggled")||e.env==="xs"||e.env==="sm"?v():f()},e}.apply(C,A),m!==void 0&&(j.exports=m)},6721:(j,C,E)=>{var A,m;A=[E,C,E(32230),E(59006),E(99398),E(75203),E(40646)],m=function(S,e,t,i,n,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toggleForInsert=e.toggle=e.init=e.dialogActions=void 0;var v=$("html");e.dialogActions={open:function(l){return v.addClass("emoji-insert"),l.addClass("open"),l.appendTo(document.fullscreenElement||"body"),l.find(".emoji-dialog-search").focus(),setTimeout(function(){$(document).off("click",f).on("click",f)},0),l},close:function(l){return $(document).off("click",f),v.removeClass("emoji-insert"),l.removeClass("open")}};function f(l){var u=$("#emoji-dialog");!$(l.target).is(".emoji-dialog *")&&u.length&&e.dialogActions.close(u)}var b={people:10,nature:9,food:8,activity:7,travel:6,objects:5,symbols:4,flags:3,regional:2,modifier:1,other:0};config.emojiCustomFirst&&(b.custom=100);var s=t.Translator.create();function T(l,u){return l<u?-1:l>u?1:0}function P(l){Promise.all([$.getJSON(r.base+"/emoji/categories.json?"+r.buster),$.getJSON(r.base+"/emoji/packs.json?"+r.buster),new Promise(function(u){return r.init(u)})]).then(function(u){var c=u[0],w=u[1],g=Object.keys(c).map(function(h){var p=c[h].map(function(a){return r.table[a]});return{name:h,emojis:p.map(function(a){return{name:a.name,html:r.buildEmoji(a,!0)}}).sort(function(a,d){return T(a.name,d.name)})}}).sort(function(h,p){var a=b[h.name]||0,d=b[p.name]||0;return d-a});return i.render("partials/emoji-dialog",{categories:g,packs:w})}).then(function(u){return s.translate(u)}).then(function(u){var c=$(u).appendTo(document.fullscreenElement||"body");c.find(".emoji-dialog-search").on("input",function(a){var d=a.target.value;if(!d){c.find(".emoji-dialog-search-results").addClass("hidden"),c.find(".nav-tabs .emoji-dialog-search-results").next().find("a").tab("show");return}var x=r.search(d).slice(0,100).map(function(D){return'<a class="emoji-link" name="'+D.name+'" href="#">'+r.buildEmoji(D,!1)+"</a>"}).join(`
`);c.find(".tab-pane.emoji-dialog-search-results").html(x),c.find(".emoji-dialog-search-results").removeClass("hidden"),c.find(".nav-tabs .emoji-dialog-search-results a").tab("show")});var w=c.find(".emoji-tabs .tab-content");function g(a){var d=w[0].getBoundingClientRect(),x=Math.ceil(d.width*d.height/(40*40));a.find(".emoji-link img.defer").filter(function(D,I){if(D<=x)return!0;var R=I.getBoundingClientRect();return R.right>d.left&&R.left<d.right&&R.bottom>d.top&&R.top<d.bottom}).removeClass("defer").each(function(D,I){var R=I.getAttribute("data-src");I.setAttribute("src",R)})}var h=c.find(".emoji-tabs .nav-tabs a").click(function(a){a.preventDefault(),$(a.target).tab("show")}).on("show.bs.tab",function(a){g($(a.target.getAttribute("href")))}).eq(1);setTimeout(function(){return h.trigger("show.bs.tab")},10),w.on("scroll",function(){g(w.find(".tab-pane.active"))}),o.apply(w[0]);var p=function(){return e.dialogActions.close(c)};$(window).on(["action:composer.discard","action:composer.submit","action:composer.minimize","action:chat.minimize","action:chat.closed"].join(" "),p),c.find(".close").on("click",p),c.draggable&&c.draggable({handle:".top-bar"}),l(c)}).catch(function(u){console.error("Failed to initialize emoji dialog",u)})}e.init=P;function _(l,u){function c(g){if(g.hasClass("open")){e.dialogActions.close(g);return}g.off("click").on("click",".emoji-link",function(a){a.preventDefault();var d=a.currentTarget.name;u(a,d,g)});var h=l?l.getBoundingClientRect():{top:window.innerHeight/3,left:window.innerWidth/3},p={bottom:"auto",top:"auto",right:"auto",left:"auto"};h.top>440?p.top=h.top-400+"px":p.top=h.top+40+"px",h.left<window.innerWidth/2?p.left=h.left+40+"px":p.left=h.left-400+"px",g.css(p),e.dialogActions.open(g)}var w=$("#emoji-dialog");w.length?c(w):P(c)}e.toggle=_;function k(l,u,c,w){var g;w&&w.target?g=$(w.target):g=$(l).parents(".composer-container").find('[data-format="emoji-add-emoji"]'),g=g[0],_(g,function(h,p){var a=":"+p+": ",d=l.selectionStart,x=l.selectionEnd,D=x+a.length,I=d===x?D:d;n.insertIntoTextarea(l,a),n.updateTextareaSelection(l,I,D),$(l).trigger("input")})}e.toggleForInsert=k}.apply(C,A),m!==void 0&&(j.exports=m)},75203:(j,C,E)=>{"use strict";var A;A=function(){const m={};return m.apply=function(S){$(S).on("mousewheel",function(e){const t=this.scrollTop,i=this.scrollHeight,n=Math.round(this.getBoundingClientRect().height);if(e.originalEvent.deltaY<0&&t===0||e.originalEvent.deltaY>0&&n+t>=i)return!1})},m}.call(C,E,C,j),A!==void 0&&(j.exports=A)}}]);
