"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[7884,7214,9617,6503,3014,6623,9286,8042,8786,5655,3564,831],{15260:(b,C,h)=>{var y,u;y=[h(50431),h(18487),h(50548),h(59006),h(74344),h(31369),h(7927)],u=function(s,f,g,c,i,e,n){const l={};let t={};l.init=function(){$("#category-settings select").each(function(){const o=$(this);o.val(o.attr("data-value"))}),g.init($('[component="category-selector"]'),{onSelect:function(o){ajaxify.go("admin/manage/categories/"+o.cid)},showLinks:!0}),r(),$("#category-settings input, #category-settings select, #category-settings textarea").on("change",function(o){a(o.target)}),$('[data-name="imageClass"]').on("change",function(){$(".category-preview").css("background-size",$(this).val())}),$('[data-name="bgColor"], [data-name="color"]').on("input",function(){const o=$(this),d=o.parents("[data-cid]").find(".category-preview");o.attr("data-name")==="bgColor"?d.css("background-color",o.val()):o.attr("data-name")==="color"&&d.css("color",o.val()),a(o[0])}),$("#save").on("click",function(){const o=$("#tag-whitelist").val()?$("#tag-whitelist").val().split(","):[];if(o.length&&o.length<parseInt($("#cid-min-tags").val(),10))return n.error("[[admin/manage/categories:alert.not-enough-whitelisted-tags]]");const d=ajaxify.data.category.cid;return i.put("/categories/"+d,t).then(p=>{app.flags._unsaved=!1,n.alert({title:"Updated Categories",message:'Category "'+p.name+'" was successfully updated.',type:"success",timeout:5e3}),t={}}).catch(n.error),!1}),$(".purge").on("click",function(o){o.preventDefault(),c.render("admin/partials/categories/purge",{name:ajaxify.data.category.name,topic_count:ajaxify.data.category.topic_count}).then(function(d){const p=e.dialog({title:"[[admin/manage/categories:purge]]",message:d,size:"large",buttons:{save:{label:"[[modules:bootbox.confirm]]",className:"btn-primary",callback:function(){p.find(".modal-footer button").prop("disabled",!0);const m=setInterval(function(){socket.emit("categories.getTopicCount",ajaxify.data.category.cid,function(E,_){if(E)return n.error(E);let v=0;ajaxify.data.category.topic_count>0&&(v=Math.max(0,1-_/ajaxify.data.category.topic_count)*100),p.find(".progress-bar").css({width:v+"%"})})},1e3);return i.del("/categories/"+ajaxify.data.category.cid).then(()=>{m&&clearInterval(m),p.modal("hide"),n.success("[[admin/manage/categories:alert.purge-success]]"),ajaxify.go("admin/manage/categories")}).catch(n.error),!1}}}})})}),$(".copy-settings").on("click",function(){return c.render("admin/partials/categories/copy-settings",{}).then(function(o){let d;const p=e.dialog({title:"[[modules:composer.select_category]]",message:o,buttons:{save:{label:"[[modules:bootbox.confirm]]",className:"btn-primary",callback:function(){if(!(!d||parseInt(d,10)===parseInt(ajaxify.data.category.cid,10)))return socket.emit("admin.categories.copySettingsFrom",{fromCid:d,toCid:ajaxify.data.category.cid,copyParent:p.find("#copyParent").prop("checked")},function(m){if(m)return n.error(m);p.modal("hide"),alert.success("[[admin/manage/categories:alert.copy-success]]"),ajaxify.refresh()}),!1}}}});p.find(".modal-footer button").prop("disabled",!0),g.init(p.find('[component="category-selector"]'),{onSelect:function(m){d=m&&m.cid,d&&p.find(".modal-footer button").prop("disabled",!1)},showLinks:!0})}),!1}),$(".upload-button").on("click",function(){const o=$(this),d=o.attr("data-cid");s.show({title:"[[admin/manage/categories:alert.upload-image]]",route:config.relative_path+"/api/admin/category/uploadpicture",params:{cid:d}},function(p){$("#category-image").val(p),o.parent().parent().siblings(".category-preview").css("background","url("+p+"?"+new Date().getTime()+")"),a($("#category-image"))})}),$("#category-image").on("change",function(){$(".category-preview").css("background-image",$(this).val()?'url("'+$(this).val()+'")':""),a($("#category-image"))}),$(".delete-image").on("click",function(o){o.preventDefault();const d=$("#category-image"),p=$(".category-preview");d.val(""),p.css("background-image",""),a(d[0]),$(this).parent().addClass("hide").hide()}),$(".category-preview").on("click",function(){f.init($(this).find("i"),a)}),$('[type="checkbox"]').on("change",function(){a($(this))}),$('button[data-action="setParent"], button[data-action="changeParent"]').on("click",l.launchParentSelector),$('button[data-action="removeParent"]').on("click",function(){i.put("/categories/"+ajaxify.data.category.cid,{parentCid:0}).then(()=>{$('button[data-action="removeParent"]').parent().addClass("hide"),$('button[data-action="changeParent"]').parent().addClass("hide"),$('button[data-action="setParent"]').removeClass("hide")}).catch(n.error)}),$('button[data-action="toggle"]').on("click",function(){const o=$(this),d=o.attr("data-disabled")==="1";i.put("/categories/"+ajaxify.data.category.cid,{disabled:d?0:1}).then(()=>{o.translateText(d?"[[admin/manage/categories:disable]]":"[[admin/manage/categories:enable]]"),o.toggleClass("btn-primary",!d).toggleClass("btn-danger",d),o.attr("data-disabled",d?0:1)}).catch(n.error)})};function a(o){let d;$(o).is(":checkbox")?d=$(o).is(":checked")?1:0:d=$(o).val();const m=$(o).attr("data-name").match(/[^\][.]+/g);function E(_,v){v!==m.length&&(_[m[v]]=_[m[v]]||{},v===m.length-1&&(_[m[v]]=d),E(_[m[v]],v+1))}m&&m.length&&(m.length===1?t[m[0]]=d:m.length>1&&E(t,0)),app.flags=app.flags||{},app.flags._unsaved=!0}function r(){const o=$("#tag-whitelist");o.tagsinput({confirmKeys:[13,44],trimValue:!0}),ajaxify.data.category.tagWhitelist.forEach(function(d){o.tagsinput("add",d)}),o.on("itemAdded itemRemoved",function(){a(o)})}return l.launchParentSelector=function(){g.modal({onSubmit:function(o){const d=o.cid;d&&i.put("/categories/"+ajaxify.data.category.cid,{parentCid:d}).then(()=>{i.get(`/categories/${d}`,{}).then(function(p){if(p&&p.icon&&p.name){const m='<i class="fa '+p.icon+'"></i> '+p.name;$('button[data-action="changeParent"]').html(m).parent().removeClass("hide")}}),$('button[data-action="removeParent"]').parent().removeClass("hide"),$('button[data-action="setParent"]').addClass("hide")}).catch(n.error)},showLinks:!0})},l}.apply(C,y),u!==void 0&&(b.exports=u)},7927:(b,C,h)=>{var y,u;y=[h(32230),h(7237),h(85233)],u=function(s,f,g){const c={};c.alert=function(t){t.alert_id="alert_button_"+(t.alert_id?t.alert_id:new Date().getTime()),t.title=t.title&&t.title.trim()||"",t.message=t.message?t.message.trim():"",t.type=t.type||"info";const a=$("#"+t.alert_id);a.length?e(a,t):i(t)},c.success=function(t,a){c.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:t,type:"success",timeout:a||5e3})},c.error=function(t,a){if(t=t&&t.message||t,t==="[[error:revalidate-failure]]"){socket.disconnect(),app.reconnect();return}c.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:t,type:"danger",timeout:a||1e4})},c.remove=function(t){$("#alert_button_"+t).remove()};function i(t){app.parseAndTranslate("alert",t,function(a){let r=$("#"+t.alert_id);if(r.length)return e(r,t);r=a,r.fadeIn(200),f.get("toaster/tray").prepend(r),typeof t.closefn=="function"&&r.find("button").on("click",function(){return t.closefn(),n(r),!1}),t.timeout&&l(r,t),typeof t.clickfn=="function"&&r.addClass("pointer").on("click",function(o){$(o.target).is(".close")||t.clickfn(r,t),n(r)}),g.fire("action:alert.new",{alert:r,params:t})})}function e(t,a){t.find("strong").translateHtml(a.title),t.find("p").translateHtml(a.message),t.attr("class","alert alert-dismissable alert-"+a.type+" clearfix"),clearTimeout(parseInt(t.attr("timeoutId"),10)),a.timeout&&l(t,a),g.fire("action:alert.update",{alert:t,params:a}),t.off("click").removeClass("pointer"),typeof a.clickfn=="function"&&t.addClass("pointer").on("click",function(r){$(r.target).is(".close")||a.clickfn(),n(t)})}function n(t){t.fadeOut(500,function(){$(this).remove()})}function l(t,a){const r=a.timeout,o=setTimeout(function(){n(t),typeof a.timeoutfn=="function"&&a.timeoutfn(t,a)},r);t.attr("timeoutId",o),t.css("transition-property","none"),t.removeClass("animate"),setTimeout(function(){t.css("transition-property",""),t.css("transition","width "+(r+450)+"ms linear, background-color "+(r+450)+"ms ease-in"),t.addClass("animate"),g.fire("action:alert.animate",{alert:t,params:a})},50),t.on("mouseenter",function(){$(this).css("transition-duration",0)})}return c}.apply(C,y),u!==void 0&&(b.exports=u)},74344:(b,C,h)=>{var y,u;y=[h(85233)],u=(s=>{const f={},g=config.relative_path+"/api/v3";function c(i,e){i.url=i.url.startsWith("/api")?config.relative_path+i.url:g+i.url;async function n(l){({options:i}=await s.fire("filter:api.options",{options:i})),$.ajax(i).done(t=>{l(null,t&&t.hasOwnProperty("status")&&t.hasOwnProperty("response")?t.response:t||{})}).fail(t=>{let a;t.responseJSON&&(a=t.responseJSON.status&&t.responseJSON.status.message?t.responseJSON.status.message:t.responseJSON.error),l(new Error(a||t.statusText))})}if(typeof e=="function"){n(e);return}return new Promise((l,t)=>{n(function(a,r){a?t(a):l(r)})})}return f.get=(i,e,n)=>c({url:i+(e&&Object.keys(e).length?"?"+$.param(e):"")},n),f.head=(i,e,n)=>c({url:i+(e&&Object.keys(e).length?"?"+$.param(e):""),method:"head"},n),f.post=(i,e,n)=>c({url:i,method:"post",data:JSON.stringify(e||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},n),f.patch=(i,e,n)=>c({url:i,method:"patch",data:JSON.stringify(e||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},n),f.put=(i,e,n)=>c({url:i,method:"put",data:JSON.stringify(e||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},n),f.del=(i,e,n)=>c({url:i,method:"delete",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},n),f.delete=f.del,f}).apply(C,y),u!==void 0&&(b.exports=u)},22905:(b,C,h)=>{var y,u;y=[h(7927)],u=function(s){const f={};return f.init=function(g,c){let i=null;c=c||{},c.privilege=c.privilege||"topics:read",c.states=c.states||["watching","notwatching","ignoring"];let e=[];Array.isArray(c.localCategories)&&(e=c.localCategories.map(r=>({...r}))),c.selectedCids=c.selectedCids||ajaxify.data.selectedCids||[];const n=g.find('[component="category-selector-search"]');if(!n.length)return;const l=n.parent('[component="category/dropdown"]').length>0||n.parent('[component="category-selector"]').length>0;g.on("show.bs.dropdown",function(){l&&(g.find(".dropdown-toggle").addClass("hidden"),n.removeClass("hidden"));function r(){const o=n.find("input").val();o.length>1||!o&&!i?t(o,function(d){i=i||d,a(d)}):!o&&i&&(i.forEach(function(d){d.selected=c.selectedCids.includes(d.cid)}),a(i))}n.on("click",function(o){o.preventDefault(),o.stopPropagation()}),n.find("input").val("").on("keyup",utils.debounce(r,300)),r()}),g.on("shown.bs.dropdown",function(){n.find("input").focus()}),g.on("hide.bs.dropdown",function(){l&&(g.find(".dropdown-toggle").removeClass("hidden"),n.addClass("hidden")),n.off("click"),n.find("input").off("keyup")});function t(r,o){socket.emit("categories.categorySearch",{search:r,query:utils.params(),parentCid:c.parentCid||0,selectedCids:c.selectedCids,privilege:c.privilege,states:c.states,showLinks:c.showLinks},function(d,p){if(d)return s.error(d);o(e.concat(p))})}function a(r){app.parseAndTranslate(c.template,{categoryItems:r.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(o){g.find('[component="category/list"]').replaceWith(o.find('[component="category/list"]')),g.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!r.length)})}},f}.apply(C,y),u!==void 0&&(b.exports=u)},50548:(b,C,h)=>{var y,u;y=[h(22905),h(31369),h(85233)],u=function(s,f,g){const c={};return c.init=function(i,e){if(!i||!i.length)return;e=e||{};const n=e.onSelect||function(){};e.states=e.states||["watching","notwatching","ignoring"],e.template="partials/category-selector",g.fire("action:category.selector.options",{el:i,options:e}),s.init(i,e);const l={el:i,selectedCategory:null};i.on("click","[data-cid]",function(){const a=$(this);if(a.hasClass("disabled"))return!1;l.selectCategory(a.attr("data-cid")),n(l.selectedCategory)});const t=l.el.find('[component="category-selector-selected"]').html();return l.selectCategory=function(a){const r=l.el.find('[data-cid="'+a+'"]');l.selectedCategory={cid:a,name:r.attr("data-name")},r.length?l.el.find('[component="category-selector-selected"]').html(r.find('[component="category-markup"]').html()):l.el.find('[component="category-selector-selected"]').html(t)},l.getSelectedCategory=function(){return l.selectedCategory},l.getSelectedCid=function(){return l.selectedCategory?l.selectedCategory.cid:0},l},c.modal=function(i){i=i||{},i.onSelect=i.onSelect||function(){},i.onSubmit=i.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:i.message},function(e){const n=f.dialog({title:i.title||"[[modules:composer.select_category]]",message:e,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:t}}}),l=c.init(n.find('[component="category-selector"]'),i);function t(a){return a.preventDefault(),l.selectedCategory&&(i.onSubmit(l.selectedCategory),n.modal("hide")),!1}i.openOnLoad&&n.on("shown.bs.modal",function(){n.find(".dropdown-toggle").dropdown("toggle")}),n.find("form").on("submit",t)})},c}.apply(C,y),u!==void 0&&(b.exports=u)},7237:(b,C,h)=>{var y;y=function(){const u={};return u.core={"topic/teaser":function(s){return s?$('[component="category/topic"][data-tid="'+s+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(s,f){return $('[component="topic"][data-'+s+'="'+f+'"]')},post:function(s,f){return $('[component="post"][data-'+s+'="'+f+'"]')},"post/content":function(s){return $('[component="post"][data-pid="'+s+'"] [component="post/content"]')},"post/header":function(s){return $('[component="post"][data-pid="'+s+'"] [component="post/header"]')},"post/anchor":function(s){return $('[component="post"][data-index="'+s+'"] [component="post/anchor"]')},"post/vote-count":function(s){return $('[component="post"][data-pid="'+s+'"] [component="post/vote-count"]')},"post/bookmark-count":function(s){return $('[component="post"][data-pid="'+s+'"] [component="post/bookmark-count"]')},"user/postcount":function(s){return $('[component="user/postcount"][data-uid="'+s+'"]')},"user/reputation":function(s){return $('[component="user/reputation"][data-uid="'+s+'"]')},"category/topic":function(s,f){return $('[component="category/topic"][data-'+s+'="'+f+'"]')},"categories/category":function(s,f){return $('[component="categories/category"][data-'+s+'="'+f+'"]')},"chat/message":function(s){return $('[component="chat/message"][data-mid="'+s+'"]')},"chat/message/body":function(s){return $('[component="chat/message"][data-mid="'+s+'"] [component="chat/message/body"]')},"chat/recent/room":function(s){return $('[component="chat/recent/room"][data-roomid="'+s+'"]')}},u.get=function(){const s=Array.prototype.slice.call(arguments,1);return u.core[arguments[0]]&&s.length?u.core[arguments[0]].apply(this,s):$('[component="'+arguments[0]+'"]')},u}.call(C,h,C,b),y!==void 0&&(b.exports=y)},18487:(b,C,h)=>{var y,u;y=[h(59006),h(31369)],u=function(s,f){const g={};return g.init=function(c,i){i=i||function(){};const e=c.hasClass("fa-2x");let n=c.attr("class").replace("fa-2x","").replace("fa","").replace(/\s+/g,"");if($("#icons .selected").removeClass("selected"),n)try{$("#icons .fa-icons .fa."+n).addClass("selected")}catch{n=""}s.render("partials/fontawesome",{}).then(function(l){l=$(l),l.find(".fa-icons").prepend($('<i class="fa fa-nbb-none"></i>'));const t=f.dialog({onEscape:!0,backdrop:!0,show:!1,message:l,title:"Select an Icon",buttons:{noIcon:{label:"No Icon",className:"btn-default",callback:function(){c.attr("class","fa "+(e?"fa-2x ":"")),c.val(""),c.attr("value",""),i(c)}},success:{label:"Select",className:"btn-primary",callback:function(){const a=$(".bootbox .selected").attr("class")||`fa fa-${$(".bootbox #fa-filter").val()}`,r=$("<div></div>").addClass(a).removeClass("fa").removeClass("selected").attr("class"),o=t.find("input").val();r?(c.attr("class","fa "+(e?"fa-2x ":"")+r),c.val(r),c.attr("value",r)):o&&(c.attr("class",o),c.val(o),c.attr("value",o)),i(c)}}}});t.on("show.bs.modal",function(){const a=$(this),r=a.find("input");n&&(a.find("."+n).addClass("selected"),r.val(n.replace("fa-","")))}).modal("show"),t.on("shown.bs.modal",function(){const a=$(this),r=a.find("input"),o=a.find(".fa-icons i"),d=a.find("button.btn-primary");function p(m){a.find("i.selected").removeClass("selected"),m?m.addClass("selected"):r.val().length===0?n&&a.find("."+n).addClass("selected"):a.find("i:visible").first().addClass("selected")}r.selectRange(0,r.val().length),a.find(".icon-container").on("click","i",function(){r.val($(this).attr("class").replace("fa fa-","").replace("selected","")),p($(this))}),r.on("keyup",function(m){m.keyCode!==13?(o.show(),o.each(function(E,_){_.className.match(new RegExp("^fa fa-.*"+r.val()+".*$"))||$(_).hide()}),p()):d.click()})})})},g}.apply(C,y),u!==void 0&&(b.exports=u)},50431:(b,C,h)=>{var y,u;y=[h(86569)],u=function(){const s={};s.show=function(e,n){const l=e.hasOwnProperty("fileSize")&&e.fileSize!==void 0?parseInt(e.fileSize,10):!1;app.parseAndTranslate("partials/modals/upload_file_modal",{showHelp:e.hasOwnProperty("showHelp")&&e.showHelp!==void 0?e.showHelp:!0,fileSize:l,title:e.title||"[[global:upload_file]]",description:e.description||"",button:e.button||"[[global:upload]]",accept:e.accept?e.accept.replace(/,/g,"&#44; "):""},function(t){t.modal("show"),t.on("hidden.bs.modal",function(){t.remove()});const a=t.find("#uploadForm");a.attr("action",e.route),a.find("#params").val(JSON.stringify(e.params)),t.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),a.submit()}),a.submit(function(){return f(t,l,n),!1})})},s.hideAlerts=function(e){$(e).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function f(e,n,l){g(e,"status","[[uploads:uploading-file]]"),e.find("#upload-progress-bar").css("width","0%"),e.find("#upload-progress-box").show().removeClass("hide");const t=e.find("#fileInput");if(!t.val())return g(e,"error","[[uploads:select-file-to-upload]]");if(!i(t[0],n))return g(e,"error","[[error:file-too-big, "+n+"]]");s.ajaxSubmit(e,l)}function g(e,n,l){s.hideAlerts(e),n==="error"&&e.find("#fileUploadSubmitBtn").removeClass("disabled"),e.find("#alert-"+n).translateText(l).removeClass("hide")}s.ajaxSubmit=function(e,n){e.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(t){t=c(t),g(e,"error",t.responseJSON?t.responseJSON.error||t.statusText:"error uploading, code : "+t.status)},uploadProgress:function(t,a,r,o){e.find("#upload-progress-bar").css("width",o+"%")},success:function(t){let a=c(t);t.hasOwnProperty("response")&&t.hasOwnProperty("status")&&t.status.code==="ok"&&(a=t.response.images),n(a[0].url),g(e,"success","[[uploads:upload-success]]"),setTimeout(function(){s.hideAlerts(e),e.modal("hide")},750)}})};function c(e){if(typeof e=="string")try{return $.parseJSON(e)}catch{return{error:"[[error:parse-error]]"}}return e}function i(e,n){return window.FileReader&&n?e.files[0].size<=n*1e3:!0}return s}.apply(C,y),u!==void 0&&(b.exports=u)}}]);
