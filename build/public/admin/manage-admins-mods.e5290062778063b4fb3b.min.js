"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[7129,7214,9617,6503,3014,8253,6623,9286,8786,5655,831,6193],{38618:(h,y,m)=>{var g,u;g=[m(86193),m(74344),m(31369),m(7927),m(50548)],u=function(s,d,l,a,r){const c={};return c.init=function(){s.user($("#admin-search"),function(t,o){socket.emit("admin.user.makeAdmins",[o.item.user.uid],function(e){if(e)return a.error(e);a.success("[[admin/manage/users:alerts.make-admin-success]]"),$("#admin-search").val(""),!$('.administrator-area [data-uid="'+o.item.user.uid+'"]').length&&app.parseAndTranslate("admin/manage/admins-mods","admins.members",{admins:{members:[o.item.user]}},function(n){$(".administrator-area").prepend(n)})})}),$(".administrator-area").on("click",".remove-user-icon",function(){const t=$(this).parents("[data-uid]"),o=t.attr("data-uid");if(parseInt(o,10)===parseInt(app.user.uid,10))return a.error("[[admin/manage/users:alerts.no-remove-yourself-admin]]");l.confirm("[[admin/manage/users:alerts.confirm-remove-admin]]",function(e){e&&socket.emit("admin.user.removeAdmins",[o],function(n){if(n)return a.error(n.message);a.success("[[admin/manage/users:alerts.remove-admin-success]]"),t.remove()})})}),s.user($("#global-mod-search"),function(t,o){d.put("/groups/global-moderators/membership/"+o.item.user.uid).then(()=>{a.success("[[admin/manage/users:alerts.make-global-mod-success]]"),$("#global-mod-search").val(""),!$('.global-moderator-area [data-uid="'+o.item.user.uid+'"]').length&&app.parseAndTranslate("admin/manage/admins-mods","globalMods.members",{globalMods:{members:[o.item.user]}},function(e){$(".global-moderator-area").prepend(e),$("#no-global-mods-warning").addClass("hidden")})}).catch(a.error)}),$(".global-moderator-area").on("click",".remove-user-icon",function(){const t=$(this).parents("[data-uid]"),o=t.attr("data-uid");l.confirm("[[admin/manage/users:alerts.confirm-remove-global-mod]]",function(e){e&&d.del("/groups/global-moderators/membership/"+o).then(()=>{a.success("[[admin/manage/users:alerts.remove-global-mod-success]]"),t.remove(),$(".global-moderator-area").children().length||$("#no-global-mods-warning").removeClass("hidden")}).catch(a.error)})}),r.init($('[component="category-selector"]'),{parentCid:ajaxify.data.selectedCategory?ajaxify.data.selectedCategory.cid:0,onSelect:function(t){ajaxify.go("admin/manage/admins-mods"+(t.cid?"?cid="+t.cid:""))},localCategories:[]}),s.user($(".moderator-search"),function(t,o){const e=$(t.target),n=$(t.target).attr("data-cid");d.put(`/categories/${n}/moderator/${o.item.user.uid}`,{},function(i){if(i)return a.error(i);a.success("[[admin/manage/users:alerts.make-moderator-success]]"),e.val(""),!$('.moderator-area[data-cid="'+n+'"] [data-uid="'+o.item.user.uid+'"]').length&&app.parseAndTranslate("admin/manage/admins-mods","globalMods.members",{globalMods:{members:[o.item.user]}},function(f){$('.moderator-area[data-cid="'+n+'"]').prepend(f),$('.no-moderator-warning[data-cid="'+n+'"]').addClass("hidden")})})}),$(".moderator-area").on("click",".remove-user-icon",function(){const t=$(this).parents("[data-cid]"),o=t.attr("data-cid"),e=$(this).parents("[data-uid]"),n=e.attr("data-uid");l.confirm("[[admin/manage/users:alerts.confirm-remove-moderator]]",function(i){i&&d.delete(`/categories/${o}/moderator/${n}`,{},function(f){if(f)return a.error(f);a.success("[[admin/manage/users:alerts.remove-moderator-success]]"),e.remove(),t.children().length||$('.no-moderator-warning[data-cid="'+o+'"]').removeClass("hidden")})})})},c}.apply(y,g),u!==void 0&&(h.exports=u)},7927:(h,y,m)=>{var g,u;g=[m(32230),m(7237),m(85233)],u=function(s,d,l){const a={};a.alert=function(e){e.alert_id="alert_button_"+(e.alert_id?e.alert_id:new Date().getTime()),e.title=e.title&&e.title.trim()||"",e.message=e.message?e.message.trim():"",e.type=e.type||"info";const n=$("#"+e.alert_id);n.length?c(n,e):r(e)},a.success=function(e,n){a.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:e,type:"success",timeout:n||5e3})},a.error=function(e,n){if(e=e&&e.message||e,e==="[[error:revalidate-failure]]"){socket.disconnect(),app.reconnect();return}a.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:e,type:"danger",timeout:n||1e4})},a.remove=function(e){$("#alert_button_"+e).remove()};function r(e){app.parseAndTranslate("alert",e,function(n){let i=$("#"+e.alert_id);if(i.length)return c(i,e);i=n,i.fadeIn(200),d.get("toaster/tray").prepend(i),typeof e.closefn=="function"&&i.find("button").on("click",function(){return e.closefn(),t(i),!1}),e.timeout&&o(i,e),typeof e.clickfn=="function"&&i.addClass("pointer").on("click",function(f){$(f.target).is(".close")||e.clickfn(i,e),t(i)}),l.fire("action:alert.new",{alert:i,params:e})})}function c(e,n){e.find("strong").translateHtml(n.title),e.find("p").translateHtml(n.message),e.attr("class","alert alert-dismissable alert-"+n.type+" clearfix"),clearTimeout(parseInt(e.attr("timeoutId"),10)),n.timeout&&o(e,n),l.fire("action:alert.update",{alert:e,params:n}),e.off("click").removeClass("pointer"),typeof n.clickfn=="function"&&e.addClass("pointer").on("click",function(i){$(i.target).is(".close")||n.clickfn(),t(e)})}function t(e){e.fadeOut(500,function(){$(this).remove()})}function o(e,n){const i=n.timeout,f=setTimeout(function(){t(e),typeof n.timeoutfn=="function"&&n.timeoutfn(e,n)},i);e.attr("timeoutId",f),e.css("transition-property","none"),e.removeClass("animate"),setTimeout(function(){e.css("transition-property",""),e.css("transition","width "+(i+450)+"ms linear, background-color "+(i+450)+"ms ease-in"),e.addClass("animate"),l.fire("action:alert.animate",{alert:e,params:n})},50),e.on("mouseenter",function(){$(this).css("transition-duration",0)})}return a}.apply(y,g),u!==void 0&&(h.exports=u)},74344:(h,y,m)=>{var g,u;g=[m(85233)],u=(s=>{const d={},l=config.relative_path+"/api/v3";function a(r,c){r.url=r.url.startsWith("/api")?config.relative_path+r.url:l+r.url;async function t(o){({options:r}=await s.fire("filter:api.options",{options:r})),$.ajax(r).done(e=>{o(null,e&&e.hasOwnProperty("status")&&e.hasOwnProperty("response")?e.response:e||{})}).fail(e=>{let n;e.responseJSON&&(n=e.responseJSON.status&&e.responseJSON.status.message?e.responseJSON.status.message:e.responseJSON.error),o(new Error(n||e.statusText))})}if(typeof c=="function"){t(c);return}return new Promise((o,e)=>{t(function(n,i){n?e(n):o(i)})})}return d.get=(r,c,t)=>a({url:r+(c&&Object.keys(c).length?"?"+$.param(c):"")},t),d.head=(r,c,t)=>a({url:r+(c&&Object.keys(c).length?"?"+$.param(c):""),method:"head"},t),d.post=(r,c,t)=>a({url:r,method:"post",data:JSON.stringify(c||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},t),d.patch=(r,c,t)=>a({url:r,method:"patch",data:JSON.stringify(c||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},t),d.put=(r,c,t)=>a({url:r,method:"put",data:JSON.stringify(c||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},t),d.del=(r,c,t)=>a({url:r,method:"delete",data:JSON.stringify(c),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},t),d.delete=d.del,d}).apply(y,g),u!==void 0&&(h.exports=u)},86193:(h,y,m)=>{var g,u;g=[m(74344),m(7927)],u=function(s,d){const l={},a={delay:200};l.init=c=>{const{input:t,source:o,onSelect:e,delay:n}={...a,...c};app.loadJQueryUI(function(){t.autocomplete({delay:n,open:function(){$(this).autocomplete("widget").css("z-index",100005)},select:function(i,f){r(t,e,i,f)},source:o})})},l.user=function(c,t,o){typeof t=="function"&&(o=t,t={}),t=t||{},l.init({input:c,onSelect:o,source:(e,n)=>{t.query=e.term,s.get("/api/users",t,function(i,f){if(i)return d.error(i);if(f&&f.users){const p=f.users.map(function(C){const _=$("<div></div>").html(C.username).text();return C&&{label:_,value:_,user:{uid:C.uid,name:C.username,slug:C.userslug,username:C.username,userslug:C.userslug,picture:C.picture,banned:C.banned,"icon:text":C["icon:text"],"icon:bgColor":C["icon:bgColor"]}}});n(p)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},l.group=function(c,t){l.init({input:c,onSelect:t,source:(o,e)=>{socket.emit("groups.search",{query:o.term},function(n,i){if(n)return d.error(n);if(i&&i.length){const f=i.map(function(p){return p&&{label:p.name,value:p.name,group:p}});e(f)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},l.tag=function(c,t){l.init({input:c,onSelect:t,delay:100,source:(o,e)=>{socket.emit("topics.autocompleteTags",{query:o.term,cid:ajaxify.data.cid||0},function(n,i){if(n)return d.error(n);i&&e(i),$(".ui-autocomplete a").attr("data-ajaxify","false")})}})};function r(c,t,o,e){t=t||function(){};const n=jQuery.Event("keypress");n.which=13,n.keyCode=13,setTimeout(function(){c.trigger(n)},100),t(o,e)}return l}.apply(y,g),u!==void 0&&(h.exports=u)},22905:(h,y,m)=>{var g,u;g=[m(7927)],u=function(s){const d={};return d.init=function(l,a){let r=null;a=a||{},a.privilege=a.privilege||"topics:read",a.states=a.states||["watching","notwatching","ignoring"];let c=[];Array.isArray(a.localCategories)&&(c=a.localCategories.map(i=>({...i}))),a.selectedCids=a.selectedCids||ajaxify.data.selectedCids||[];const t=l.find('[component="category-selector-search"]');if(!t.length)return;const o=t.parent('[component="category/dropdown"]').length>0||t.parent('[component="category-selector"]').length>0;l.on("show.bs.dropdown",function(){o&&(l.find(".dropdown-toggle").addClass("hidden"),t.removeClass("hidden"));function i(){const f=t.find("input").val();f.length>1||!f&&!r?e(f,function(p){r=r||p,n(p)}):!f&&r&&(r.forEach(function(p){p.selected=a.selectedCids.includes(p.cid)}),n(r))}t.on("click",function(f){f.preventDefault(),f.stopPropagation()}),t.find("input").val("").on("keyup",utils.debounce(i,300)),i()}),l.on("shown.bs.dropdown",function(){t.find("input").focus()}),l.on("hide.bs.dropdown",function(){o&&(l.find(".dropdown-toggle").removeClass("hidden"),t.addClass("hidden")),t.off("click"),t.find("input").off("keyup")});function e(i,f){socket.emit("categories.categorySearch",{search:i,query:utils.params(),parentCid:a.parentCid||0,selectedCids:a.selectedCids,privilege:a.privilege,states:a.states,showLinks:a.showLinks},function(p,C){if(p)return s.error(p);f(c.concat(C))})}function n(i){app.parseAndTranslate(a.template,{categoryItems:i.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(f){l.find('[component="category/list"]').replaceWith(f.find('[component="category/list"]')),l.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!i.length)})}},d}.apply(y,g),u!==void 0&&(h.exports=u)},50548:(h,y,m)=>{var g,u;g=[m(22905),m(31369),m(85233)],u=function(s,d,l){const a={};return a.init=function(r,c){if(!r||!r.length)return;c=c||{};const t=c.onSelect||function(){};c.states=c.states||["watching","notwatching","ignoring"],c.template="partials/category-selector",l.fire("action:category.selector.options",{el:r,options:c}),s.init(r,c);const o={el:r,selectedCategory:null};r.on("click","[data-cid]",function(){const n=$(this);if(n.hasClass("disabled"))return!1;o.selectCategory(n.attr("data-cid")),t(o.selectedCategory)});const e=o.el.find('[component="category-selector-selected"]').html();return o.selectCategory=function(n){const i=o.el.find('[data-cid="'+n+'"]');o.selectedCategory={cid:n,name:i.attr("data-name")},i.length?o.el.find('[component="category-selector-selected"]').html(i.find('[component="category-markup"]').html()):o.el.find('[component="category-selector-selected"]').html(e)},o.getSelectedCategory=function(){return o.selectedCategory},o.getSelectedCid=function(){return o.selectedCategory?o.selectedCategory.cid:0},o},a.modal=function(r){r=r||{},r.onSelect=r.onSelect||function(){},r.onSubmit=r.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:r.message},function(c){const t=d.dialog({title:r.title||"[[modules:composer.select_category]]",message:c,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:e}}}),o=a.init(t.find('[component="category-selector"]'),r);function e(n){return n.preventDefault(),o.selectedCategory&&(r.onSubmit(o.selectedCategory),t.modal("hide")),!1}r.openOnLoad&&t.on("shown.bs.modal",function(){t.find(".dropdown-toggle").dropdown("toggle")}),t.find("form").on("submit",e)})},a}.apply(y,g),u!==void 0&&(h.exports=u)},7237:(h,y,m)=>{var g;g=function(){const u={};return u.core={"topic/teaser":function(s){return s?$('[component="category/topic"][data-tid="'+s+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(s,d){return $('[component="topic"][data-'+s+'="'+d+'"]')},post:function(s,d){return $('[component="post"][data-'+s+'="'+d+'"]')},"post/content":function(s){return $('[component="post"][data-pid="'+s+'"] [component="post/content"]')},"post/header":function(s){return $('[component="post"][data-pid="'+s+'"] [component="post/header"]')},"post/anchor":function(s){return $('[component="post"][data-index="'+s+'"] [component="post/anchor"]')},"post/vote-count":function(s){return $('[component="post"][data-pid="'+s+'"] [component="post/vote-count"]')},"post/bookmark-count":function(s){return $('[component="post"][data-pid="'+s+'"] [component="post/bookmark-count"]')},"user/postcount":function(s){return $('[component="user/postcount"][data-uid="'+s+'"]')},"user/reputation":function(s){return $('[component="user/reputation"][data-uid="'+s+'"]')},"category/topic":function(s,d){return $('[component="category/topic"][data-'+s+'="'+d+'"]')},"categories/category":function(s,d){return $('[component="categories/category"][data-'+s+'="'+d+'"]')},"chat/message":function(s){return $('[component="chat/message"][data-mid="'+s+'"]')},"chat/message/body":function(s){return $('[component="chat/message"][data-mid="'+s+'"] [component="chat/message/body"]')},"chat/recent/room":function(s){return $('[component="chat/recent/room"][data-roomid="'+s+'"]')}},u.get=function(){const s=Array.prototype.slice.call(arguments,1);return u.core[arguments[0]]&&s.length?u.core[arguments[0]].apply(this,s):$('[component="'+arguments[0]+'"]')},u}.call(y,m,y,h),g!==void 0&&(h.exports=g)}}]);
