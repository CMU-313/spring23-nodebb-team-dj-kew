(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[684,3014,1322],{33302:(Ye,Ke,ne)=>{var We,De;We=[ne(19755),ne(74344),ne(40646),ne(32230)],De=function(qe,U,Ee,Ie){"use strict";function G(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var V=G(qe),q=G(U),Y=ajaxify;function A(){}function x(t,e){for(const n in e)t[n]=e[n];return t}function ke(t){return t&&typeof t=="object"&&typeof t.then=="function"}function Ge(t){return t()}function Ze(){return Object.create(null)}function Te(t){t.forEach(Ge)}function xe(t){return typeof t=="function"}function He(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function he(t){return Object.keys(t).length===0}function c(t,e){t.appendChild(e)}function w(t,e,n){t.insertBefore(e,n||null)}function k(t){t.parentNode.removeChild(t)}function me(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function m(t){return document.createElement(t)}function pe(t){return document.createTextNode(t)}function I(){return pe(" ")}function ze(){return pe("")}function B(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function g(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function on(t){return Array.from(t.childNodes)}function et(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function Se(t,e){t.value=e??""}function an(t,e,n,i){t.style.setProperty(e,n,i?"important":"")}function Fe(t,e,n){t.classList[n?"add":"remove"](e)}function un(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}class Et{constructor(e=null){this.a=e,this.e=this.n=null}m(e,n,i=null){this.e||(this.e=m(n.nodeName),this.t=n,this.h(e)),this.i(i)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.childNodes)}i(e){for(let n=0;n<this.n.length;n+=1)w(this.t,this.n[n],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(k)}}let tt;function Ue(t){tt=t}function ut(){if(!tt)throw new Error("Function called outside component initialization");return tt}function cn(t){ut().$$.on_mount.push(t)}function wt(){const t=ut();return(e,n)=>{const i=t.$$.callbacks[e];if(i){const r=un(e,n);i.slice().forEach(s=>{s.call(t,r)})}}}const Je=[],Pe=[],nt=[],ct=[],dn=Promise.resolve();let dt=!1;function fn(){dt||(dt=!0,dn.then(gt))}function ft(t){nt.push(t)}function ht(t){ct.push(t)}let mt=!1;const pt=new Set;function gt(){if(!mt){mt=!0;do{for(let t=0;t<Je.length;t+=1){const e=Je[t];Ue(e),hn(e.$$)}for(Ue(null),Je.length=0;Pe.length;)Pe.pop()();for(let t=0;t<nt.length;t+=1){const e=nt[t];pt.has(e)||(pt.add(e),e())}nt.length=0}while(Je.length);for(;ct.length;)ct.pop()();dt=!1,mt=!1,pt.clear()}}function hn(t){if(t.fragment!==null){t.update(),Te(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ft)}}const it=new Set;let Be;function st(){Be={r:0,c:[],p:Be}}function lt(){Be.r||Te(Be.c),Be=Be.p}function ie(t,e){t&&t.i&&(it.delete(t),t.i(e))}function oe(t,e,n,i){if(t&&t.o){if(it.has(t))return;it.add(t),Be.c.push(()=>{it.delete(t),i&&(n&&t.d(1),i())}),t.o(e)}}function rt(t,e){const n=e.token={};function i(r,s,l,o){if(e.token!==n)return;e.resolved=o;let a=e.ctx;l!==void 0&&(a=a.slice(),a[l]=o);const u=r&&(e.current=r)(a);let d=!1;e.block&&(e.blocks?e.blocks.forEach((p,h)=>{h!==s&&p&&(st(),oe(p,1,1,()=>{e.blocks[h]===p&&(e.blocks[h]=null)}),lt())}):e.block.d(1),u.c(),ie(u,1),u.m(e.mount(),e.anchor),d=!0),e.block=u,e.blocks&&(e.blocks[s]=u),d&&gt()}if(ke(t)){const r=ut();if(t.then(s=>{Ue(r),i(e.then,1,e.value,s),Ue(null)},s=>{if(Ue(r),i(e.catch,2,e.error,s),Ue(null),!e.hasCatch)throw s}),e.current!==e.pending)return i(e.pending,0),!0}else{if(e.current!==e.then)return i(e.then,1,e.value,t),!0;e.resolved=t}}function kt(t,e){oe(t,1,1,()=>{e.delete(t.key)})}function Ct(t,e,n,i,r,s,l,o,a,u,d,p){let h=t.length,_=s.length,v=h;const T={};for(;v--;)T[t[v].key]=v;const f=[],y=new Map,C=new Map;for(v=_;v--;){const M=p(r,s,v),R=n(M);let H=l.get(R);H?i&&H.p(M,e):(H=u(R,M),H.c()),y.set(R,f[v]=H),R in T&&C.set(R,Math.abs(v-T[R]))}const j=new Set,W=new Set;function O(M){ie(M,1),M.m(o,d),l.set(M.key,M),d=M.first,_--}for(;h&&_;){const M=f[_-1],R=t[h-1],H=M.key,Q=R.key;M===R?(d=M.first,h--,_--):y.has(Q)?!l.has(H)||j.has(H)?O(M):W.has(Q)?h--:C.get(H)>C.get(Q)?(W.add(H),O(M)):(j.add(Q),h--):(a(R,l),h--)}for(;h--;){const M=t[h];y.has(M.key)||a(M,l)}for(;_;)O(f[_-1]);return f}function At(t,e){const n={},i={},r={$$scope:1};let s=t.length;for(;s--;){const l=t[s],o=e[s];if(o){for(const a in l)a in o||(i[a]=1);for(const a in o)r[a]||(n[a]=o[a],r[a]=1);t[s]=o}else for(const a in l)r[a]=1}for(const l in i)l in n||(n[l]=void 0);return n}function jt(t){return typeof t=="object"&&t!==null?t:{}}function _t(t,e,n){const i=t.$$.props[e];i!==void 0&&(t.$$.bound[i]=n,n(t.$$.ctx[i]))}function Le(t){t&&t.c()}function Ce(t,e,n,i){const{fragment:r,on_mount:s,on_destroy:l,after_update:o}=t.$$;r&&r.m(e,n),i||ft(()=>{const a=s.map(Ge).filter(xe);l?l.push(...a):Te(a),t.$$.on_mount=[]}),o.forEach(ft)}function Ae(t,e){const n=t.$$;n.fragment!==null&&(Te(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function mn(t,e){t.$$.dirty[0]===-1&&(Je.push(t),fn(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function $e(t,e,n,i,r,s,l=[-1]){const o=tt;Ue(t);const a=t.$$={fragment:null,ctx:null,props:s,update:A,not_equal:r,bound:Ze(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o?o.$$.context:[]),callbacks:Ze(),dirty:l,skip_bound:!1};let u=!1;if(a.ctx=n?n(t,e.props||{},(d,p,...h)=>{const _=h.length?h[0]:p;return a.ctx&&r(a.ctx[d],a.ctx[d]=_)&&(!a.skip_bound&&a.bound[d]&&a.bound[d](_),u&&mn(t,d)),p}):[],a.update(),u=!0,Te(a.before_update),a.fragment=i?i(a.ctx):!1,e.target){if(e.hydrate){const d=on(e.target);a.fragment&&a.fragment.l(d),d.forEach(k)}else a.fragment&&a.fragment.c();e.intro&&ie(t.$$.fragment),Ce(t,e.target,e.anchor,e.customElement),gt()}Ue(o)}class Qe{$destroy(){Ae(this,1),this.$destroy=A}$on(e,n){const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(n),()=>{const r=i.indexOf(n);r!==-1&&i.splice(r,1)}}$set(e){this.$$set&&!he(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var Me=app,ot=config,pn=utils;function Ot(t,e,n){const i=t.slice();return i[36]=e[n],i}function Nt(t,e,n){const i=t.slice();return i[36]=e[n],i}function It(t){let e,n=t[36]+"",i,r,s,l;function o(){return t[32](t[36])}return{c(){e=m("button"),i=pe(n),r=pe(" x"),g(e,"class","btn btn-info btn-xs")},m(a,u){w(a,e,u),c(e,i),c(e,r),s||(l=B(e,"click",o),s=!0)},p(a,u){t=a,u[0]&4&&n!==(n=t[36]+"")&&et(i,n)},d(a){a&&k(e),s=!1,l()}}}function Tt(t){let e,n=t[36]+"",i,r,s,l;function o(){return t[34](t[36])}return{c(){e=m("button"),i=pe(n),r=pe(" x"),g(e,"class","btn btn-info btn-xs")},m(a,u){w(a,e,u),c(e,i),c(e,r),s||(l=B(e,"click",o),s=!0)},p(a,u){t=a,u[0]&8&&n!==(n=t[36]+"")&&et(i,n)},d(a){a&&k(e),s=!1,l()}}}function gn(t){let e,n,i,r,s;return{c(){e=m("button"),n=m("i"),g(n,"class","fa fa-trash"),g(e,"class","btn btn-warning"),g(e,"type","button"),e.disabled=i=t[12]||t[13]},m(l,o){w(l,e,o),c(e,n),r||(s=B(e,"click",t[21]),r=!0)},p(l,o){o[0]&12288&&i!==(i=l[12]||l[13])&&(e.disabled=i)},d(l){l&&k(e),r=!1,s()}}}function _n(t){let e,n,i,r,s;return{c(){e=m("button"),n=m("i"),g(n,"class","fa fa-check"),g(e,"class","btn btn-success"),g(e,"type","button"),e.disabled=i=!t[11]},m(l,o){w(l,e,o),c(e,n),r||(s=B(e,"click",t[20]),r=!0)},p(l,o){o[0]&2048&&i!==(i=!l[11])&&(e.disabled=i)},d(l){l&&k(e),r=!1,s()}}}function St(t){let e,n,i,r,s,l,o,a,u,d,p,h;return{c(){e=m("tr"),n=m("td"),i=m("button"),r=pe("Cancel"),s=I(),l=m("td"),l.innerHTML='<span class="help-block">Are you sure you want to delete this emoji?</span>',o=I(),a=m("td"),u=m("button"),d=pe("Yes"),g(i,"class","btn btn-default"),g(i,"type","button"),i.disabled=t[13],g(l,"colspan",3),g(u,"class","btn btn-danger"),g(u,"type","button"),u.disabled=t[13],g(e,"class","svelte-11gdgpc"),Fe(e,"fadeout",t[13])},m(_,v){w(_,e,v),c(e,n),c(n,i),c(i,r),c(e,s),c(e,l),c(e,o),c(e,a),c(a,u),c(u,d),p||(h=[B(i,"click",t[23]),B(u,"click",t[22])],p=!0)},p(_,v){v[0]&8192&&(i.disabled=_[13]),v[0]&8192&&(u.disabled=_[13]),v[0]&8192&&Fe(e,"fadeout",_[13])},d(_){_&&k(e),p=!1,Te(h)}}}function Lt(t){let e;return{c(){e=m("tr"),e.innerHTML=`<td colspan="${5}"><span><strong>Name</strong> is required</span></td>`,g(e,"class","text-danger svelte-11gdgpc")},m(n,i){w(n,e,i)},d(n){n&&k(e)}}}function Dt(t){let e;return{c(){e=m("tr"),e.innerHTML=`<td colspan="${5}"><span><strong>Image</strong> is required</span></td>`,g(e,"class","text-danger svelte-11gdgpc")},m(n,i){w(n,e,i)},d(n){n&&k(e)}}}function Mt(t){let e;return{c(){e=m("tr"),e.innerHTML=`<td colspan="${5}"><span><strong>Name</strong> can only contain letters, numbers, and <code>_-+.</code></span></td>`,g(e,"class","text-danger svelte-11gdgpc")},m(n,i){w(n,e,i)},d(n){n&&k(e)}}}function Pt(t){let e;return{c(){e=m("tr"),e.innerHTML=`<td colspan="${5}"><span><strong>Aliases</strong> can only contain letters, numbers, and <code>_-+.</code></span></td>`,g(e,"class","text-danger svelte-11gdgpc")},m(n,i){w(n,e,i)},d(n){n&&k(e)}}}function vn(t){let e,n,i,r,s,l,o=Ee.buildEmoji({character:"",pack:"customizations",keywords:[],name:t[0],aliases:t[2],image:t[1]})+"",a,u,d,p,h,_,v,T,f,y,C,j,W,O,M,R,H,Q,_e,se,te,ve,le,ae,be,de,L,ee,X,z,N,D,we,fe=t[2],K=[];for(let E=0;E<fe.length;E+=1)K[E]=It(Nt(t,fe,E));let re=t[3],J=[];for(let E=0;E<re.length;E+=1)J[E]=Tt(Ot(t,re,E));function ye(E,Z){return E[5]||E[18]?_n:gn}let ce=ye(t),b=ce(t),P=(t[12]||t[13])&&St(t),S=t[5]&&t[6].nameRequired&&Lt(),ue=t[5]&&t[6].imageRequired&&Dt(),Oe=t[5]&&t[6].nameInvalid&&Mt(),Ne=t[5]&&t[6].aliasInvalid&&Pt();return{c(){e=m("tr"),n=m("td"),i=m("input"),r=I(),s=m("td"),l=m("button"),a=I(),u=m("form"),d=m("input"),p=I(),h=m("input"),_=I(),v=m("td"),T=m("div"),f=m("input"),y=I(),C=m("div"),j=m("button"),j.textContent="+",W=I(),O=m("span");for(let E=0;E<K.length;E+=1)K[E].c();M=I(),R=m("td"),H=m("div"),Q=m("input"),_e=I(),se=m("div"),te=m("button"),te.textContent="+",ve=I(),le=m("span");for(let E=0;E<J.length;E+=1)J[E].c();ae=I(),be=m("td"),b.c(),de=I(),P&&P.c(),L=I(),S&&S.c(),ee=I(),ue&&ue.c(),X=I(),Oe&&Oe.c(),z=I(),Ne&&Ne.c(),N=ze(),g(i,"type","text"),g(i,"class","form-control emoji-name svelte-11gdgpc"),g(l,"type","button"),g(l,"class","btn btn-default"),g(d,"type","file"),g(d,"name","emojiImage"),g(d,"accept","image/*"),g(h,"type","hidden"),g(h,"name","fileName"),g(u,"action",`${ot.relative_path}/api/admin/plugins/emoji/upload`),g(u,"method","post"),g(u,"enctype","multipart/form-data"),an(u,"display","none"),g(f,"type","text"),g(f,"class","form-control"),g(j,"class","btn btn-default"),g(C,"class","input-group-addon"),g(T,"class","input-group"),g(Q,"type","text"),g(Q,"class","form-control"),g(te,"class","btn btn-default"),g(se,"class","input-group-addon"),g(H,"class","input-group"),g(e,"class","svelte-11gdgpc"),Fe(e,"fadeout",t[13])},m(E,Z){w(E,e,Z),c(e,n),c(n,i),Se(i,t[0]),c(e,r),c(e,s),c(s,l),l.innerHTML=o,c(s,a),c(s,u),c(u,d),t[28](d),c(u,p),c(u,h),t[29](h),t[30](u),c(e,_),c(e,v),c(v,T),c(T,f),Se(f,t[4]),c(T,y),c(T,C),c(C,j),c(v,W),c(v,O);for(let F=0;F<K.length;F+=1)K[F].m(O,null);c(e,M),c(e,R),c(R,H),c(H,Q),Se(Q,t[10]),c(H,_e),c(H,se),c(se,te),c(R,ve),c(R,le);for(let F=0;F<J.length;F+=1)J[F].m(le,null);c(e,ae),c(e,be),b.m(be,null),w(E,de,Z),P&&P.m(E,Z),w(E,L,Z),S&&S.m(E,Z),w(E,ee,Z),ue&&ue.m(E,Z),w(E,X,Z),Oe&&Oe.m(E,Z),w(E,z,Z),Ne&&Ne.m(E,Z),w(E,N,Z),D||(we=[B(i,"input",t[27]),B(l,"click",t[19]),B(f,"input",t[31]),B(j,"click",t[15]),B(Q,"input",t[33]),B(te,"click",t[17])],D=!0)},p(E,Z){if(Z[0]&1&&i.value!==E[0]&&Se(i,E[0]),Z[0]&7&&o!==(o=Ee.buildEmoji({character:"",pack:"customizations",keywords:[],name:E[0],aliases:E[2],image:E[1]})+"")&&(l.innerHTML=o),Z[0]&16&&f.value!==E[4]&&Se(f,E[4]),Z[0]&16388){fe=E[2];let F;for(F=0;F<fe.length;F+=1){const Ve=Nt(E,fe,F);K[F]?K[F].p(Ve,Z):(K[F]=It(Ve),K[F].c(),K[F].m(O,null))}for(;F<K.length;F+=1)K[F].d(1);K.length=fe.length}if(Z[0]&1024&&Q.value!==E[10]&&Se(Q,E[10]),Z[0]&65544){re=E[3];let F;for(F=0;F<re.length;F+=1){const Ve=Ot(E,re,F);J[F]?J[F].p(Ve,Z):(J[F]=Tt(Ve),J[F].c(),J[F].m(le,null))}for(;F<J.length;F+=1)J[F].d(1);J.length=re.length}ce===(ce=ye(E))&&b?b.p(E,Z):(b.d(1),b=ce(E),b&&(b.c(),b.m(be,null))),Z[0]&8192&&Fe(e,"fadeout",E[13]),E[12]||E[13]?P?P.p(E,Z):(P=St(E),P.c(),P.m(L.parentNode,L)):P&&(P.d(1),P=null),E[5]&&E[6].nameRequired?S||(S=Lt(),S.c(),S.m(ee.parentNode,ee)):S&&(S.d(1),S=null),E[5]&&E[6].imageRequired?ue||(ue=Dt(),ue.c(),ue.m(X.parentNode,X)):ue&&(ue.d(1),ue=null),E[5]&&E[6].nameInvalid?Oe||(Oe=Mt(),Oe.c(),Oe.m(z.parentNode,z)):Oe&&(Oe.d(1),Oe=null),E[5]&&E[6].aliasInvalid?Ne||(Ne=Pt(),Ne.c(),Ne.m(N.parentNode,N)):Ne&&(Ne.d(1),Ne=null)},i:A,o:A,d(E){E&&k(e),t[28](null),t[29](null),t[30](null),me(K,E),me(J,E),b.d(),E&&k(de),P&&P.d(E),E&&k(L),S&&S.d(E),E&&k(ee),ue&&ue.d(E),E&&k(X),Oe&&Oe.d(E),E&&k(z),Ne&&Ne.d(E),E&&k(N),D=!1,Te(we)}}}const Rt=/[^a-z\-.+0-9_]/i;function vt(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(Array.isArray(t)&&Array.isArray(e)&&t.length===e.length)return t.every((n,i)=>vt(n,e[i]));if(Array.isArray(t)||Array.isArray(e))return!1;if(typeof t=="object"){const n=Object.keys(t);return Object.keys(e).length!==n.length?!1:n.every(i=>vt(t[i],e[i]))}return!1}function bn(t,e,n){let{emoji:i}=e,{id:r}=e,s=i.name,l=i.image,o=i.aliases.slice(),a=i.ascii.slice();function u(){n(0,s=i.name),n(1,l=i.image),n(2,o=i.aliases.slice()),n(3,a=i.ascii.slice())}let d,p,h,_="";function v(D){n(2,o=o.filter(we=>we!==D))}function T(){!_||o.includes(_)||(n(2,o=[...o,_]),n(4,_=""))}let f="";function y(D){n(3,a=a.filter(we=>we!==D))}function C(){!f||a.includes(f)||(n(3,a=[...a,f]),n(10,f=""))}const j=!i.name&&!i.image&&!i.aliases.length&&!i.ascii.length;let W=!1;const O={nameRequired:!1,imageRequired:!1,nameInvalid:!1,aliasInvalid:!1,any:!1};let M=!1;function R(){p.click(),jQuery(p).one("change",()=>{if(!p.files.length)return;const D=`${pn.generateUUID()}-${p.files[0].name}`;n(9,h.value=D,h),jQuery(d).ajaxSubmit({headers:{"x-csrf-token":ot.csrf_token},success:()=>{n(1,l=D),n(8,p.value="",p)},error:()=>{const we=Error("Failed to upload file");console.error(we),Me.alertError(we),n(8,p.value="",p)}})})}const H=wt();function Q(){H("save",{id:r,emoji:{name:s,image:l,aliases:o,ascii:a}})}let _e=!1,se=!1;function te(){n(12,_e=!0)}function ve(){n(12,_e=!1),n(13,se=!0),setTimeout(()=>{H("delete",{id:r})},250)}function le(){n(12,_e=!1)}function ae(){s=this.value,n(0,s)}function be(D){Pe[D?"unshift":"push"](()=>{p=D,n(8,p)})}function de(D){Pe[D?"unshift":"push"](()=>{h=D,n(9,h)})}function L(D){Pe[D?"unshift":"push"](()=>{d=D,n(7,d)})}function ee(){_=this.value,n(4,_)}const X=D=>v(D);function z(){f=this.value,n(10,f)}const N=D=>y(D);return t.$$set=D=>{"emoji"in D&&n(24,i=D.emoji),"id"in D&&n(25,r=D.id)},t.$$.update=()=>{t.$$.dirty[0]&16777231&&n(5,W=!vt({name:s,image:l,aliases:o,ascii:a},i)),t.$$.dirty[0]&1&&n(6,O.nameRequired=!s,O),t.$$.dirty[0]&2&&n(6,O.imageRequired=!l,O),t.$$.dirty[0]&1&&n(6,O.nameInvalid=Rt.test(s),O),t.$$.dirty[0]&16&&n(6,O.aliasInvalid=Rt.test(_),O),t.$$.dirty[0]&64&&n(6,O.any=O.nameRequired||O.imageRequired||O.nameInvalid||O.aliasInvalid,O),t.$$.dirty[0]&96&&n(11,M=W&&!O.any)},[s,l,o,a,_,W,O,d,p,h,f,M,_e,se,v,T,y,C,j,R,Q,te,ve,le,i,r,u,ae,be,de,L,ee,X,z,N]}class Ht extends Qe{constructor(e){super(),$e(this,e,bn,vn,He,{emoji:24,id:25,reset:26},[-1,-1])}get reset(){return this.$$.ctx[26]}}function Wt(t,e,n){const i=t.slice();return i[9]=e[n],i}function zt(t,e){let n,i,r;const s=[e[9]];let l={};for(let o=0;o<s.length;o+=1)l=x(l,s[o]);return i=new Ht({props:l}),i.$on("save",e[3]),i.$on("delete",e[4]),{key:t,first:null,c(){n=ze(),Le(i.$$.fragment),this.first=n},m(o,a){w(o,n,a),Ce(i,o,a),r=!0},p(o,a){e=o;const u=a&1?At(s,[jt(e[9])]):{};i.$set(u)},i(o){r||(ie(i.$$.fragment,o),r=!0)},o(o){oe(i.$$.fragment,o),r=!1},d(o){o&&k(n),Ae(i,o)}}}function yn(t){let e,n,i,r,s=[],l=new Map,o,a,u,d,p,h=t[0];const _=f=>f[9].id;for(let f=0;f<h.length;f+=1){let y=Wt(t,h,f),C=_(y);l.set(C,s[f]=zt(C,y))}function v(f){t[7](f)}let T={id:-1,emoji:t[2]};return t[1]!==void 0&&(T.reset=t[1]),u=new Ht({props:T}),Pe.push(()=>_t(u,"reset",v)),u.$on("save",t[5]),{c(){e=m("table"),n=m("thead"),n.innerHTML="<tr><th>Name</th><th>Image</th><th>Aliases</th><th>ASCII patterns</th><th></th></tr>",i=I(),r=m("tbody");for(let f=0;f<s.length;f+=1)s[f].c();o=I(),a=m("tfoot"),Le(u.$$.fragment),g(e,"class","table")},m(f,y){w(f,e,y),c(e,n),c(e,i),c(e,r);for(let C=0;C<s.length;C+=1)s[C].m(r,null);c(e,o),c(e,a),Ce(u,a,null),p=!0},p(f,[y]){y&25&&(h=f[0],st(),s=Ct(s,y,_,1,f,h,l,r,kt,zt,null,Wt),lt());const C={};y&4&&(C.emoji=f[2]),!d&&y&2&&(d=!0,C.reset=f[1],ht(()=>d=!1)),u.$set(C)},i(f){if(!p){for(let y=0;y<h.length;y+=1)ie(s[y]);ie(u.$$.fragment,f),p=!0}},o(f){for(let y=0;y<s.length;y+=1)oe(s[y]);oe(u.$$.fragment,f),p=!1},d(f){f&&k(e);for(let y=0;y<s.length;y+=1)s[y].d();Ae(u)}}}function En(t,e,n){let{emojis:i}=e,r;function s(h){const{id:_,emoji:v}=h.detail;q.default.put(`/admin/plugins/emoji/customizations/emoji/${_}`,{item:v}).then(()=>{n(6,i=Object.assign(Object.assign({},i),{[_]:v}))},()=>Me.alertError())}function l(h){const{id:_}=h.detail;q.default.del(`/admin/plugins/emoji/customizations/emoji/${_}`,{}).then(()=>{delete i[_],n(6,i=Object.assign({},i))},()=>Me.alertError())}const o={name:"",image:"",aliases:[],ascii:[]};let a,u=Object.assign({},o);function d(h){const{emoji:_}=h.detail;q.default.post("/admin/plugins/emoji/customizations/emoji",{item:_}).then(({id:v})=>{n(6,i=Object.assign(Object.assign({},i),{[v]:_})),n(2,u=Object.assign({},o)),a()},()=>Me.alertError())}function p(h){a=h,n(1,a)}return t.$$set=h=>{"emojis"in h&&n(6,i=h.emojis)},t.$$.update=()=>{t.$$.dirty&64&&n(0,r=Object.keys(i).map(h=>({id:parseInt(h,10),emoji:i[h]})))},[r,a,u,s,l,d,i,p]}class wn extends Qe{constructor(e){super(),$e(this,e,En,yn,He,{emojis:6})}}var Re=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ne.g<"u"?ne.g:typeof self<"u"?self:{};function kn(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),e}function ge(t){var e={exports:{}};return t(e,e.exports),e.exports}var at=ge(function(t){var e=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function r(a,u,d){this.fn=a,this.context=u,this.once=d||!1}function s(a,u,d,p,h){if(typeof d!="function")throw new TypeError("The listener must be a function");var _=new r(d,p||a,h),v=n?n+u:u;return a._events[v]?a._events[v].fn?a._events[v]=[a._events[v],_]:a._events[v].push(_):(a._events[v]=_,a._eventsCount++),a}function l(a,u){--a._eventsCount===0?a._events=new i:delete a._events[u]}function o(){this._events=new i,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],d,p;if(this._eventsCount===0)return u;for(p in d=this._events)e.call(d,p)&&u.push(n?p.slice(1):p);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},o.prototype.listeners=function(u){var d=n?n+u:u,p=this._events[d];if(!p)return[];if(p.fn)return[p.fn];for(var h=0,_=p.length,v=new Array(_);h<_;h++)v[h]=p[h].fn;return v},o.prototype.listenerCount=function(u){var d=n?n+u:u,p=this._events[d];return p?p.fn?1:p.length:0},o.prototype.emit=function(u,d,p,h,_,v){var T=n?n+u:u;if(!this._events[T])return!1;var f=this._events[T],y=arguments.length,C,j;if(f.fn){switch(f.once&&this.removeListener(u,f.fn,void 0,!0),y){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,d),!0;case 3:return f.fn.call(f.context,d,p),!0;case 4:return f.fn.call(f.context,d,p,h),!0;case 5:return f.fn.call(f.context,d,p,h,_),!0;case 6:return f.fn.call(f.context,d,p,h,_,v),!0}for(j=1,C=new Array(y-1);j<y;j++)C[j-1]=arguments[j];f.fn.apply(f.context,C)}else{var W=f.length,O;for(j=0;j<W;j++)switch(f[j].once&&this.removeListener(u,f[j].fn,void 0,!0),y){case 1:f[j].fn.call(f[j].context);break;case 2:f[j].fn.call(f[j].context,d);break;case 3:f[j].fn.call(f[j].context,d,p);break;case 4:f[j].fn.call(f[j].context,d,p,h);break;default:if(!C)for(O=1,C=new Array(y-1);O<y;O++)C[O-1]=arguments[O];f[j].fn.apply(f[j].context,C)}}return!0},o.prototype.on=function(u,d,p){return s(this,u,d,p,!1)},o.prototype.once=function(u,d,p){return s(this,u,d,p,!0)},o.prototype.removeListener=function(u,d,p,h){var _=n?n+u:u;if(!this._events[_])return this;if(!d)return l(this,_),this;var v=this._events[_];if(v.fn)v.fn===d&&(!h||v.once)&&(!p||v.context===p)&&l(this,_);else{for(var T=0,f=[],y=v.length;T<y;T++)(v[T].fn!==d||h&&!v[T].once||p&&v[T].context!==p)&&f.push(v[T]);f.length?this._events[_]=f.length===1?f[0]:f:l(this,_)}return this},o.prototype.removeAllListeners=function(u){var d;return u?(d=n?n+u:u,this._events[d]&&l(this,d)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,t.exports=o}),Ft=ge(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.SearchResult=void 0;const n=/\$&/g,i=/\$(\d)/g;class r{constructor(l,o,a){this.data=l,this.term=o,this.strategy=a}getReplacementData(l){let o=this.strategy.replace(this.data);if(o==null)return null;let a="";Array.isArray(o)&&(a=o[1],o=o[0]);const u=this.strategy.match(l);if(u==null||u.index==null)return null;const d=o.replace(n,u[0]).replace(i,(p,h)=>u[parseInt(h)]);return{start:u.index,end:u.index+u[0].length,beforeCursor:d,afterCursor:a}}replace(l,o){const a=this.getReplacementData(l);if(a!==null)return o=a.afterCursor+o,[[l.slice(0,a.start),a.beforeCursor,l.slice(a.end)].join(""),o]}render(){return this.strategy.renderTemplate(this.data,this.term)}getStrategyId(){return this.strategy.getId()}}e.SearchResult=r}),Ut=ge(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Strategy=e.DEFAULT_INDEX=void 0,e.DEFAULT_INDEX=1;class n{constructor(r){this.props=r,this.cache={}}destroy(){return this.cache={},this}replace(r){return this.props.replace(r)}execute(r,s){var l;const o=this.matchWithContext(r);if(!o)return!1;const a=o[(l=this.props.index)!==null&&l!==void 0?l:e.DEFAULT_INDEX];return this.search(a,u=>{s(u.map(d=>new Ft.SearchResult(d,a,this)))},o),!0}renderTemplate(r,s){if(this.props.template)return this.props.template(r,s);if(typeof r=="string")return r;throw new Error(`Unexpected render data type: ${typeof r}. Please implement template parameter by yourself`)}getId(){return this.props.id||null}match(r){return typeof this.props.match=="function"?this.props.match(r):r.match(this.props.match)}search(r,s,l){this.props.cache?this.searchWithCach(r,s,l):this.props.search(r,s,l)}matchWithContext(r){const s=this.context(r);return s===!1?null:this.match(s===!0?r:s)}context(r){return this.props.context?this.props.context(r):!0}searchWithCach(r,s,l){this.cache[r]!=null?s(this.cache[r]):this.props.search(r,o=>{this.cache[r]=o,s(o)},l)}}e.Strategy=n}),Bt=ge(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Completer=void 0;class n extends at.EventEmitter{constructor(r){super(),this.handleQueryResult=s=>{this.emit("hit",{searchResults:s})},this.strategies=r.map(s=>new Ut.Strategy(s))}destroy(){return this.strategies.forEach(r=>r.destroy()),this}run(r){for(const s of this.strategies)if(s.execute(r,this.handleQueryResult))return;this.handleQueryResult([])}}e.Completer=n}),je=ge(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.createCustomEvent=void 0;const n=typeof window<"u"&&!!window.CustomEvent,i=(r,s)=>{if(n)return new CustomEvent(r,s);const l=document.createEvent("CustomEvent");return l.initCustomEvent(r,!1,s?.cancelable||!1,s?.detail||void 0),l};e.createCustomEvent=i}),$t=ge(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Dropdown=e.DEFAULT_DROPDOWN_ITEM_ACTIVE_CLASS_NAME=e.DEFAULT_DROPDOWN_ITEM_CLASS_NAME=e.DEFAULT_DROPDOWN_CLASS_NAME=e.DEFAULT_DROPDOWN_PLACEMENT=e.DEFAULT_DROPDOWN_MAX_COUNT=void 0,e.DEFAULT_DROPDOWN_MAX_COUNT=10,e.DEFAULT_DROPDOWN_PLACEMENT="auto",e.DEFAULT_DROPDOWN_CLASS_NAME="dropdown-menu textcomplete-dropdown",e.DEFAULT_DROPDOWN_ITEM_CLASS_NAME="textcomplete-item",e.DEFAULT_DROPDOWN_ITEM_ACTIVE_CLASS_NAME=`${e.DEFAULT_DROPDOWN_ITEM_CLASS_NAME} active`;class n extends at.EventEmitter{constructor(s,l){super(),this.el=s,this.option=l,this.shown=!1,this.items=[],this.activeIndex=null}static create(s){const l=document.createElement("ul");l.className=s.className||e.DEFAULT_DROPDOWN_CLASS_NAME,Object.assign(l.style,{display:"none",position:"absolute",zIndex:"1000"},s.style);const o=s.parent||document.body;return o?.appendChild(l),new n(l,s)}render(s,l){const o=(0,je.createCustomEvent)("render",{cancelable:!0});return this.emit("render",o),o.defaultPrevented?this:(this.clear(),s.length===0?this.hide():(this.items=s.slice(0,this.option.maxCount||e.DEFAULT_DROPDOWN_MAX_COUNT).map((a,u)=>{var d;return new i(this,u,a,((d=this.option)===null||d===void 0?void 0:d.item)||{})}),this.setStrategyId(s[0]).renderEdge(s,"header").renderItems().renderEdge(s,"footer").show().setOffset(l).activate(0),this.emit("rendered",(0,je.createCustomEvent)("rendered")),this))}destroy(){var s;return this.clear(),(s=this.el.parentNode)===null||s===void 0||s.removeChild(this.el),this}select(s){const l={searchResult:s.searchResult},o=(0,je.createCustomEvent)("select",{cancelable:!0,detail:l});return this.emit("select",o),o.defaultPrevented?this:(this.hide(),this.emit("selected",(0,je.createCustomEvent)("selected",{detail:l})),this)}show(){if(!this.shown){const s=(0,je.createCustomEvent)("show",{cancelable:!0});if(this.emit("show",s),s.defaultPrevented)return this;this.el.style.display="block",this.shown=!0,this.emit("shown",(0,je.createCustomEvent)("shown"))}return this}hide(){if(this.shown){const s=(0,je.createCustomEvent)("hide",{cancelable:!0});if(this.emit("hide",s),s.defaultPrevented)return this;this.el.style.display="none",this.shown=!1,this.clear(),this.emit("hidden",(0,je.createCustomEvent)("hidden"))}return this}clear(){return this.items.forEach(s=>s.destroy()),this.items=[],this.el.innerHTML="",this.activeIndex=null,this}up(s){return this.shown?this.moveActiveItem("prev",s):this}down(s){return this.shown?this.moveActiveItem("next",s):this}moveActiveItem(s,l){if(this.activeIndex!=null){const o=s==="next"?this.getNextActiveIndex():this.getPrevActiveIndex();o!=null&&(this.activate(o),l.preventDefault())}return this}activate(s){return this.activeIndex!==s&&(this.activeIndex!=null&&this.items[this.activeIndex].deactivate(),this.activeIndex=s,this.items[s].activate()),this}isShown(){return this.shown}getActiveItem(){return this.activeIndex!=null?this.items[this.activeIndex]:null}setOffset(s){const l=document.documentElement;if(l){const o=this.el.offsetWidth;if(s.left){const d=this.option.dynamicWidth?l.scrollWidth:l.clientWidth;s.left+o>d&&(s.left=d-o),this.el.style.left=`${s.left}px`}else s.right&&(s.right-o<0&&(s.right=0),this.el.style.right=`${s.right}px`);let a=!1;const u=this.option.placement||e.DEFAULT_DROPDOWN_PLACEMENT;if(u==="auto"){const d=this.items.length*s.lineHeight;a=s.clientTop!=null&&s.clientTop+d>l.clientHeight}u==="top"||a?(this.el.style.bottom=`${l.clientHeight-s.top+s.lineHeight}px`,this.el.style.top="auto"):(this.el.style.top=`${s.top}px`,this.el.style.bottom="auto")}return this}getNextActiveIndex(){if(this.activeIndex==null)throw new Error;return this.activeIndex<this.items.length-1?this.activeIndex+1:this.option.rotate?0:null}getPrevActiveIndex(){if(this.activeIndex==null)throw new Error;return this.activeIndex!==0?this.activeIndex-1:this.option.rotate?this.items.length-1:null}renderItems(){const s=document.createDocumentFragment();for(const l of this.items)s.appendChild(l.el);return this.el.appendChild(s),this}setStrategyId(s){const l=s.getStrategyId();return l&&(this.el.dataset.strategy=l),this}renderEdge(s,l){const o=this.option[l],a=document.createElement("li");return a.className=`textcomplete-${l}`,a.innerHTML=typeof o=="function"?o(s.map(u=>u.data)):o||"",this.el.appendChild(a),this}}e.Dropdown=n;class i{constructor(s,l,o,a){this.dropdown=s,this.index=l,this.searchResult=o,this.props=a,this.active=!1,this.onClick=p=>{p.preventDefault(),this.dropdown.select(this)},this.className=this.props.className||e.DEFAULT_DROPDOWN_ITEM_CLASS_NAME,this.activeClassName=this.props.activeClassName||e.DEFAULT_DROPDOWN_ITEM_ACTIVE_CLASS_NAME;const u=document.createElement("li");u.className=this.active?this.activeClassName:this.className;const d=document.createElement("span");d.tabIndex=-1,d.innerHTML=this.searchResult.render(),u.appendChild(d),u.addEventListener("click",this.onClick),this.el=u}destroy(){var s;const l=this.el;return(s=l.parentNode)===null||s===void 0||s.removeChild(l),l.removeEventListener("click",this.onClick,!1),this}activate(){return this.active||(this.active=!0,this.el.className=this.activeClassName,this.dropdown.el.scrollTop=this.el.offsetTop),this}deactivate(){return this.active&&(this.active=!1,this.el.className=this.className),this}}}),Cn=ge(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Editor=void 0;class n extends at.EventEmitter{destroy(){return this}applySearchResult(r){throw new Error("Not implemented.")}getCursorOffset(){throw new Error("Not implemented.")}getBeforeCursor(){throw new Error("Not implemented.")}emitMoveEvent(r){const s=(0,je.createCustomEvent)("move",{cancelable:!0,detail:{code:r}});return this.emit("move",s),s}emitEnterEvent(){const r=(0,je.createCustomEvent)("enter",{cancelable:!0});return this.emit("enter",r),r}emitChangeEvent(){const r=(0,je.createCustomEvent)("change",{detail:{beforeCursor:this.getBeforeCursor()}});return this.emit("change",r),r}emitEscEvent(){const r=(0,je.createCustomEvent)("esc",{cancelable:!0});return this.emit("esc",r),r}getCode(r){return r.keyCode===9||r.keyCode===13?"ENTER":r.keyCode===27?"ESC":r.keyCode===38?"UP":r.keyCode===40||r.keyCode===78&&r.ctrlKey?"DOWN":r.keyCode===80&&r.ctrlKey?"UP":"OTHER"}}e.Editor=n}),An=ge(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Textcomplete=void 0;const n=["show","shown","render","rendered","selected","hidden","hide"];class i extends at.EventEmitter{constructor(s,l,o){super(),this.editor=s,this.isQueryInFlight=!1,this.nextPendingQuery=null,this.handleHit=({searchResults:a})=>{a.length?this.dropdown.render(a,this.editor.getCursorOffset()):this.dropdown.hide(),this.isQueryInFlight=!1,this.nextPendingQuery!==null&&this.trigger(this.nextPendingQuery)},this.handleMove=a=>{a.detail.code==="UP"?this.dropdown.up(a):this.dropdown.down(a)},this.handleEnter=a=>{const u=this.dropdown.getActiveItem();u?(this.dropdown.select(u),a.preventDefault()):this.dropdown.hide()},this.handleEsc=a=>{this.dropdown.isShown()&&(this.dropdown.hide(),a.preventDefault())},this.handleChange=a=>{a.detail.beforeCursor!=null?this.trigger(a.detail.beforeCursor):this.dropdown.hide()},this.handleSelect=a=>{this.emit("select",a),a.defaultPrevented||this.editor.applySearchResult(a.detail.searchResult)},this.handleResize=()=>{this.dropdown.isShown()&&this.dropdown.setOffset(this.editor.getCursorOffset())},this.completer=new Bt.Completer(l),this.dropdown=$t.Dropdown.create(o?.dropdown||{}),this.startListening()}destroy(s=!0){return this.completer.destroy(),this.dropdown.destroy(),s&&this.editor.destroy(),this.stopListening(),this}isShown(){return this.dropdown.isShown()}hide(){return this.dropdown.hide(),this}trigger(s){return this.isQueryInFlight?this.nextPendingQuery=s:(this.isQueryInFlight=!0,this.nextPendingQuery=null,this.completer.run(s)),this}startListening(){var s;this.editor.on("move",this.handleMove).on("enter",this.handleEnter).on("esc",this.handleEsc).on("change",this.handleChange),this.dropdown.on("select",this.handleSelect);for(const l of n)this.dropdown.on(l,o=>this.emit(l,o));this.completer.on("hit",this.handleHit),(s=this.dropdown.el.ownerDocument.defaultView)===null||s===void 0||s.addEventListener("resize",this.handleResize)}stopListening(){var s;(s=this.dropdown.el.ownerDocument.defaultView)===null||s===void 0||s.removeEventListener("resize",this.handleResize),this.completer.removeAllListeners(),this.dropdown.removeAllListeners(),this.editor.removeListener("move",this.handleMove).removeListener("enter",this.handleEnter).removeListener("esc",this.handleEsc).removeListener("change",this.handleChange)}}e.Textcomplete=i}),bt=ge(function(t,e){var n=Re&&Re.__createBinding||(Object.create?function(r,s,l,o){o===void 0&&(o=l);var a=Object.getOwnPropertyDescriptor(s,l);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[l]}}),Object.defineProperty(r,o,a)}:function(r,s,l,o){o===void 0&&(o=l),r[o]=s[l]}),i=Re&&Re.__exportStar||function(r,s){for(var l in r)l!=="default"&&!Object.prototype.hasOwnProperty.call(s,l)&&n(s,r,l)};Object.defineProperty(e,"__esModule",{value:!0}),i(Bt,e),i($t,e),i(Cn,e),i(Ft,e),i(Ut,e),i(An,e),i(je,e)});function Qt(t,e,n){const i=t.value,r=e+(n||""),s=document.activeElement;let l=0,o=0;for(;l<i.length&&l<r.length&&i[l]===r[l];)l++;for(;i.length-o-1>=0&&r.length-o-1>=0&&i[i.length-o-1]===r[r.length-o-1];)o++;l=Math.min(l,Math.min(i.length,r.length)-o),t.setSelectionRange(l,i.length-o);const a=r.substring(l,r.length-o);if(t.focus(),!document.execCommand("insertText",!1,a)){t.value=r;const u=document.createEvent("Event");u.initEvent("input",!0,!0),t.dispatchEvent(u)}return t.setSelectionRange(e.length,e.length),s.focus(),t}function jn(t,e,n){const i=t.selectionEnd,r=t.value.substr(0,t.selectionStart)+e,s=t.value.substring(t.selectionStart,i)+(n||"")+t.value.substr(i);return Qt(t,r,s),t.selectionEnd=i+e.length,t}var On=Object.freeze({__proto__:null,update:Qt,wrapCursor:jn}),Nn=ge(function(t){(function(){var e=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],n=typeof window<"u",i=n&&window.mozInnerScreenX!=null;function r(s,l,o){if(!n)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var a=o&&o.debug||!1;if(a){var u=document.querySelector("#input-textarea-caret-position-mirror-div");u&&u.parentNode.removeChild(u)}var d=document.createElement("div");d.id="input-textarea-caret-position-mirror-div",document.body.appendChild(d);var p=d.style,h=window.getComputedStyle?window.getComputedStyle(s):s.currentStyle,_=s.nodeName==="INPUT";p.whiteSpace="pre-wrap",_||(p.wordWrap="break-word"),p.position="absolute",a||(p.visibility="hidden"),e.forEach(function(f){_&&f==="lineHeight"?p.lineHeight=h.height:p[f]=h[f]}),i?s.scrollHeight>parseInt(h.height)&&(p.overflowY="scroll"):p.overflow="hidden",d.textContent=s.value.substring(0,l),_&&(d.textContent=d.textContent.replace(/\s/g,"\xA0"));var v=document.createElement("span");v.textContent=s.value.substring(l)||".",d.appendChild(v);var T={top:v.offsetTop+parseInt(h.borderTopWidth),left:v.offsetLeft+parseInt(h.borderLeftWidth),height:parseInt(h.lineHeight)};return a?v.style.backgroundColor="#aaa":document.body.removeChild(d),T}t.exports=r})()}),In=ge(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.calculateElementOffset=void 0;const n=i=>{const r=i.getBoundingClientRect(),s=i.ownerDocument;if(s==null)throw new Error("Given element does not belong to document");const{defaultView:l,documentElement:o}=s;if(l==null)throw new Error("Given element does not belong to window");const a={top:r.top+l.pageYOffset,left:r.left+l.pageXOffset};return o&&(a.top-=o.clientTop,a.left-=o.clientLeft),a};e.calculateElementOffset=n}),Tn=ge(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.getLineHeightPx=void 0;const n="0".charCodeAt(0),i="9".charCodeAt(0),r=o=>n<=o&&o<=i,s=o=>{const a=getComputedStyle(o),u=a.lineHeight;if(r(u.charCodeAt(0))){const d=parseFloat(u);return r(u.charCodeAt(u.length-1))?d*parseFloat(a.fontSize):d}return l(o.nodeName,a)};e.getLineHeightPx=s;const l=(o,a)=>{const u=document.body;if(!u)return 0;const d=document.createElement(o);d.innerHTML="&nbsp;",Object.assign(d.style,{fontSize:a.fontSize,fontFamily:a.fontFamily,padding:"0"}),u.appendChild(d),d instanceof HTMLTextAreaElement&&(d.rows=1);const p=d.offsetHeight;return u.removeChild(d),p}}),Sn=ge(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isSafari=void 0;const n=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent);e.isSafari=n}),Kt=ge(function(t,e){var n=Re&&Re.__createBinding||(Object.create?function(r,s,l,o){o===void 0&&(o=l);var a=Object.getOwnPropertyDescriptor(s,l);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[l]}}),Object.defineProperty(r,o,a)}:function(r,s,l,o){o===void 0&&(o=l),r[o]=s[l]}),i=Re&&Re.__exportStar||function(r,s){for(var l in r)l!=="default"&&!Object.prototype.hasOwnProperty.call(s,l)&&n(s,r,l)};Object.defineProperty(e,"__esModule",{value:!0}),i(In,e),i(Tn,e),i(Sn,e)}),Ln=kn(On),Dn=ge(function(t,e){var n=Re&&Re.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(e,"__esModule",{value:!0}),e.TextareaEditor=void 0;const i=n(Nn);class r extends bt.Editor{constructor(l){super(),this.el=l,this.onInput=()=>{this.emitChangeEvent()},this.onKeydown=o=>{const a=this.getCode(o);let u;a==="UP"||a==="DOWN"?u=this.emitMoveEvent(a):a==="ENTER"?u=this.emitEnterEvent():a==="ESC"&&(u=this.emitEscEvent()),u&&u.defaultPrevented&&o.preventDefault()},this.startListening()}destroy(){return super.destroy(),this.stopListening(),this}applySearchResult(l){const o=this.getBeforeCursor();if(o!=null){const a=l.replace(o,this.getAfterCursor());this.el.focus(),Array.isArray(a)&&((0,Ln.update)(this.el,a[0],a[1]),this.el&&this.el.dispatchEvent((0,bt.createCustomEvent)("input")))}}getCursorOffset(){const l=(0,Kt.calculateElementOffset)(this.el),o=this.getElScroll(),a=this.getCursorPosition(),u=(0,Kt.getLineHeightPx)(this.el),d=l.top-o.top+a.top+u,p=l.left-o.left+a.left,h=this.el.getBoundingClientRect().top;if(this.el.dir!=="rtl")return{top:d,left:p,lineHeight:u,clientTop:h};{const _=document.documentElement?document.documentElement.clientWidth-p:0;return{top:d,right:_,lineHeight:u,clientTop:h}}}getBeforeCursor(){return this.el.selectionStart!==this.el.selectionEnd?null:this.el.value.substring(0,this.el.selectionEnd)}getAfterCursor(){return this.el.value.substring(this.el.selectionEnd)}getElScroll(){return{top:this.el.scrollTop,left:this.el.scrollLeft}}getCursorPosition(){return(0,i.default)(this.el,this.el.selectionEnd)}startListening(){this.el.addEventListener("input",this.onInput),this.el.addEventListener("keydown",this.onKeydown)}stopListening(){this.el.removeEventListener("input",this.onInput),this.el.removeEventListener("keydown",this.onKeydown)}}e.TextareaEditor=r}),Mn=ge(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.TextareaEditor=void 0,Object.defineProperty(e,"TextareaEditor",{enumerable:!0,get:function(){return Dn.TextareaEditor}})});function Yt(t,e,n){const i=t.slice();return i[31]=e[n],i}function Jt(t,e,n){const i=t.slice();return i[31]=e[n],i}function Xt(t){let e,n=Ee.buildEmoji(t[10])+"",i;return{c(){i=ze(),e=new Et(i)},m(r,s){e.m(n,r,s),w(r,i,s)},p(r,s){s[0]&1024&&n!==(n=Ee.buildEmoji(r[10])+"")&&e.p(n)},d(r){r&&k(i),r&&e.d()}}}function Vt(t){let e,n=t[31]+"",i,r,s,l;function o(){return t[27](t[31])}return{c(){e=m("button"),i=pe(n),r=pe(" x"),g(e,"class","btn btn-info btn-xs")},m(a,u){w(a,e,u),c(e,i),c(e,r),s||(l=B(e,"click",o),s=!0)},p(a,u){t=a,u[0]&2&&n!==(n=t[31]+"")&&et(i,n)},d(a){a&&k(e),s=!1,l()}}}function qt(t){let e,n=t[31]+"",i,r,s,l;function o(){return t[29](t[31])}return{c(){e=m("button"),i=pe(n),r=pe(" x"),g(e,"class","btn btn-info btn-xs")},m(a,u){w(a,e,u),c(e,i),c(e,r),s||(l=B(e,"click",o),s=!0)},p(a,u){t=a,u[0]&4&&n!==(n=t[31]+"")&&et(i,n)},d(a){a&&k(e),s=!1,l()}}}function Pn(t){let e,n,i,r,s;return{c(){e=m("button"),n=m("i"),g(n,"class","fa fa-trash"),g(e,"class","btn btn-warning"),g(e,"type","button"),e.disabled=i=t[8]||t[9]},m(l,o){w(l,e,o),c(e,n),r||(s=B(e,"click",t[18]),r=!0)},p(l,o){o[0]&768&&i!==(i=l[8]||l[9])&&(e.disabled=i)},d(l){l&&k(e),r=!1,s()}}}function Rn(t){let e,n,i,r,s;return{c(){e=m("button"),n=m("i"),g(n,"class","fa fa-check"),g(e,"class","btn btn-success"),g(e,"type","button"),e.disabled=i=!t[11]},m(l,o){w(l,e,o),c(e,n),r||(s=B(e,"click",t[17]),r=!0)},p(l,o){o[0]&2048&&i!==(i=!l[11])&&(e.disabled=i)},d(l){l&&k(e),r=!1,s()}}}function Gt(t){let e,n,i,r,s,l,o,a,u,d,p,h;return{c(){e=m("tr"),n=m("td"),i=m("button"),r=pe("Cancel"),s=I(),l=m("td"),l.innerHTML='<span class="help-block">Are you sure you want to delete this extension?</span>',o=I(),a=m("td"),u=m("button"),d=pe("Yes"),g(i,"class","btn btn-default"),g(i,"type","button"),i.disabled=t[9],g(l,"colspan",3),g(u,"class","btn btn-danger"),g(u,"type","button"),u.disabled=t[9],g(e,"class","svelte-11gdgpc"),Fe(e,"fadeout",t[9])},m(_,v){w(_,e,v),c(e,n),c(n,i),c(i,r),c(e,s),c(e,l),c(e,o),c(e,a),c(a,u),c(u,d),p||(h=[B(i,"click",t[20]),B(u,"click",t[19])],p=!0)},p(_,v){v[0]&512&&(i.disabled=_[9]),v[0]&512&&(u.disabled=_[9]),v[0]&512&&Fe(e,"fadeout",_[9])},d(_){_&&k(e),p=!1,Te(h)}}}function Zt(t){let e;return{c(){e=m("tr"),e.innerHTML=`<td colspan="${5}"><span><strong>Name</strong> is required</span></td>`,g(e,"class","text-danger svelte-11gdgpc")},m(n,i){w(n,e,i)},d(n){n&&k(e)}}}function xt(t){let e;return{c(){e=m("tr"),e.innerHTML=`<td colspan="${5}"><span><strong>Name</strong> must be an existing emoji</span></td>`,g(e,"class","text-danger svelte-11gdgpc")},m(n,i){w(n,e,i)},d(n){n&&k(e)}}}function en(t){let e;return{c(){e=m("tr"),e.innerHTML=`<td colspan="${5}"><span><strong>Aliases</strong> can only contain letters, numbers, and <code>_-+.</code></span></td>`,g(e,"class","text-danger svelte-11gdgpc")},m(n,i){w(n,e,i)},d(n){n&&k(e)}}}function tn(t){let e;return{c(){e=m("tr"),e.innerHTML=`<td colspan="${5}"><span>Must provide at least one <strong>Alias</strong> or <strong>ASCII Pattern</strong>.</span></td>`,g(e,"class","text-danger svelte-11gdgpc")},m(n,i){w(n,e,i)},d(n){n&&k(e)}}}function Hn(t){let e,n,i,r,s,l,o,a,u,d,p,h,_,v,T,f,y,C,j,W,O,M,R,H,Q,_e,se,te,ve,le,ae,be,de,L=t[10]&&Xt(t),ee=t[1],X=[];for(let b=0;b<ee.length;b+=1)X[b]=Vt(Jt(t,ee,b));let z=t[2],N=[];for(let b=0;b<z.length;b+=1)N[b]=qt(Yt(t,z,b));function D(b,P){return b[5]||b[12]?Rn:Pn}let we=D(t),fe=we(t),K=(t[8]||t[9])&&Gt(t),re=t[5]&&t[4].nameRequired&&Zt(),J=t[5]&&t[4].nameInvalid&&xt(),ye=t[5]&&t[4].aliasInvalid&&en(),ce=t[5]&&t[4].noChange&&tn();return{c(){e=m("tr"),n=m("td"),i=m("input"),r=I(),s=m("td"),L&&L.c(),l=I(),o=m("td"),a=m("div"),u=m("input"),d=I(),p=m("div"),h=m("button"),h.textContent="+",_=I(),v=m("span");for(let b=0;b<X.length;b+=1)X[b].c();T=I(),f=m("td"),y=m("div"),C=m("input"),j=I(),W=m("div"),O=m("button"),O.textContent="+",M=I(),R=m("span");for(let b=0;b<N.length;b+=1)N[b].c();H=I(),Q=m("td"),fe.c(),_e=I(),K&&K.c(),se=I(),re&&re.c(),te=I(),J&&J.c(),ve=I(),ye&&ye.c(),le=I(),ce&&ce.c(),ae=ze(),g(i,"type","text"),g(i,"class","form-control emoji-name svelte-11gdgpc"),g(u,"type","text"),g(u,"class","form-control"),g(h,"class","btn btn-default"),g(p,"class","input-group-addon"),g(a,"class","input-group"),g(C,"type","text"),g(C,"class","form-control"),g(O,"class","btn btn-default"),g(W,"class","input-group-addon"),g(y,"class","input-group"),g(e,"class","svelte-11gdgpc"),Fe(e,"fadeout",t[9])},m(b,P){w(b,e,P),c(e,n),c(n,i),Se(i,t[0]),t[25](i),c(e,r),c(e,s),L&&L.m(s,null),c(e,l),c(e,o),c(o,a),c(a,u),Se(u,t[3]),c(a,d),c(a,p),c(p,h),c(o,_),c(o,v);for(let S=0;S<X.length;S+=1)X[S].m(v,null);c(e,T),c(e,f),c(f,y),c(y,C),Se(C,t[6]),c(y,j),c(y,W),c(W,O),c(f,M),c(f,R);for(let S=0;S<N.length;S+=1)N[S].m(R,null);c(e,H),c(e,Q),fe.m(Q,null),w(b,_e,P),K&&K.m(b,P),w(b,se,P),re&&re.m(b,P),w(b,te,P),J&&J.m(b,P),w(b,ve,P),ye&&ye.m(b,P),w(b,le,P),ce&&ce.m(b,P),w(b,ae,P),be||(de=[B(i,"input",t[24]),B(u,"input",t[26]),B(h,"click",t[14]),B(C,"input",t[28]),B(O,"click",t[16])],be=!0)},p(b,P){if(P[0]&1&&i.value!==b[0]&&Se(i,b[0]),b[10]?L?L.p(b,P):(L=Xt(b),L.c(),L.m(s,null)):L&&(L.d(1),L=null),P[0]&8&&u.value!==b[3]&&Se(u,b[3]),P[0]&8194){ee=b[1];let S;for(S=0;S<ee.length;S+=1){const ue=Jt(b,ee,S);X[S]?X[S].p(ue,P):(X[S]=Vt(ue),X[S].c(),X[S].m(v,null))}for(;S<X.length;S+=1)X[S].d(1);X.length=ee.length}if(P[0]&64&&C.value!==b[6]&&Se(C,b[6]),P[0]&32772){z=b[2];let S;for(S=0;S<z.length;S+=1){const ue=Yt(b,z,S);N[S]?N[S].p(ue,P):(N[S]=qt(ue),N[S].c(),N[S].m(R,null))}for(;S<N.length;S+=1)N[S].d(1);N.length=z.length}we===(we=D(b))&&fe?fe.p(b,P):(fe.d(1),fe=we(b),fe&&(fe.c(),fe.m(Q,null))),P[0]&512&&Fe(e,"fadeout",b[9]),b[8]||b[9]?K?K.p(b,P):(K=Gt(b),K.c(),K.m(se.parentNode,se)):K&&(K.d(1),K=null),b[5]&&b[4].nameRequired?re||(re=Zt(),re.c(),re.m(te.parentNode,te)):re&&(re.d(1),re=null),b[5]&&b[4].nameInvalid?J||(J=xt(),J.c(),J.m(ve.parentNode,ve)):J&&(J.d(1),J=null),b[5]&&b[4].aliasInvalid?ye||(ye=en(),ye.c(),ye.m(le.parentNode,le)):ye&&(ye.d(1),ye=null),b[5]&&b[4].noChange?ce||(ce=tn(),ce.c(),ce.m(ae.parentNode,ae)):ce&&(ce.d(1),ce=null)},i:A,o:A,d(b){b&&k(e),t[25](null),L&&L.d(),me(X,b),me(N,b),fe.d(),b&&k(_e),K&&K.d(b),b&&k(se),re&&re.d(b),b&&k(te),J&&J.d(b),b&&k(ve),ye&&ye.d(b),b&&k(le),ce&&ce.d(b),b&&k(ae),be=!1,Te(de)}}}const Wn=/[^a-z\-.+0-9_]/i;function yt(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(Array.isArray(t)&&Array.isArray(e)&&t.length===e.length)return t.every((n,i)=>yt(n,e[i]));if(Array.isArray(t)||Array.isArray(e))return!1;if(typeof t=="object"){const n=Object.keys(t);return Object.keys(e).length!==n.length?!1:n.every(i=>yt(t[i],e[i]))}return!1}function zn(t,e,n){let i,r,s,{item:l}=e,{id:o}=e,a=l.name,u=l.aliases.slice(),d=l.ascii.slice();function p(){n(0,a=l.name),n(1,u=l.aliases.slice()),n(2,d=l.ascii.slice())}const h=!l.name&&!l.aliases.length&&!l.ascii.length;let _="";function v(L){n(1,u=u.filter(ee=>ee!==L))}function T(){!_||u.includes(_)||(n(1,u=[...u,_]),n(3,_=""))}let f="";function y(L){n(2,d=d.filter(ee=>ee!==L))}function C(){!f||d.includes(f)||(n(2,d=[...d,f]),n(6,f=""))}const j={nameRequired:!1,nameInvalid:!1,aliasInvalid:!1,noChange:!1,any:!1};let W;cn(()=>{const L=new Mn.TextareaEditor(W);new bt.Textcomplete(L,[Object.assign(Object.assign({},Ee.strategy),{replace:X=>X.name,match:/^(.+)$/})],{dropdown:{style:{zIndex:2e4}}}).on("selected",()=>{n(0,a=W.value)})});const O=wt();function M(){O("save",{id:o,item:{name:a,aliases:u,ascii:d}})}let R=!1,H=!1;function Q(){n(8,R=!0)}function _e(){n(8,R=!1),n(9,H=!0),setTimeout(()=>{O("delete",{id:o})},250)}function se(){n(8,R=!1)}function te(){a=this.value,n(0,a)}function ve(L){Pe[L?"unshift":"push"](()=>{W=L,n(7,W)})}function le(){_=this.value,n(3,_)}const ae=L=>v(L);function be(){f=this.value,n(6,f)}const de=L=>y(L);return t.$$set=L=>{"item"in L&&n(21,l=L.item),"id"in L&&n(22,o=L.id)},t.$$.update=()=>{t.$$.dirty[0]&1&&n(10,i=a&&Ee.table[a]),t.$$.dirty[0]&2097159&&n(5,r=!yt({name:a,aliases:u,ascii:d},l)),t.$$.dirty[0]&1&&n(4,j.nameRequired=!a,j),t.$$.dirty[0]&1&&n(4,j.nameInvalid=!Ee.table[a],j),t.$$.dirty[0]&8&&n(4,j.aliasInvalid=Wn.test(_),j),t.$$.dirty[0]&6&&n(4,j.noChange=!u.length&&!d.length,j),t.$$.dirty[0]&16&&n(4,j.any=j.nameRequired||j.nameInvalid||j.aliasInvalid||j.noChange,j),t.$$.dirty[0]&48&&n(11,s=r&&!j.any)},[a,u,d,_,j,r,f,W,R,H,i,s,h,v,T,y,C,M,Q,_e,se,l,o,p,te,ve,le,ae,be,de]}class nn extends Qe{constructor(e){super(),$e(this,e,zn,Hn,He,{item:21,id:22,reset:23},[-1,-1])}get reset(){return this.$$.ctx[23]}}function sn(t,e,n){const i=t.slice();return i[10]=e[n],i}function ln(t,e){let n,i,r;const s=[e[10]];let l={};for(let o=0;o<s.length;o+=1)l=x(l,s[o]);return i=new nn({props:l}),i.$on("save",e[3]),i.$on("delete",e[4]),{key:t,first:null,c(){n=ze(),Le(i.$$.fragment),this.first=n},m(o,a){w(o,n,a),Ce(i,o,a),r=!0},p(o,a){e=o;const u=a&1?At(s,[jt(e[10])]):{};i.$set(u)},i(o){r||(ie(i.$$.fragment,o),r=!0)},o(o){oe(i.$$.fragment,o),r=!1},d(o){o&&k(n),Ae(i,o)}}}function Fn(t){let e,n,i,r,s=[],l=new Map,o,a,u,d,p,h=t[0];const _=f=>f[10].id;for(let f=0;f<h.length;f+=1){let y=sn(t,h,f),C=_(y);l.set(C,s[f]=ln(C,y))}function v(f){t[8](f)}let T={id:-1,item:t[2]};return t[1]!==void 0&&(T.reset=t[1]),u=new nn({props:T}),Pe.push(()=>_t(u,"reset",v)),u.$on("save",t[5]),{c(){e=m("table"),n=m("thead"),n.innerHTML="<tr><th>Name</th><th>Image</th><th>Aliases</th><th>ASCII patterns</th><th></th></tr>",i=I(),r=m("tbody");for(let f=0;f<s.length;f+=1)s[f].c();o=I(),a=m("tfoot"),Le(u.$$.fragment),g(e,"class","table")},m(f,y){w(f,e,y),c(e,n),c(e,i),c(e,r);for(let C=0;C<s.length;C+=1)s[C].m(r,null);c(e,o),c(e,a),Ce(u,a,null),p=!0},p(f,[y]){y&25&&(h=f[0],st(),s=Ct(s,y,_,1,f,h,l,r,kt,ln,null,sn),lt());const C={};y&4&&(C.item=f[2]),!d&&y&2&&(d=!0,C.reset=f[1],ht(()=>d=!1)),u.$set(C)},i(f){if(!p){for(let y=0;y<h.length;y+=1)ie(s[y]);ie(u.$$.fragment,f),p=!0}},o(f){for(let y=0;y<s.length;y+=1)oe(s[y]);oe(u.$$.fragment,f),p=!1},d(f){f&&k(e);for(let y=0;y<s.length;y+=1)s[y].d();Ae(u)}}}function Un(t,e,n){let{type:i="adjunct"}=e,{record:r}=e,s;function l(_){const{id:v,item:T}=_.detail;q.default.put(`/admin/plugins/emoji/customizations/${i}/${v}`,{item:T}).then(()=>{n(6,r=Object.assign(Object.assign({},r),{[v]:T}))},()=>Me.alertError())}function o(_){const{id:v}=_.detail;q.default.del(`/admin/plugins/emoji/customizations/${i}/${v}`,{}).then(()=>{delete r[v],n(6,r=Object.assign({},r))},()=>Me.alertError())}const a={name:"",aliases:[],ascii:[]};let u,d=Object.assign({},a);function p(_){const{item:v}=_.detail;q.default.post(`/admin/plugins/emoji/customizations/${i}`,{item:v}).then(({id:T})=>{n(6,r=Object.assign(Object.assign({},r),{[T]:v})),n(2,d=Object.assign({},a)),u()},()=>Me.alertError())}function h(_){u=_,n(1,u)}return t.$$set=_=>{"type"in _&&n(7,i=_.type),"record"in _&&n(6,r=_.record)},t.$$.update=()=>{t.$$.dirty&64&&n(0,s=Object.keys(r).map(_=>({id:parseInt(_,10),item:r[_]})))},[s,u,d,l,o,p,r,i,h]}class Bn extends Qe{constructor(e){super(),$e(this,e,Un,Fn,He,{type:7,record:6})}}function $n(t){let e,n,i,r,s,l,o,a,u,d,p,h,_,v,T,f,y,C,j,W;return h=new wn({props:{emojis:t[0].emojis}}),y=new Bn({props:{record:t[0].adjuncts}}),{c(){e=m("div"),n=m("div"),i=m("div"),r=m("div"),r.innerHTML=`<button type="button" class="close" data-dismiss="modal" aria-hidden="true">\xD7</button> 
        <h4 class="modal-title" id="editModalLabel">Customize Emoji</h4>`,s=I(),l=m("div"),o=m("p"),o.innerHTML=`Below you can add custom emoji, and also add new aliases
          and ASCII patterns for existing emoji. While this list is
          edited live, you must still <strong>Build Emoji Assets</strong>
          to actually use these customizations.`,a=I(),u=m("div"),d=m("div"),d.innerHTML='<h3 class="panel-title">Custom Emoji</h3>',p=I(),Le(h.$$.fragment),_=I(),v=m("div"),T=m("div"),T.innerHTML='<h3 class="panel-title">Custom Extensions</h3>',f=I(),Le(y.$$.fragment),C=I(),j=m("link"),g(r,"class","modal-header"),g(d,"class","panel-heading"),g(u,"class","panel panel-default"),g(T,"class","panel-heading"),g(v,"class","panel panel-default"),g(l,"class","modal-body"),g(i,"class","modal-content"),g(n,"class","modal-dialog modal-lg"),g(e,"class","modal fade"),g(e,"tabindex","-1"),g(e,"role","dialog"),g(e,"aria-labelledby","editModalLabel"),g(e,"aria-hidden","true"),g(j,"rel","stylesheet"),g(j,"href",`${ot.assetBaseUrl}/plugins/nodebb-plugin-emoji/emoji/styles.css?${ot["cache-buster"]}`)},m(O,M){w(O,e,M),c(e,n),c(n,i),c(i,r),c(i,s),c(i,l),c(l,o),c(l,a),c(l,u),c(u,d),c(u,p),Ce(h,u,null),c(l,_),c(l,v),c(v,T),c(v,f),Ce(y,v,null),t[3](e),w(O,C,M),c(document.head,j),W=!0},p(O,[M]){const R={};M&1&&(R.emojis=O[0].emojis),h.$set(R);const H={};M&1&&(H.record=O[0].adjuncts),y.$set(H)},i(O){W||(ie(h.$$.fragment,O),ie(y.$$.fragment,O),W=!0)},o(O){oe(h.$$.fragment,O),oe(y.$$.fragment,O),W=!1},d(O){O&&k(e),Ae(h),Ae(y),t[3](null),O&&k(C),k(j)}}}function Qn(t,e,n){let{data:i}=e,r;function s(){V.default(r).modal("show")}function l(o){Pe[o?"unshift":"push"](()=>{r=o,n(1,r)})}return t.$$set=o=>{"data"in o&&n(0,i=o.data)},[i,r,s,l]}class Kn extends Qe{constructor(e){super(),$e(this,e,Qn,$n,He,{data:0,show:2})}get show(){return this.$$.ctx[2]}}function Yn(t){return{c:A,m:A,p:A,d:A}}function Jn(t){let e,n=t[2]+"",i;return{c(){i=ze(),e=new Et(i)},m(r,s){e.m(n,r,s),w(r,i,s)},p(r,s){s&1&&n!==(n=r[2]+"")&&e.p(n)},d(r){r&&k(i),r&&e.d()}}}function Xn(t){return{c:A,m:A,p:A,d:A}}function Vn(t){let e,n,i={ctx:t,current:null,token:null,hasCatch:!1,pending:Xn,then:Jn,catch:Yn,value:2};return rt(n=t[1].translate(t[0]),i),{c(){e=ze(),i.block.c()},m(r,s){w(r,e,s),i.block.m(r,i.anchor=s),i.mount=()=>e.parentNode,i.anchor=e},p(r,[s]){if(t=r,i.ctx=t,!(s&1&&n!==(n=t[1].translate(t[0]))&&rt(n,i))){const l=t.slice();l[2]=i.resolved,i.block.p(l,s)}},i:A,o:A,d(r){r&&k(e),i.block.d(r),i.token=null,i=null}}}function qn(t,e,n){const i=Ie.Translator.create();let{src:r}=e;return t.$$set=s=>{"src"in s&&n(0,r=s.src)},[r,i]}class Xe extends Qe{constructor(e){super(),$e(this,e,qn,Vn,He,{src:0})}}function rn(t){let e,n,i,r={ctx:t,current:null,token:null,hasCatch:!1,pending:xn,then:Zn,catch:Gn,value:11,blocks:[,,,]};return rt(n=t[2],r),{c(){e=ze(),r.block.c()},m(s,l){w(s,e,l),r.block.m(s,r.anchor=l),r.mount=()=>e.parentNode,r.anchor=e,i=!0},p(s,l){if(t=s,r.ctx=t,!(l&4&&n!==(n=t[2])&&rt(n,r))){const o=t.slice();o[11]=r.resolved,r.block.p(o,l)}},i(s){i||(ie(r.block),i=!0)},o(s){for(let l=0;l<3;l+=1){const o=r.blocks[l];oe(o)}i=!1},d(s){s&&k(e),r.block.d(s),r.token=null,r=null}}}function Gn(t){return{c:A,m:A,p:A,i:A,o:A,d:A}}function Zn(t){let e,n,i;function r(l){t[9](l)}let s={data:t[11]};return t[1]!==void 0&&(s.show=t[1]),e=new Kn({props:s}),Pe.push(()=>_t(e,"show",r)),{c(){Le(e.$$.fragment)},m(l,o){Ce(e,l,o),i=!0},p(l,o){const a={};o&4&&(a.data=l[11]),!n&&o&2&&(n=!0,a.show=l[1],ht(()=>n=!1)),e.$set(a)},i(l){i||(ie(e.$$.fragment,l),i=!0)},o(l){oe(e.$$.fragment,l),i=!1},d(l){Ae(e,l)}}}function xn(t){return{c:A,m:A,p:A,i:A,o:A,d:A}}function ei(t){let e,n,i,r,s,l,o,a,u,d,p,h,_,v,T,f,y,C,j,W,O,M,R,H,Q,_e,se,te,ve,le,ae,be,de,L,ee,X;a=new Xe({props:{src:"[[admin/plugins/emoji:settings.parseAscii]]"}}),v=new Xe({props:{src:"[[admin/plugins/emoji:settings.parseNative]]"}}),W=new Xe({props:{src:"[[admin/plugins/emoji:settings.customFirst]]"}}),Q=new Xe({props:{src:"[[admin/plugins/emoji:build]]"}}),te=new Xe({props:{src:"[[admin/plugins/emoji:build_description]]"}});let z=t[2]&&rn(t);return{c(){e=m("form"),n=m("div"),i=m("div"),r=m("div"),s=m("label"),l=m("input"),o=I(),Le(a.$$.fragment),u=I(),d=m("div"),p=m("label"),h=m("input"),_=I(),Le(v.$$.fragment),T=I(),f=m("div"),y=m("label"),C=m("input"),j=I(),Le(W.$$.fragment),O=I(),M=m("div"),R=m("div"),H=m("button"),Le(Q.$$.fragment),_e=I(),se=m("p"),Le(te.$$.fragment),ve=I(),z&&z.c(),le=I(),ae=m("button"),ae.innerHTML='<i class="material-icons">save</i>',be=I(),de=m("button"),de.innerHTML='<i class="material-icons">edit</i>',g(l,"id","emoji-parseAscii"),g(l,"type","checkbox"),g(s,"for","emoji-parseAscii"),g(r,"class","form-group"),g(h,"id","emoji-parseNative"),g(h,"type","checkbox"),g(p,"for","emoji-parseNative"),g(d,"class","form-group"),g(C,"id","emoji-customFirst"),g(C,"type","checkbox"),g(y,"for","emoji-customFirst"),g(f,"class","form-group"),g(i,"class","panel-body"),g(H,"type","button"),g(H,"class","btn btn-primary"),g(H,"aria-describedby","emoji-build_description"),g(se,"id","emoji-build_description"),g(se,"class","help-block"),g(R,"class","form-group"),g(M,"class","panel-footer"),g(n,"class","panel panel-default"),g(e,"id","emoji-settings"),g(ae,"class","floating-button mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored"),g(de,"class","edit floating-button mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored svelte-rv4t0s")},m(N,D){w(N,e,D),c(e,n),c(n,i),c(i,r),c(r,s),c(s,l),l.checked=t[0].parseAscii,c(s,o),Ce(a,s,null),c(i,u),c(i,d),c(d,p),c(p,h),h.checked=t[0].parseNative,c(p,_),Ce(v,p,null),c(i,T),c(i,f),c(f,y),c(y,C),C.checked=t[0].customFirst,c(y,j),Ce(W,y,null),c(n,O),c(n,M),c(M,R),c(R,H),Ce(Q,H,null),c(R,_e),c(R,se),Ce(te,se,null),w(N,ve,D),z&&z.m(N,D),w(N,le,D),w(N,ae,D),w(N,be,D),w(N,de,D),L=!0,ee||(X=[B(l,"change",t[6]),B(h,"change",t[7]),B(C,"change",t[8]),B(H,"click",t[4]),B(ae,"click",t[3]),B(de,"click",t[5])],ee=!0)},p(N,[D]){D&1&&(l.checked=N[0].parseAscii),D&1&&(h.checked=N[0].parseNative),D&1&&(C.checked=N[0].customFirst),N[2]?z?(z.p(N,D),D&4&&ie(z,1)):(z=rn(N),z.c(),ie(z,1),z.m(le.parentNode,le)):z&&(st(),oe(z,1,1,()=>{z=null}),lt())},i(N){L||(ie(a.$$.fragment,N),ie(v.$$.fragment,N),ie(W.$$.fragment,N),ie(Q.$$.fragment,N),ie(te.$$.fragment,N),ie(z),L=!0)},o(N){oe(a.$$.fragment,N),oe(v.$$.fragment,N),oe(W.$$.fragment,N),oe(Q.$$.fragment,N),oe(te.$$.fragment,N),oe(z),L=!1},d(N){N&&k(e),Ae(a),Ae(v),Ae(W),Ae(Q),Ae(te),N&&k(ve),z&&z.d(N),N&&k(le),N&&k(ae),N&&k(be),N&&k(de),ee=!1,Te(X)}}}function ti(t,e,n){let{settings:i}=e;function r(){q.default.put("/admin/plugins/emoji/settings",i).then(()=>Me.alertSuccess(),v=>Me.alertError(v))}function s(){q.default.put("/admin/plugins/emoji/build",{}).then(()=>Me.alertSuccess(),v=>Me.alertError(v))}let l,o;function a(){return q.default.get("/admin/plugins/emoji/customizations",{})}function u(){n(2,o=o||Promise.all([a(),Ee.init()]).then(([v])=>v)),o.then(()=>setTimeout(()=>l(),0))}function d(){i.parseAscii=this.checked,n(0,i)}function p(){i.parseNative=this.checked,n(0,i)}function h(){i.customFirst=this.checked,n(0,i)}function _(v){l=v,n(1,l)}return t.$$set=v=>{"settings"in v&&n(0,i=v.settings)},[i,l,o,r,s,u,d,p,h,_]}class ni extends Qe{constructor(e){super(),$e(this,e,ti,ei,He,{settings:0})}}V.default(window).on("action:ajaxify.end",()=>{Y.data.template["admin/plugins/emoji"]&&new ni({target:document.getElementById("content"),props:{settings:Y.data.settings}})})}.apply(Ke,We),De!==void 0&&(Ye.exports=De)},74344:(Ye,Ke,ne)=>{"use strict";var We,De;We=[ne(85233)],De=(qe=>{const U={},Ee=config.relative_path+"/api/v3";function Ie(G,V){G.url=G.url.startsWith("/api")?config.relative_path+G.url:Ee+G.url;async function q(Y){({options:G}=await qe.fire("filter:api.options",{options:G})),$.ajax(G).done(A=>{Y(null,A&&A.hasOwnProperty("status")&&A.hasOwnProperty("response")?A.response:A||{})}).fail(A=>{let x;A.responseJSON&&(x=A.responseJSON.status&&A.responseJSON.status.message?A.responseJSON.status.message:A.responseJSON.error),Y(new Error(x||A.statusText))})}if(typeof V=="function"){q(V);return}return new Promise((Y,A)=>{q(function(x,ke){x?A(x):Y(ke)})})}return U.get=(G,V,q)=>Ie({url:G+(V&&Object.keys(V).length?"?"+$.param(V):"")},q),U.head=(G,V,q)=>Ie({url:G+(V&&Object.keys(V).length?"?"+$.param(V):""),method:"head"},q),U.post=(G,V,q)=>Ie({url:G,method:"post",data:JSON.stringify(V||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},q),U.patch=(G,V,q)=>Ie({url:G,method:"patch",data:JSON.stringify(V||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},q),U.put=(G,V,q)=>Ie({url:G,method:"put",data:JSON.stringify(V||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},q),U.del=(G,V,q)=>Ie({url:G,method:"delete",data:JSON.stringify(V),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},q),U.delete=U.del,U}).apply(Ke,We),De!==void 0&&(Ye.exports=De)},40646:(Ye,Ke,ne)=>{var We,De;We=[ne,Ke],De=function(qe,U){"use strict";Object.defineProperty(U,"__esModule",{value:!0}),U.init=U.strategy=U.search=U.table=U.buildEmoji=U.buster=U.base=void 0;var Ee=config.assetBaseUrl+"/plugins/nodebb-plugin-emoji";U.base=Ee;var Ie=config["cache-buster"];U.buster=Ie;function G(Y,A){var x=":"+Y.name+":",ke=A?" defer":"";return Y.image?`<img
      `+(A?"data-":"")+'src="'+Ee+"/emoji/"+Y.pack+"/"+Y.image+"?"+Ie+`"
      class="not-responsive emoji emoji-`+Y.pack+" emoji--"+Y.name+" "+ke+`"
      title="`+x+`"
      alt="`+Y.character+`"
    />`:`<span
    class="emoji-`+Y.pack+" emoji--"+Y.name+`"
    title="`+x+`"
  ><span>`+Y.character+"</span></span>"}U.buildEmoji=G,U.strategy={match:/\B:([^\s\n:]+)$/,search:function(Y,A){A(U.search(Y.toLowerCase().replace(/[_-]/g,"")).slice(0,10))},index:1,replace:function(Y){return":"+Y.name+": "},template:function(Y){return G(Y)+" "+Y.name},cache:!0};var V;function q(Y){return V=V||Promise.all([new Promise(function(A,x){ne.e(2645).then(function(){var ke=[ne(91919)];A.apply(null,ke)}.bind(this)).catch(x.bind(this))}),new Promise(function(A,x){ne.e(320).then(function(){var ke=[ne(78726)];A.apply(null,ke)}.bind(this)).catch(x.bind(this))}),new Promise(function(A,x){Promise.all([ne.e(6177),ne.e(2526),ne.e(5482),ne.e(588)]).then(function(){var ke=[ne(45482)];A.apply(null,ke)}.bind(this)).catch(x.bind(this))}),$.getJSON(Ee+"/emoji/table.json?"+Ie)]).then(function(A){var x=A[0],ke=A[1],Ge=A[2],Ze=A[3];U.table=Ze;var Te=Object.keys(U.table).map(function(he){var c=U.table[he];return{name:he,aliases:c.aliases,keywords:c.keywords,character:c.character,image:c.image,pack:c.pack}});function xe(he,c){for(var w=c.length,k=0;k<w;k+=1)if(x(he,c[k]))return c[k];return null}function He(he){function c(w,k){var me=k*(1+ke(he,w));return w.startsWith(he)?me-2:me}return Te.filter(function(w){if(x(he,w.name))return w.score=c(w.name,1),!0;var k=xe(he,w.aliases);if(k)return w.score=c(k,3),!0;var me=xe(he,w.keywords);return me?(w.score=c(me,7),!0):!1}).sort(function(w,k){return w.score-k.score}).sort(function(w,k){var me=+w.name.startsWith(he),m=+k.name.startsWith(he);return m-me})}U.search=He,Ge.addButtonDispatch("emoji-add-emoji",function(he,c,w,k){new Promise(function(me,m){ne.e(5400).then(function(){var pe=[ne(6721)];me.apply(null,pe)}.bind(this)).catch(m.bind(this))}).then(function(me){var m=me.toggleForInsert;return m(he,c,w,k)})})}).catch(function(A){var x=Error("[[emoji:meta-load-failed]]");throw console.error(x),app.alertError(x),A}),Y&&V.then(function(){return setTimeout(Y,0)}),V}U.init=q}.apply(Ke,We),De!==void 0&&(Ye.exports=De)}}]);
