"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[4400,7214,6503,8786,5655],{29721:(E,b,a)=>{var v,f;v=[a(32230),a(59006),a(31369),a(7927),a(62526)],f=function(n,m,A,d){const p={};p.init=function(){const e=$(".plugins"),i=e[0].querySelectorAll("li").length;let o;if(!i){n.translate("<li><p><i>[[admin/extend/plugins:none-found]]</i></p></li>",function(c){e.append(c)});return}const h=document.querySelector("#plugin-search");h.value="",e.on("click",'button[data-action="toggleActive"]',function(){const c=$(this).parents("li");o=c.attr("data-plugin-id");const u=$('[id="'+o+'"] [data-action="toggleActive"]'),l=ajaxify.data.installed[c.attr("data-plugin-index")];function s(){socket.emit("admin.plugins.toggleActive",o,function(r,g){if(r)return d.error(r);n.translate('<i class="fa fa-power-off"></i> [[admin/extend/plugins:plugin-item.'+(g.active?"deactivate":"activate")+"]]",function(R){u.html(R),u.toggleClass("btn-warning",g.active).toggleClass("btn-success",!g.active),g.active&&!$('#active [id="'+o+'"]').length&&$("#active ul").prepend(c.clone(!0)),l.active=!l.active,d.alert({alert_id:"plugin_toggled",title:"[[admin/extend/plugins:alert."+(g.active?"enabled":"disabled")+"]]",message:"[[admin/extend/plugins:alert."+(g.active?"activate-success":"deactivate-success")+"]]",type:g.active?"warning":"success",timeout:5e3,clickfn:function(){a.e(4117).then(function(){var C=[a(64117)];(function(k){k.rebuildAndRestart()}).apply(null,C)}).catch(a.oe)}})})})}l.license&&l.active!==!0?m.render("admin/partials/plugins/license",l).then(function(r){A.dialog({title:"[[admin/extend/plugins:license.title]]",message:r,size:"large",buttons:{cancel:{label:"[[modules:bootbox.cancel]]",className:"btn-link"},save:{label:"[[modules:bootbox.confirm]]",className:"btn-primary",callback:s}},onShown:function(){const g=this.querySelector("button.btn-primary");g&&g.focus()}})}):s(o)}),e.on("click",'button[data-action="toggleInstall"]',function(){const c=$(this);if(c.attr("disabled",!0),o=$(this).parents("li").attr("data-plugin-id"),$(this).attr("data-installed")==="1")return p.toggleInstall(o,$(this).parents("li").attr("data-version"));p.suggest(o,function(u,l){if(u){A.confirm(n.compile("admin/extend/plugins:alert.suggest-error",u.status,u.responseText),function(s){s?p.toggleInstall(o,"latest"):c.removeAttr("disabled")});return}l.version!=="latest"?p.toggleInstall(o,l.version):l.version==="latest"?x(o,function(s){s?p.toggleInstall(o,"latest"):c.removeAttr("disabled")}):c.removeAttr("disabled")})}),e.on("click",'button[data-action="upgrade"]',function(){const c=$(this),u=c.parents("li");o=u.attr("data-plugin-id"),p.suggest(o,function(l,s){if(l)return A.alert("[[admin/extend/plugins:alert.package-manager-unreachable]]");a.e(9803).then(function(){var r=[a(39803)];(function(g){const R=u.find(".currentVersion").text();s.version!=="latest"&&g.compare(s.version,R,">")?y(o,c,s.version):s.version==="latest"?x(o,function(){y(o,c,s.version)}):A.alert(n.compile("admin/extend/plugins:alert.incompatible",app.config.version,s.version))}).apply(null,r)}).catch(a.oe)})}),$(h).on("input propertychange",function(){const c=$(this).val();$(".plugins li").each(function(){const l=$(this).attr("data-plugin-id");$(this).toggleClass("hide",l&&l.indexOf(c)===-1)}),document.querySelectorAll(".plugins .tab-pane").forEach(l=>{const s=l.querySelectorAll("li:not(.hide)").length,r=l.querySelector(".no-plugins");r&&r.classList.toggle("hide",s!==0)})}),$("#plugin-submit-usage").on("click",function(){socket.emit("admin.config.setMultiple",{submitPluginUsage:$(this).prop("checked")?"1":"0"},function(c){if(c)return d.error(c)})}),$("#plugin-order").on("click",function(){$("#order-active-plugins-modal").modal("show"),socket.emit("admin.plugins.getActive",function(c,u){if(c)return d.error(c);let l="";if(u.forEach(function(r){l+='<li class="">'+r+'<span class="pull-right"><i class="fa fa-chevron-up"></i><i class="fa fa-chevron-down"></i></span></li>'}),!u.length){n.translate("[[admin/extend/plugins:none-active]]",function(r){$("#order-active-plugins-modal .plugin-list").html(r).sortable()});return}const s=$("#order-active-plugins-modal .plugin-list");s.html(l).sortable(),s.find(".fa-chevron-up").on("click",function(){const r=$(this).parents("li");r.prev().before(r)}),s.find(".fa-chevron-down").on("click",function(){const r=$(this).parents("li");r.next().after(r)})})}),$("#save-plugin-order").on("click",function(){const c=$("#order-active-plugins-modal .plugin-list").children(),u=[];c.each(function(l,s){u.push({name:$(s).text(),order:l})}),socket.emit("admin.plugins.orderActivePlugins",u,function(l){if(l)return d.error(l);$("#order-active-plugins-modal").modal("hide"),d.alert({alert_id:"plugin_reordered",title:"[[admin/extend/plugins:alert.reorder]]",message:"[[admin/extend/plugins:alert.reorder-success]]",type:"success",timeout:5e3,clickfn:function(){a.e(4117).then(function(){var s=[a(64117)];(function(r){r.rebuildAndRestart()}).apply(null,s)}).catch(a.oe)}})})}),I(),t(),h.focus()};function x(e,i){A.confirm(n.compile("admin/extend/plugins:alert.possibly-incompatible",e),function(o){i(o)})}function y(e,i,o){i.attr("disabled",!0).find("i").attr("class","fa fa-refresh fa-spin"),socket.emit("admin.plugins.upgrade",{id:e,version:o},function(h,c){if(h)return d.error(h);const u=i.parents("li");u.find(".fa-exclamation-triangle").remove(),u.find(".currentVersion").text(o),i.remove(),c&&d.alert({alert_id:"plugin_upgraded",title:"[[admin/extend/plugins:alert.upgraded]]",message:"[[admin/extend/plugins:alert.upgrade-success]]",type:"warning",timeout:5e3,clickfn:function(){a.e(4117).then(function(){var l=[a(64117)];(function(s){s.rebuildAndRestart()}).apply(null,l)}).catch(a.oe)}})})}p.toggleInstall=function(e,i,o){const h=$('li[data-plugin-id="'+e+'"] button[data-action="toggleInstall"]');h.find("i").attr("class","fa fa-refresh fa-spin"),socket.emit("admin.plugins.toggleInstall",{id:e,version:i},function(c,u){if(c)return h.removeAttr("disabled"),d.error(c);ajaxify.refresh(),d.alert({alert_id:"plugin_toggled",title:"[[admin/extend/plugins:alert."+(u.installed?"installed":"uninstalled")+"]]",message:"[[admin/extend/plugins:alert."+(u.installed?"install-success":"uninstall-success")+"]]",type:"info",timeout:5e3}),typeof o=="function"&&o.apply(this,arguments)})},p.suggest=function(e,i){const o=app.config.version.match(/^\d+\.\d+\.\d+/);$.ajax((app.config.registry||"https://packages.nodebb.org")+"/api/v1/suggest",{type:"GET",data:{package:e,version:o[0]},dataType:"json"}).done(function(h){i(void 0,h)}).fail(i)};function I(){$("#installed ul li").each(function(){$(this).children('[data-action="upgrade"]').length&&$("#upgrade ul").append($(this).clone(!0))})}function t(){$("#installed ul li").each(function(){$(this).hasClass("active")?$("#active ul").append($(this).clone(!0)):$("#deactive ul").append($(this).clone(!0))})}return p}.apply(b,v),f!==void 0&&(E.exports=f)},7927:(E,b,a)=>{var v,f;v=[a(32230),a(7237),a(85233)],f=function(n,m,A){const d={};d.alert=function(t){t.alert_id="alert_button_"+(t.alert_id?t.alert_id:new Date().getTime()),t.title=t.title&&t.title.trim()||"",t.message=t.message?t.message.trim():"",t.type=t.type||"info";const e=$("#"+t.alert_id);e.length?x(e,t):p(t)},d.success=function(t,e){d.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:t,type:"success",timeout:e||5e3})},d.error=function(t,e){if(t=t&&t.message||t,t==="[[error:revalidate-failure]]"){socket.disconnect(),app.reconnect();return}d.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:t,type:"danger",timeout:e||1e4})},d.remove=function(t){$("#alert_button_"+t).remove()};function p(t){app.parseAndTranslate("alert",t,function(e){let i=$("#"+t.alert_id);if(i.length)return x(i,t);i=e,i.fadeIn(200),m.get("toaster/tray").prepend(i),typeof t.closefn=="function"&&i.find("button").on("click",function(){return t.closefn(),y(i),!1}),t.timeout&&I(i,t),typeof t.clickfn=="function"&&i.addClass("pointer").on("click",function(o){$(o.target).is(".close")||t.clickfn(i,t),y(i)}),A.fire("action:alert.new",{alert:i,params:t})})}function x(t,e){t.find("strong").translateHtml(e.title),t.find("p").translateHtml(e.message),t.attr("class","alert alert-dismissable alert-"+e.type+" clearfix"),clearTimeout(parseInt(t.attr("timeoutId"),10)),e.timeout&&I(t,e),A.fire("action:alert.update",{alert:t,params:e}),t.off("click").removeClass("pointer"),typeof e.clickfn=="function"&&t.addClass("pointer").on("click",function(i){$(i.target).is(".close")||e.clickfn(),y(t)})}function y(t){t.fadeOut(500,function(){$(this).remove()})}function I(t,e){const i=e.timeout,o=setTimeout(function(){y(t),typeof e.timeoutfn=="function"&&e.timeoutfn(t,e)},i);t.attr("timeoutId",o),t.css("transition-property","none"),t.removeClass("animate"),setTimeout(function(){t.css("transition-property",""),t.css("transition","width "+(i+450)+"ms linear, background-color "+(i+450)+"ms ease-in"),t.addClass("animate"),A.fire("action:alert.animate",{alert:t,params:e})},50),t.on("mouseenter",function(){$(this).css("transition-duration",0)})}return d}.apply(b,v),f!==void 0&&(E.exports=f)},7237:(E,b,a)=>{var v;v=function(){const f={};return f.core={"topic/teaser":function(n){return n?$('[component="category/topic"][data-tid="'+n+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(n,m){return $('[component="topic"][data-'+n+'="'+m+'"]')},post:function(n,m){return $('[component="post"][data-'+n+'="'+m+'"]')},"post/content":function(n){return $('[component="post"][data-pid="'+n+'"] [component="post/content"]')},"post/header":function(n){return $('[component="post"][data-pid="'+n+'"] [component="post/header"]')},"post/anchor":function(n){return $('[component="post"][data-index="'+n+'"] [component="post/anchor"]')},"post/vote-count":function(n){return $('[component="post"][data-pid="'+n+'"] [component="post/vote-count"]')},"post/bookmark-count":function(n){return $('[component="post"][data-pid="'+n+'"] [component="post/bookmark-count"]')},"user/postcount":function(n){return $('[component="user/postcount"][data-uid="'+n+'"]')},"user/reputation":function(n){return $('[component="user/reputation"][data-uid="'+n+'"]')},"category/topic":function(n,m){return $('[component="category/topic"][data-'+n+'="'+m+'"]')},"categories/category":function(n,m){return $('[component="categories/category"][data-'+n+'="'+m+'"]')},"chat/message":function(n){return $('[component="chat/message"][data-mid="'+n+'"]')},"chat/message/body":function(n){return $('[component="chat/message"][data-mid="'+n+'"] [component="chat/message/body"]')},"chat/recent/room":function(n){return $('[component="chat/recent/room"][data-roomid="'+n+'"]')}},f.get=function(){const n=Array.prototype.slice.call(arguments,1);return f.core[arguments[0]]&&n.length?f.core[arguments[0]].apply(this,n):$('[component="'+arguments[0]+'"]')},f}.call(b,a,b,E),v!==void 0&&(E.exports=v)}}]);
