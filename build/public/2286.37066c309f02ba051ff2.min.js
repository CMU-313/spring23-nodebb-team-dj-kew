"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[2286,7214,6503,6721,6028,3388,8724,6815,1237,2344,560,3382,8786,5655,8306,3034,7073],{59016:(C,E,f)=>{var m,u;m=[f(4695),f(80431),f(50395),f(7927)],u=function(r,p,a,s){const g={};g.prepareDOM=function(){app.user.uid>0&&r.initUnreadTopics(),p.prepareDOM(),a.prepareDOM(),h(),o(),d()};function h(){$('[component="header/usercontrol"] [data-status]').off("click").on("click",function(e){const t=$(this).attr("data-status");socket.emit("user.setStatus",t,function(i){if(i)return s.error(i);$('[data-uid="'+app.user.uid+'"] [component="user/status"], [component="header/profilelink"] [component="user/status"]').removeClass("away online dnd offline").addClass(t),$('[component="header/usercontrol"] [data-status]').each(function(){$(this).find("span").toggleClass("bold",$(this).attr("data-status")===t)}),app.user.status=t}),e.preventDefault()})}function o(){const e=utils.findBootstrapEnvironment();e==="xs"||e==="sm"||utils.isTouchDevice()||($("#header-menu li a[title]").each(function(){$(this).tooltip({placement:"bottom",trigger:"hover",title:$(this).attr("title")})}),$("#search-form").tooltip({placement:"bottom",trigger:"hover",title:$("#search-button i").attr("title")}),$("#user_dropdown").tooltip({placement:"bottom",trigger:"hover",title:$("#user_dropdown").attr("title")}))}function d(){$("#header-menu .container").on("click",'[component="user/logout"]',function(){return f.e(145).then(function(){var e=[f(39002)];(function(t){t()}).apply(null,e)}).catch(f.oe),!1})}return g}.apply(E,m),u!==void 0&&(C.exports=u)},50395:(C,E,f)=>{var m,u;m=[f(7237)],u=function(r){const p={};p.prepareDOM=function(){const o=r.get("chat/dropdown"),d=r.get("chat/list");o.on("click",function(){o.parent().hasClass("open")||h("loadChatsDropdown",d)}),o.parents(".dropdown").hasClass("open")&&h("loadChatsDropdown",d),socket.removeListener("event:chats.receive",a),socket.on("event:chats.receive",a),socket.removeListener("event:user_status_change",s),socket.on("event:user_status_change",s),socket.removeListener("event:chats.roomRename",g),socket.on("event:chats.roomRename",g),socket.on("event:unread.updateChatCount",function(e){r.get("chat/icon").toggleClass("unread-count",e>0).attr("data-content",e>99?"99+":e)})};function a(o){h("onChatMessageReceived",o)}function s(o){h("onUserStatusChange",o)}function g(o){h("onRoomRename",o)}function h(o,d){Promise.all([f.e(3216),f.e(831)]).then(function(){var e=[f(93216)];(function(t){t[o](d)}).apply(null,e)}).catch(f.oe)}return p}.apply(E,m),u!==void 0&&(C.exports=u)},80431:(C,E,f)=>{var m,u;m=[f(7237)],u=function(r){const p={};p.prepareDOM=function(){const h=r.get("notifications"),o=h.children("a"),d=r.get("notifications/list");o.on("click",function(e){e.preventDefault(),!h.hasClass("open")&&g("loadNotifications",d)}),o.parents(".dropdown").hasClass("open")&&g("loadNotifications",d),socket.removeListener("event:new_notification",a),socket.on("event:new_notification",a),socket.removeListener("event:notifications.updateCount",s),socket.on("event:notifications.updateCount",s)};function a(h){g("onNewNotification",h)}function s(h){g("updateNotifCount",h)}function g(h,o){Promise.all([f.e(2840),f.e(9986)]).then(function(){var d=[f(69986)];(function(e){e[h](o)}).apply(null,d)}).catch(f.oe)}return p}.apply(E,m),u!==void 0&&(C.exports=u)},4695:(C,E,f)=>{var m;m=function(){const u={},r={ignoring:1,notwatching:2,watching:3};u.initUnreadTopics=function(){const s=app.user.unreadData;function g(d){if(d&&d.posts&&d.posts.length&&s){const e=d.posts[0];if(parseInt(e.uid,10)===parseInt(app.user.uid,10)||!e.topic.isFollowing&&e.categoryWatchState!==r.watching)return;const t=e.topic.tid;(!s[""][t]||!s.new[t]||!s.watched[t]||!s.unreplied[t])&&o(t),s[""][t]||(h(""),s[""][t]=!0),e.isMain&&parseInt(e.uid,10)!==parseInt(app.user.uid,10)&&!s.new[t]&&(h("new"),s.new[t]=!0),parseInt(e.topic.postcount,10)<=1&&!s.unreplied[t]&&(h("unreplied"),s.unreplied[t]=!0),e.topic.isFollowing&&!s.watched[t]&&(h("watched"),s.watched[t]=!0)}}function h(d){const e="/unread"+(d?"?filter="+d:""),t=1+parseInt($('a[href="'+config.relative_path+e+'"].navigation-link i').attr("data-content"),10);a(e,t)}function o(d){$('[data-tid="'+d+'"]').addClass("unread")}$(window).on("action:ajaxify.end",function(){ajaxify.data.template.topic&&["","new","watched","unreplied"].forEach(function(d){delete s[d][ajaxify.data.tid]})}),socket.removeListener("event:new_post",g),socket.on("event:new_post",g),socket.removeListener("event:unread.updateCount",p),socket.on("event:unread.updateCount",p)};function p(s){a("/unread",s.unreadTopicCount),a("/unread?filter=new",s.unreadNewTopicCount),a("/unread?filter=watched",s.unreadWatchedTopicCount),a("/unread?filter=unreplied",s.unreadUnrepliedTopicCount)}function a(s,g){utils.isNumber(g)&&($('a[href="'+config.relative_path+s+'"].navigation-link i').toggleClass("unread-count",g>0).attr("data-content",g>99?"99+":g),$('#mobile-menu [data-unread-url="'+s+'"]').attr("data-content",g>99?"99+":g))}return u.updateUnreadTopicCount=a,u}.call(E,f,E,C),m!==void 0&&(C.exports=m)},78989:(C,E,f)=>{var m,u;m=[f(31369)],u=function(r){const p={};return p.init=function(){$("body").on("click",'[component="pagination/select-page"]',function(){return r.prompt("[[global:enter_page_number]]",function(a){p.loadPage(a)}),!1})},p.loadPage=function(a,s){if(s=s||function(){},a=parseInt(a,10),!utils.isNumber(a)||a<1||a>ajaxify.data.pagination.pageCount)return;const g=utils.params();g.page=a;const h=window.location.pathname+"?"+$.param(g);ajaxify.go(h,s)},p.nextPage=function(a){p.loadPage(ajaxify.data.pagination.currentPage+1,a)},p.previousPage=function(a){p.loadPage(ajaxify.data.pagination.currentPage-1,a)},p}.apply(E,m),u!==void 0&&(C.exports=u)},7927:(C,E,f)=>{var m,u;m=[f(32230),f(7237),f(85233)],u=function(r,p,a){const s={};s.alert=function(e){e.alert_id="alert_button_"+(e.alert_id?e.alert_id:new Date().getTime()),e.title=e.title&&e.title.trim()||"",e.message=e.message?e.message.trim():"",e.type=e.type||"info";const t=$("#"+e.alert_id);t.length?h(t,e):g(e)},s.success=function(e,t){s.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:e,type:"success",timeout:t||5e3})},s.error=function(e,t){if(e=e&&e.message||e,e==="[[error:revalidate-failure]]"){socket.disconnect(),app.reconnect();return}s.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:e,type:"danger",timeout:t||1e4})},s.remove=function(e){$("#alert_button_"+e).remove()};function g(e){app.parseAndTranslate("alert",e,function(t){let i=$("#"+e.alert_id);if(i.length)return h(i,e);i=t,i.fadeIn(200),p.get("toaster/tray").prepend(i),typeof e.closefn=="function"&&i.find("button").on("click",function(){return e.closefn(),o(i),!1}),e.timeout&&d(i,e),typeof e.clickfn=="function"&&i.addClass("pointer").on("click",function(c){$(c.target).is(".close")||e.clickfn(i,e),o(i)}),a.fire("action:alert.new",{alert:i,params:e})})}function h(e,t){e.find("strong").translateHtml(t.title),e.find("p").translateHtml(t.message),e.attr("class","alert alert-dismissable alert-"+t.type+" clearfix"),clearTimeout(parseInt(e.attr("timeoutId"),10)),t.timeout&&d(e,t),a.fire("action:alert.update",{alert:e,params:t}),e.off("click").removeClass("pointer"),typeof t.clickfn=="function"&&e.addClass("pointer").on("click",function(i){$(i.target).is(".close")||t.clickfn(),o(e)})}function o(e){e.fadeOut(500,function(){$(this).remove()})}function d(e,t){const i=t.timeout,c=setTimeout(function(){o(e),typeof t.timeoutfn=="function"&&t.timeoutfn(e,t)},i);e.attr("timeoutId",c),e.css("transition-property","none"),e.removeClass("animate"),setTimeout(function(){e.css("transition-property",""),e.css("transition","width "+(i+450)+"ms linear, background-color "+(i+450)+"ms ease-in"),e.addClass("animate"),a.fire("action:alert.animate",{alert:e,params:t})},50),e.on("mouseenter",function(){$(this).css("transition-duration",0)})}return s}.apply(E,m),u!==void 0&&(C.exports=u)},7237:(C,E,f)=>{var m;m=function(){const u={};return u.core={"topic/teaser":function(r){return r?$('[component="category/topic"][data-tid="'+r+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(r,p){return $('[component="topic"][data-'+r+'="'+p+'"]')},post:function(r,p){return $('[component="post"][data-'+r+'="'+p+'"]')},"post/content":function(r){return $('[component="post"][data-pid="'+r+'"] [component="post/content"]')},"post/header":function(r){return $('[component="post"][data-pid="'+r+'"] [component="post/header"]')},"post/anchor":function(r){return $('[component="post"][data-index="'+r+'"] [component="post/anchor"]')},"post/vote-count":function(r){return $('[component="post"][data-pid="'+r+'"] [component="post/vote-count"]')},"post/bookmark-count":function(r){return $('[component="post"][data-pid="'+r+'"] [component="post/bookmark-count"]')},"user/postcount":function(r){return $('[component="user/postcount"][data-uid="'+r+'"]')},"user/reputation":function(r){return $('[component="user/reputation"][data-uid="'+r+'"]')},"category/topic":function(r,p){return $('[component="category/topic"][data-'+r+'="'+p+'"]')},"categories/category":function(r,p){return $('[component="categories/category"][data-'+r+'="'+p+'"]')},"chat/message":function(r){return $('[component="chat/message"][data-mid="'+r+'"]')},"chat/message/body":function(r){return $('[component="chat/message"][data-mid="'+r+'"] [component="chat/message/body"]')},"chat/recent/room":function(r){return $('[component="chat/recent/room"][data-roomid="'+r+'"]')}},u.get=function(){const r=Array.prototype.slice.call(arguments,1);return u.core[arguments[0]]&&r.length?u.core[arguments[0]].apply(this,r):$('[component="'+arguments[0]+'"]')},u}.call(E,f,E,C),m!==void 0&&(C.exports=m)},11120:C=>{C.exports=function(E,f,m){f.setGlobal("true",!0),f.setGlobal("false",!1);const u={displayMenuItem:p,buildMetaTag:a,buildLinkTag:s,stringify:g,escape:h,stripTags:o,generateCategoryBackground:d,generateChildrenCategories:e,generateTopicClass:t,membershipBtn:i,spawnPrivilegeStates:c,localeToHTML:y,renderTopicImage:k,renderTopicEvents:T,renderEvents:R,renderDigestAvatar:w,userAgentIcons:x,buildAvatar:I,register:S,__escape:r};function r(n){return n}function p(n,l){const v=n.navigation[l];return!(!v||v.route.match("/users")&&n.user&&!n.user.privileges["view:users"]||v.route.match("/tags")&&n.user&&!n.user.privileges["view:tags"]||v.route.match("/groups")&&n.user&&!n.user.privileges["view:groups"])}function a(n){const l=n.name?'name="'+n.name+'" ':"",v=n.property?'property="'+n.property+'" ':"",b=n.content?'content="'+n.content.replace(/\n/g," ")+'" ':"";return"<meta "+l+v+b+`/>
	`}function s(n){const l=["link","rel","as","type","href","sizes","title","crossorigin"],[v,b,_,A,D,M,N,U]=l.map(P=>n[P]?`${P}="${n[P]}" `:"");return"<link "+v+b+_+A+M+N+D+U+`/>
	`}function g(n){return JSON.stringify(n).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")}function h(n){return E.escapeHTML(n)}function o(n){return E.stripHTMLTags(n)}function d(n){if(!n)return"";const l=[];return n.bgColor&&l.push("background-color: "+n.bgColor),n.color&&l.push("color: "+n.color),n.backgroundImage&&(l.push("background-image: url("+n.backgroundImage+")"),n.imageClass&&l.push("background-size: "+n.imageClass)),l.join("; ")+";"}function e(n){let l="";return!n||!n.children||!n.children.length||(n.children.forEach(function(v){if(v&&!v.isSection){const b=v.link?v.link:m+"/category/"+v.slug;l+='<span class="category-children-item pull-left"><div role="presentation" class="icon pull-left" style="'+d(v)+'"><i class="fa fa-fw '+v.icon+'"></i></div><a href="'+b+'"><small>'+v.name+"</small></a></span>"}}),l=l&&'<span class="category-children">'+l+"</span>"),l}function t(n){return["locked","pinned","deleted","unread","scheduled"].filter(v=>!!n[v]).join(" ")}function i(n){return n.isMember&&n.name!=="administrators"?'<button class="btn btn-danger" data-action="leave" data-group="'+n.displayName+'"'+(n.disableLeave?" disabled":"")+'><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>':n.isPending&&n.name!=="administrators"?'<button class="btn btn-warning disabled"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>':n.isInvited?'<button class="btn btn-link" data-action="rejectInvite" data-group="'+n.displayName+'">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="'+n.name+'"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>':!n.disableJoinRequests&&n.name!=="administrators"?'<button class="btn btn-success" data-action="join" data-group="'+n.displayName+'"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>':""}function c(n,l){const v=[];for(const b in l)l.hasOwnProperty(b)&&v.push({name:b,state:l[b]});return v.map(function(b){const _=["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"],A=["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"],D=["groups:moderate"],M=n==="guests"&&(_.includes(b.name)||b.name.startsWith("groups:admin:"))||n==="spiders"&&!A.includes(b.name)||n==="Global Moderators"&&D.includes(b.name);return'<td class="text-center" data-privilege="'+b.name+'" data-value="'+b.state+'"><input autocomplete="off" type="checkbox"'+(b.state?" checked":"")+(M?' disabled="disabled"':"")+" /></td>"}).join("")}function y(n,l){return n=n||l||"en-GB",n.replace("_","-")}function k(n){return n.thumb?'<img src="'+n.thumb+'" class="img-circle user-img" title="'+n.user.username+'" />':'<img component="user/picture" data-uid="'+n.user.uid+'" src="'+n.user.picture+'" class="user-img" title="'+n.user.username+'" />'}function T(n,l){if(l==="most_votes")return"";const v=this.posts[n].eventStart,b=this.posts[n].eventEnd,_=this.events.filter(A=>A.timestamp>=v&&A.timestamp<b);return _.length?R.call(this,_):""}function R(n){return n.reduce((l,v)=>(l+=`<li component="topic/event" class="timeline-event" data-topic-event-id="${v.id}" data-topic-event-type="${v.type}">
                <div class="timeline-badge">
                    <i class="fa ${v.icon||"fa-circle"}"></i>
                </div>
                <span class="timeline-text">
                    ${v.href?`<a href="${m}${v.href}">${v.text}</a>`:v.text}&nbsp;
                </span>
            `,v.user&&(v.user.system?l+='<span class="timeline-text">[[global:system-user]]</span>&nbsp;':l+=`<span><a href="${m}/user/${v.user.userslug}">${I(v.user,"xs",!0)}&nbsp;${v.user.username}</a></span>&nbsp;`),l+=`<span class="timeago timeline-text" title="${v.timestampISO}"></span>`,this.privileges.isAdminOrMod&&(l+=`&nbsp;<span component="topic/event/delete" data-topic-event-id="${v.id}" data-topic-event-type="${v.type} class="timeline-text pointer" title="[[topic:delete-event]]"><i class="fa fa-trash"></i></span>`),l),"")}function w(n){return n.teaser?n.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+n.teaser.user.picture+'" title="'+n.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+n.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+n.teaser.user["icon:text"]+"</div>":n.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+n.user.picture+'" title="'+n.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+n.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+n.user["icon:text"]+"</div>"}function x(n){let l="";switch(n.platform){case"Linux":l+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":l+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":l+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":l+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":l+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":l+='<i class="fa fa-fw fa-mobile"></i>';break;default:l+='<i class="fa fa-fw fa-question-circle"></i>';break}switch(n.browser){case"Chrome":l+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":l+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":l+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":l+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":l+='<i class="fa fa-fw fa-edge"></i>';break;default:l+='<i class="fa fa-fw fa-question-circle"></i>';break}return l}function I(n,l,v,b,_){n||(n=this);const A=['alt="'+n.username+'"','title="'+n.username+'"','data-uid="'+n.uid+'"','loading="lazy"'],D=[];return b=b||"",["xs","sm","sm2x","md","lg","xl"].includes(l)?b+=" avatar-"+l:isNaN(parseInt(l,10))?b+=" avatar-sm":D.push("width: "+l+"px;","height: "+l+"px;","line-height: "+l+"px;","font-size: "+parseInt(l,10)/16+"rem;"),A.unshift('class="avatar '+b+(v?" avatar-rounded":"")+'"'),_?A.push('component="'+_+'"'):A.push('component="avatar/'+(n.picture?"picture":"icon")+'"'),n.picture?"<img "+A.join(" ")+' src="'+n.picture+'" style="'+D.join(" ")+'" />':(D.push("background-color: "+n["icon:bgColor"]+";"),"<span "+A.join(" ")+' style="'+D.join(" ")+'">'+n["icon:text"]+"</span>")}function S(){Object.keys(u).forEach(function(n){f.registerHelper(n,u[n])})}return u}},59265:(C,E,f)=>{var m,u;const r=f(11120);m=[f(96795),f(59006)],u=function(p,a){return r(p,a,config.relative_path)}.apply(E,m),u!==void 0&&(C.exports=u)},44882:(C,E,f)=>{var m,u;m=[f(31369),f(32230),f(66603),f(7927),f(85233)],u=function(r,p,a,s,g){const h={};let o,d;h.show=function(){g.one("action:ajaxify.end",()=>{t(),e(),h.showEmailConfirmWarning()})},h.showEmailConfirmWarning=function(i){if(!config.emailPrompt||!app.user.uid||parseInt(a.getItem("email-confirm-dismiss"),10)===1)return;const c={alert_id:"email_confirm",type:"warning",timeout:0,closefn:()=>{a.setItem("email-confirm-dismiss",1)}};app.user.email?!app.user["email:confirmed"]&&!app.user.isEmailConfirmSent?(c.message=i||"[[error:email-not-confirmed]]",c.clickfn=function(){s.remove("email_confirm"),ajaxify.go("/me/edit/email")},s.alert(c)):!app.user["email:confirmed"]&&app.user.isEmailConfirmSent&&(c.message="[[error:email-not-confirmed-email-sent]]",s.alert(c)):(c.message="[[error:no-email-to-confirm]]",c.clickfn=function(){s.remove("email_confirm"),ajaxify.go("user/"+app.user.userslug+"/edit/email")},s.alert(c))};function e(){!config.cookies.enabled||!navigator.cookieEnabled||app.inAdmin||a.getItem("cookieconsent")==="1"||(config.cookies.message=p.unescape(config.cookies.message),config.cookies.dismiss=p.unescape(config.cookies.dismiss),config.cookies.link=p.unescape(config.cookies.link),config.cookies.link_url=p.unescape(config.cookies.link_url),app.parseAndTranslate("partials/cookie-consent",config.cookies,function(i){$(document.body).append(i),$(document.body).addClass("cookie-consent-open");const c=$(".cookie-consent");c.find("button").on("click",function(){a.setItem("cookieconsent","1"),c.remove(),$(document.body).removeClass("cookie-consent-open")})}))}function t(){const i=utils.params({full:!0});o=i.has("loggedin"),d=i.get("register"),o&&(s.alert({type:"success",title:"[[global:welcome_back]] "+app.user.username+"!",message:"[[global:you_have_successfully_logged_in]]",timeout:5e3}),i.delete("loggedin")),d&&(r.alert({message:utils.escapeHTML(decodeURIComponent(d))}),i.delete("register")),i.has("lang")&&i.get("lang")===config.defaultLang&&(console.info(`The "lang" parameter was passed in to set the language to "${i.get("lang")}", but that is already the forum default language.`),i.delete("lang"));const c=i.toString();ajaxify.updateHistory(ajaxify.currentPage+(c?`?${c}`:"")+document.location.hash,!0)}return h.showInvalidSession=function(){r.alert({title:"[[error:invalid-session]]",message:"[[error:invalid-session-text]]",closeButton:!1,callback:function(){window.location.reload()}})},h.showSessionMismatch=function(){r.alert({title:"[[error:session-mismatch]]",message:"[[error:session-mismatch-text]]",closeButton:!1,callback:function(){window.location.reload()}})},h}.apply(E,m),u!==void 0&&(C.exports=u)},7073:(C,E,f)=>{var m,u;m=[f(32230),f(66603),f(85233),f(7927)],u=function(r,p,a,s){const g={current:{}};g.init=function(o){if(!config.searchEnabled)return;o=o||{in:config.searchDefaultInQuick||"titles"};const d=$("#search-button"),e=$("#search-fields"),t=$("#search-fields input"),i=$("#quick-search-container");$("#search-form .advanced-search-link").off("mousedown").on("mousedown",function(){ajaxify.go("/search")}),$("#search-form").off("submit").on("submit",function(){t.blur()}),t.off("blur").on("blur",function(){setTimeout(function(){t.is(":focus")||(e.addClass("hidden"),d.removeClass("hidden"))},200)}),t.off("focus");const c={inputEl:t,resultEl:i};g.enableQuickSearch({searchOptions:o,searchElements:c}),d.off("click").on("click",function(y){return!config.loggedIn&&!app.user.privileges["search:content"]?(s.alert({message:"[[error:search-requires-login]]",timeout:3e3}),ajaxify.go("login"),!1):(y.stopPropagation(),g.showAndFocusInput(),!1)}),$("#search-form").off("submit").on("submit",function(){const y=$(this).find("input"),k=g.getSearchPreferences();return k.term=y.val(),k.in=o.in,a.fire("action:search.submit",{searchOptions:k,searchElements:c}),g.query(k,function(){y.val("")}),!1})},g.enableQuickSearch=function(o){if(!config.searchEnabled||!app.user.privileges["search:content"])return;const d=Object.assign({in:config.searchDefaultInQuick||"titles"},o.searchOptions),e=o.searchElements.resultEl,t=o.searchElements.inputEl;let i=t.val();const c=e.find(".filter-category");function y(){ajaxify.data.template.category&&ajaxify.data.cid&&r.translate("[[search:search-in-category, "+ajaxify.data.name+"]]",function(w){const x=$("<div></div>").html(w).text();c.find(".name").text(x)}),c.toggleClass("hidden",!(ajaxify.data.template.category&&ajaxify.data.cid))}function k(){o.searchOptions=Object.assign({},d),o.searchOptions.term=t.val(),y(),ajaxify.data.template.category&&ajaxify.data.cid&&c.find('input[type="checkbox"]').is(":checked")&&(o.searchOptions.categories=[ajaxify.data.cid],o.searchOptions.searchChildren=!0),e.removeClass("hidden").find(".quick-search-results-container").html(""),e.find(".loading-indicator").removeClass("hidden"),a.fire("action:search.quick.start",o),o.searchOptions.searchOnly=1,g.api(o.searchOptions,function(w){if(e.find(".loading-indicator").addClass("hidden"),!w.posts||o.hideOnNoMatches&&!w.posts.length)return e.addClass("hidden").find(".quick-search-results-container").html("");w.posts.forEach(function(x){const I=$("<div>"+x.content+"</div>").text(),S=t.val().toLowerCase().replace(/^in:topic-\d+/,""),n=Math.max(0,I.toLowerCase().indexOf(S)-40);x.snippet=utils.escapeHTML((n>0?"...":"")+I.slice(n,n+80)+(I.length-n>80?"...":""))}),app.parseAndTranslate("partials/quick-search-results",w,function(x){x.length&&x.find(".timeago").timeago(),e.toggleClass("hidden",!x.length||!t.is(":focus")).find(".quick-search-results-container").html(x.length?x:"");const I=e.find(".quick-search-results .quick-search-title, .quick-search-results .snippet");g.highlightMatches(o.searchOptions.term,I),a.fire("action:search.quick.complete",{data:w,options:o})})})}e.find('.filter-category input[type="checkbox"]').on("change",function(){t.focus(),k()}),t.off("keyup").on("keyup",utils.debounce(function(){if(t.val().length<3){e.addClass("hidden"),i=t.val();return}if(t.val()!==i){if(i=t.val(),!t.is(":focus"))return e.addClass("hidden");k()}},500));let T=!1;e.on("mousedown",function(){$(window).one("mouseup",function(){e.addClass("hidden")}),T=!0}),t.on("blur",function(){!t.is(":focus")&&!T&&!e.hasClass("hidden")&&e.addClass("hidden")});let R=!1;a.on("action:ajaxify.end",function(){ajaxify.isCold()||(R=!0)}),t.on("focus",function(){T=!1;const w=t.val();i=w,w&&e.find("#quick-search-results").children().length&&(y(),R?(k(),R=!1):e.removeClass("hidden"),t[0].setSelectionRange(w.startsWith("in:topic")?w.indexOf(" ")+1:0,w.length))}),t.off("refresh").on("refresh",function(){k()})},g.showAndFocusInput=function(){$("#search-fields").removeClass("hidden"),$("#search-button").addClass("hidden"),$("#search-fields input").focus()},g.query=function(o,d){d=d||function(){},ajaxify.go("search?"+h(o)),d()},g.api=function(o,d){const e=config.relative_path+"/api/search?"+h(o);o.searchOnly=void 0;const t=config.relative_path+"/search?"+h(o);$.get(e,function(i){i.url=t,d(i)})};function h(o){const d=o.in||"titles",e=o.by||"";let t=o.term.replace(/^[ ?#]*/,"");try{t=encodeURIComponent(t)}catch{return s.error("[[error:invalid-search-term]]")}const i={term:t,in:d};return o.matchWords&&(i.matchWords=o.matchWords),e&&e.length&&(d==="posts"||d==="titles"||d==="titlesposts")&&(i.by=e),o.categories&&o.categories.length&&(i.categories=o.categories,o.searchChildren&&(i.searchChildren=o.searchChildren)),o.hasTags&&o.hasTags.length&&(i.hasTags=o.hasTags),parseInt(o.replies,10)>0&&(i.replies=o.replies,i.repliesFilter=o.repliesFilter||"atleast"),o.timeRange&&(i.timeRange=o.timeRange,i.timeFilter=o.timeFilter||"newer"),o.sortBy&&(i.sortBy=o.sortBy,i.sortDirection=o.sortDirection),o.showAs&&(i.showAs=o.showAs),o.searchOnly&&(i.searchOnly=o.searchOnly),a.fire("action:search.createQueryString",{query:i,data:o}),decodeURIComponent($.param(i))}return g.getSearchPreferences=function(){try{return JSON.parse(p.getItem("search-preferences")||"{}")}catch{return{}}},g.highlightMatches=function(o,d){if(!o||!d.length)return;o=utils.escapeHTML(o.replace(/^"/,"").replace(/"$/,"").trim());const e=o.split(" ").map(function(i){return utils.escapeRegexChars(i)}).join("|"),t=new RegExp("("+e+")","gi");d.each(function(){const i=$(this),c=[];i.find("*").each(function(){$(this).after("<!-- "+c.length+" -->"),c.push($("<div></div>").append($(this)))}),i.html(i.html().replace(t,function(y,k){return'<strong class="search-match">'+k+"</strong>"})),c.forEach(function(y,k){i.html(i.html().replace("<!-- "+k+" -->",function(){return y.html()}))})}),$(".search-result-text").find("img:not(.not-responsive)").addClass("img-responsive")},g}.apply(E,m),u!==void 0&&(C.exports=u)},66603:(C,E,f)=>{var m;m=function(){function u(){this._store={},this._keys=[]}u.prototype.isMock=!0,u.prototype.setItem=function(a,s){a=String(a),this._keys.indexOf(a)===-1&&this._keys.push(a),this._store[a]=s},u.prototype.getItem=function(a){return a=String(a),this._keys.indexOf(a)===-1?null:this._store[a]},u.prototype.removeItem=function(a){a=String(a),this._keys=this._keys.filter(function(s){return s!==a}),this._store[a]=null},u.prototype.clear=function(){this._keys=[],this._store={}},u.prototype.key=function(a){return a=parseInt(a,10)||0,this._keys[a]},Object.defineProperty&&Object.defineProperty(u.prototype,"length",{get:function(){return this._keys.length}});let r;const p=Date.now().toString();try{if(r=window.localStorage,r.setItem(p,p),r.getItem(p)!==p)throw Error("localStorage behaved unexpectedly");return r.removeItem(p),r}catch(a){console.warn(a),console.warn("localStorage failed, falling back on sessionStorage");try{if(r=window.sessionStorage,r.setItem(p,p),r.getItem(p)!==p)throw Error("sessionStorage behaved unexpectedly");return r.removeItem(p),r}catch(s){return console.warn(s),console.warn("sessionStorage failed, falling back on memory storage"),new u}}}.call(E,f,E,C),m!==void 0&&(C.exports=m)},27145:(C,E,f)=>{C=f.nmd(C);var m,u;m=[f(59006),f(32230),f(85233)],u=function(r,p,a){const s={};s.init=function(){const e=this;r.render("modules/taskbar",{}).then(function(t){e.taskbar=$(t),e.tasklist=e.taskbar.find("ul"),$(document.body).append(e.taskbar),e.taskbar.on("click","li",async function(){const i=$(this),c=i.attr("data-module"),y=i.attr("data-uuid"),k=await app.require(c);return i.hasClass("active")?k.minimize(y):(h(),k.load(y),s.toggleNew(y,!1),s.tasklist.removeClass("active"),i.addClass("active")),!1})}),$(window).on("action:app.loggedOut",function(){s.closeAll()})},s.close=async function(e,t){const i=s.tasklist.find('[data-module="'+C+'"][data-uuid="'+t+'"]');let c="close";if(e==="chat"&&(c="closeByUUID"),i.length){const y=await app.require(e);y&&typeof y[c]=="function"&&y[c](t)}},s.closeAll=function(e){let t="[data-uuid]";e&&(t='[data-module="'+e+'"]'+t),s.tasklist.find(t).each(function(i,c){s.close(e||c.getAttribute("data-module"),c.getAttribute("data-uuid"))})},s.discard=function(e,t){s.tasklist.find('[data-module="'+e+'"][data-uuid="'+t+'"]').remove(),g()},s.push=function(e,t,i,c){c=c||function(){};const y=s.tasklist.find('li[data-uuid="'+t+'"]'),k={module:e,uuid:t,options:i,element:y};a.fire("filter:taskbar.push",k),!y.length&&k.module?o(k,c):c(y)},s.get=function(e){return $('[data-module="'+e+'"]').map(function(i,c){return $(c).data()})},s.minimize=function(e,t){s.tasklist.find('[data-module="'+e+'"][data-uuid="'+t+'"]').toggleClass("active",!1)},s.toggleNew=function(e,t,i){s.tasklist.find('[data-uuid="'+e+'"]').toggleClass("new",t),i||a.fire("action:taskbar.toggleNew",e)},s.updateActive=function(e){const t=s.tasklist.find("li");t.removeClass("active"),t.filter('[data-uuid="'+e+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+e+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},s.isActive=function(e){return s.tasklist.find('li[data-uuid="'+e+'"]').hasClass("active")};function g(){s.tasklist.find("li").length>0?s.taskbar.attr("data-active","1"):s.taskbar.removeAttr("data-active")}function h(){s.tasklist.find(".active").removeClass("active")}function o(e,t){p.translate(e.options.title,function(i){const c=$("<div></div>").text(i||"NodeBB Task").html(),y=$("<li></li>").addClass(e.options.className).html('<a href="#"'+(e.options.image?` style="background-image: url('`+e.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(e.options.icon?'<i class="fa '+e.options.icon+'"></i> ':"")+'<span aria-label="'+c+'" component="taskbar/title">'+c+"</span></a>").attr({title:c,"data-module":e.module,"data-uuid":e.uuid}).addClass(e.options.state!==void 0?e.options.state:"active");(!e.options.state||e.options.state==="active")&&h(),s.tasklist.append(y),g(),e.element=y,y.data(e),a.fire("action:taskbar.pushed",e),t(y)})}const d=function(e,t,i){switch(t){case"title":e.find('[component="taskbar/title"]').text(i);break;case"icon":e.find("i").attr("class","fa fa-"+i);break;case"image":e.find("a").css("background-image",i?'url("'+i.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":e.find("a").css("background-color",i);break}};return s.update=function(e,t,i){const c=s.tasklist.find('[data-module="'+e+'"][data-uuid="'+t+'"]');if(!c.length)return;const y=c.data();Object.keys(i).forEach(function(k){y[k]=i[k],d(c,k,i[k])}),c.data(y)},s}.apply(E,m),u!==void 0&&(C.exports=u)}}]);
