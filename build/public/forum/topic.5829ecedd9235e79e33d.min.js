"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[9285,4781],{64451:(E,w,i)=>{var k,h;k=[i(25142),i(60392),i(54939),i(91748),i(60447),i(42840),i(69241),i(7237),i(66603),i(85233),i(74344),i(7927)],h=function(j,y,v,x,u,p,T,m,f,c,C,g){const l={};let I=0,A="";$(window).on("action:ajaxify.start",function(o,e){x.removeListeners(),String(e.url).startsWith("topic/")||(p.disable(),m.get("navbar/title").find("span").text("").hide(),g.remove("bookmark"))}),l.init=function(){const o=!I||parseInt(I,10)!==parseInt(ajaxify.data.tid,10);I=ajaxify.data.tid,A=ajaxify.currentPage,c.fire("action:topic.loading"),app.enterRoom("topic_"+I),o&&(u.signaturesShown={}),u.onTopicPageLoad(m.get("post")),p.init('[component="post"]',ajaxify.data.postcount,l.toTop,l.toBottom,utils.debounce(l.navigatorCallback,500)),v.init(I),y.init(I,$(".topic")),x.init(),T.handleSort("topicPostSort","topic/"+ajaxify.data.slug),config.usePagination||j.init($('[component="topic"]'),u.loadMorePosts),b(),B(),R(),N(),t(),L(I),$(window).on("scroll",utils.debounce(a,250)),U(),c.fire("action:topic.loaded",ajaxify.data)};function U(){i.e(2441).then(function(){var o=[i(42441)];(e=>{config.topicSearchEnabled&&i.e(7073).then(function(){var n=[i(7073)];(function(s){e.bind(["command+f","ctrl+f"],function(r){r.preventDefault(),$("#search-fields input").val("in:topic-"+ajaxify.data.tid+" "),s.showAndFocusInput()}),c.onPage("action:ajaxify.cleanup",()=>{e.unbind(["command+f","ctrl+f"])})}).apply(null,n)}).catch(i.oe),e.bind("j",()=>{const n=p.getIndex(),s=p.getCount();n!==s&&p.scrollToIndex(n,!0,0)}),e.bind("k",()=>{const n=p.getIndex();n!==1&&p.scrollToIndex(n-2,!0,0)})}).apply(null,o)}).catch(i.oe)}l.toTop=function(){p.scrollTop(0)},l.toBottom=function(){socket.emit("topics.postcount",ajaxify.data.tid,function(o,e){if(o)return g.error(o);p.scrollBottom(e-1)})};function L(o){if(window.location.hash){const s=$(utils.escapeHTML(window.location.hash));if(s.length)return p.scrollToElement(s,!0,0)}const e=ajaxify.data.bookmark||f.getItem("topic:"+o+":bookmark"),n=ajaxify.data.postIndex;if(n>1){if(m.get("post/anchor",n-1).length)return p.scrollToPostIndex(n-1,!0,0)}else e&&(!config.usePagination||config.usePagination&&ajaxify.data.pagination.currentPage===1)&&ajaxify.data.postcount>ajaxify.data.bookmarkThreshold&&(g.alert({alert_id:"bookmark",message:"[[topic:bookmark_instructions]]",timeout:0,type:"info",clickfn:function(){p.scrollToIndex(parseInt(e,10),!0)},closefn:function(){f.removeItem("topic:"+o+":bookmark")}}),setTimeout(function(){g.remove("bookmark")},1e4))}function b(){m.get("topic").on("click","blockquote .toggle",function(){const o=$(this).parent("blockquote"),e=$(this);o.toggleClass("uncollapsed");const n=!o.hasClass("uncollapsed");e.toggleClass("fa-angle-down",n).toggleClass("fa-angle-up",!n)})}function B(){m.get("topic").on("click",'[component="post/parent"]',function(o){const e=$(this).attr("data-topid"),n=$('[component="topic"]>[component="post"][data-pid="'+e+'"]');if(n.length)return o.preventDefault(),p.scrollToIndex(n.attr("data-index"),!0),!1})}l.applyDropup=function(){const o=this.getBoundingClientRect(),e=this.querySelector(".dropdown-menu"),s=window.getComputedStyle(e).getPropertyValue("height").slice(0,-2),r=60,D=o.top+o.height-s-r>0;this.classList.toggle("dropup",D)};function R(){const o=$("#content .dropdown-menu").parent();$(o).on("shown.bs.dropdown",function(){this.querySelector(".dropdown-menu").innerHTML&&l.applyDropup.call(this)}),c.onPage("action:topic.tools.load",({element:e})=>{l.applyDropup.call(e.get(0).parentNode)}),c.onPage("action:post.tools.load",({element:e})=>{l.applyDropup.call(e.get(0).parentNode)})}function N(){$('[component="topic"]').on("click",'[component="post/reply-count"]',function(){const o=$(this);i.e(1352).then(function(){var e=[i(21352)];(function(n){n.init(o)}).apply(null,e)}).catch(i.oe)})}function t(){if(!ajaxify.data.showPostPreviewsOnHover||utils.isMobile())return;let o=0;const e={};$(window).one("action:ajaxify.start",function(){clearTimeout(o),$("#post-tooltip").remove()}),$('[component="topic"]').on("mouseenter",'[component="post"] a, [component="topic/event"] a',async function(){const n=$(this);async function s(P){const S=e[P]||await socket.emit("posts.getPostSummaryByPid",{pid:P});if($("#post-tooltip").remove(),S&&ajaxify.data.template.topic){e[P]=S;const W=await app.parseAndTranslate("partials/topic/post-preview",{post:S});W.hide().find(".timeago").timeago(),W.appendTo($("body")).fadeIn(300);const F=n.parents('[component="topic"]').find('[component="post/content"]').first(),Y=F.offset(),Q=F.width(),V=n.offset();W.css({top:V.top+30,left:Y.left,width:Q})}}const r=n.attr("href"),D=utils.urlToLocation(r),M=D.pathname,O=r&&r!=="#"&&window.location.hostname===D.hostname;$("#post-tooltip").remove();const H=O&&M&&M.match(/\/post\/([\d]+)/),K=O&&M&&M.match(/\/topic\/([\d]+)/);if(H){const P=H[1];if(parseInt(n.parents('[component="post"]').attr("data-pid"),10)===parseInt(P,10))return;o=setTimeout(async()=>{s(P)},300)}else K&&(o=setTimeout(async()=>{const P=K[1],S=await C.get("/topics/"+P,{});s(S.mainPid)},300))}).on("mouseleave",'[component="post"] a, [component="topic/event"] a',function(){clearTimeout(o),$("#post-tooltip").remove()})}function a(){const o=m.get("navbar/title").find("span");$(window).scrollTop()>50&&o.hasClass("hidden")?o.html(ajaxify.data.title).removeClass("hidden"):$(window).scrollTop()<=50&&!o.hasClass("hidden")&&o.html("").addClass("hidden"),$(window).scrollTop()>300&&g.remove("bookmark")}l.navigatorCallback=function(o,e){if(!ajaxify.data.template.topic||p.scrollActive)return;const n="topic/"+ajaxify.data.slug+(o>1?"/"+o:"");if(n!==A&&(A=n,o>=e&&app.user.uid&&socket.emit("topics.markAsRead",[ajaxify.data.tid]),d(o),l.replaceURLTimeout=0,ajaxify.data.updateUrlWithPostIndex&&history.replaceState)){let s=window.location.search||"";config.usePagination||(s=s&&!/^\?page=\d+$/.test(s)?s:""),history.replaceState({url:n+s},null,window.location.protocol+"//"+window.location.host+config.relative_path+"/"+n+s)}};function d(o){const e="topic:"+ajaxify.data.tid+":bookmark",n=ajaxify.data.bookmark||f.getItem(e);config.topicPostSort==="newest_to_oldest"&&(o=Math.max(1,ajaxify.data.postcount-o+2)),ajaxify.data.postcount>ajaxify.data.bookmarkThreshold&&(!n||parseInt(o,10)>parseInt(n,10)||ajaxify.data.postcount<parseInt(n,10))&&(app.user.uid?socket.emit("topics.bookmark",{tid:ajaxify.data.tid,index:o},function(s){if(s)return g.error(s);ajaxify.data.bookmark=o+1}):f.setItem(e,o)),(!n||parseInt(o,10)>=parseInt(n,10))&&g.remove("bookmark")}return l}.apply(w,k),h!==void 0&&(E.exports=h)},91748:(E,w,i)=>{var k,h;k=[i(54939),i(60392),i(60447),i(47720),i(7237),i(32230),i(59006),i(85233)],h=function(j,y,v,x,u,p,T,m){const f={},c={"event:user_status_change":C,"event:voted":g,"event:bookmarked":l,"event:topic_deleted":y.setDeleteState,"event:topic_restored":y.setDeleteState,"event:topic_purged":I,"event:topic_locked":y.setLockedState,"event:topic_unlocked":y.setLockedState,"event:topic_pinned":y.setPinnedState,"event:topic_unpinned":y.setPinnedState,"event:topic_moved":A,"event:post_edited":U,"event:post_purged":L,"event:post_deleted":b,"event:post_restored":b,"posts.bookmark":B,"posts.unbookmark":B,"posts.upvote":R,"posts.downvote":R,"posts.unvote":R,"event:new_notification":N,"event:new_post":v.onNewPost};f.init=function(){f.removeListeners();for(const t in c)c.hasOwnProperty(t)&&socket.on(t,c[t])},f.removeListeners=function(){for(const t in c)c.hasOwnProperty(t)&&socket.removeListener(t,c[t])};function C(t){app.updateUserStatus($('[data-uid="'+t.uid+'"] [component="user/status"]'),t.status)}function g(t){const a=$('[data-pid="'+t.post.pid+'"] [component="post/vote-count"]').filter(function(o,e){return parseInt($(e).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)}),d=$('.reputation[data-uid="'+t.post.uid+'"]');a.html(t.post.votes).attr("data-votes",t.post.votes),d.html(t.user.reputation).attr("data-reputation",t.user.reputation)}function l(t){$('[data-pid="'+t.post.pid+'"] .bookmarkCount').filter(function(a,d){return parseInt($(d).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)}).html(t.post.bookmarks).attr("data-bookmarks",t.post.bookmarks)}function I(t){ajaxify.data.category&&ajaxify.data.category.slug&&parseInt(t.tid,10)===parseInt(ajaxify.data.tid,10)&&ajaxify.go("category/"+ajaxify.data.category.slug,null,!0)}function A(t){t&&t.slug&&parseInt(t.tid,10)===parseInt(ajaxify.data.tid,10)&&ajaxify.go("topic/"+t.slug,null,!0)}function U(t){if(!t||!t.post||parseInt(t.post.tid,10)!==parseInt(ajaxify.data.tid,10))return;const a=u.get("post/content",t.post.pid).filter(function(s,r){return parseInt($(r).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)}),d=$('[data-pid="'+t.post.pid+'"] [component="post/editor"]').filter(function(s,r){return parseInt($(r).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)}),o=u.get("topic/title"),e=u.get("navbar/title").find("span"),n=u.get("breadcrumb/current");if(t.topic.rescheduled)return ajaxify.go("topic/"+t.topic.slug,null,!0);if(o.length&&t.topic.title&&t.topic.renamed){ajaxify.data.title=t.topic.title;const s="topic/"+t.topic.slug+(window.location.search?window.location.search:"");history.replaceState({url:s},null,window.location.protocol+"//"+window.location.host+config.relative_path+"/"+s),o.fadeOut(250,function(){o.html(t.topic.title).fadeIn(250)}),n.fadeOut(250,function(){n.html(t.topic.title).fadeIn(250)}),e.fadeOut(250,function(){e.html(t.topic.title).fadeIn(250)})}t.post.changed?a.fadeOut(250,function(){a.html(p.unescape(t.post.content)),a.find("img:not(.not-responsive)").addClass("img-responsive"),x.wrapImagesInLinks(a.parent()),v.addBlockquoteEllipses(a.parent()),a.fadeIn(250);const s={editor:t.editor,editedISO:utils.toISOString(t.post.edited)};app.parseAndTranslate("partials/topic/post-editor",s,function(r){d.replaceWith(r),$('[data-pid="'+t.post.pid+'"] [component="post/editor"] .timeago').timeago(),m.fire("action:posts.edited",t)})}):m.fire("action:posts.edited",t),t.topic.tags&&t.topic.tagsupdated&&T.render("partials/topic/tags",{tags:t.topic.tags}).then(function(s){const r=$(".tags");r.fadeOut(250,function(){r.html(s).fadeIn(250)})}),j.removeMenu(u.get("post","pid",t.post.pid))}function L(t){!t||parseInt(t.tid,10)!==parseInt(ajaxify.data.tid,10)||(u.get("post","pid",t.pid).fadeOut(500,function(){$(this).remove(),v.showBottomPostBar()}),ajaxify.data.postcount-=1,j.updatePostCount(ajaxify.data.postcount),i.e(1352).then(function(){var a=[i(21352)];(function(d){d.onPostPurged(t)}).apply(null,a)}).catch(i.oe))}function b(t){const a=u.get("post","pid",t.pid);if(!a.length)return;a.toggleClass("deleted");const d=a.hasClass("deleted");j.toggle(t.pid,d),!ajaxify.data.privileges.isAdminOrMod&&parseInt(t.uid,10)!==parseInt(app.user.uid,10)&&(a.find('[component="post/tools"]').toggleClass("hidden",d),d?a.find('[component="post/content"]').translateHtml("[[topic:post_is_deleted]]"):a.find('[component="post/content"]').html(p.unescape(t.content)))}function B(t){const a=$('[data-pid="'+t.post.pid+'"] [component="post/bookmark"]').filter(function(d,o){return parseInt($(o).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)});a.length&&(a.attr("data-bookmarked",t.isBookmarked),a.find('[component="post/bookmark/on"]').toggleClass("hidden",!t.isBookmarked),a.find('[component="post/bookmark/off"]').toggleClass("hidden",t.isBookmarked))}function R(t){const a=$('[data-pid="'+t.post.pid+'"]');a.find('[component="post/upvote"]').filter(function(d,o){return parseInt($(o).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)}).toggleClass("upvoted",t.upvote),a.find('[component="post/downvote"]').filter(function(d,o){return parseInt($(o).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)}).toggleClass("downvoted",t.downvote)}function N(t){const a=ajaxify.data.tid;t&&t.tid&&parseInt(t.tid,10)===parseInt(a,10)&&socket.emit("topics.markTopicNotificationsRead",[a])}return f}.apply(w,k),h!==void 0&&(E.exports=h)},69241:(E,w,i)=>{var k,h;k=[i(7237),i(74344)],h=function(j,y){const v={};return v.handleSort=function(x,u){const p=j.get("thread/sort");p.find("i").removeClass("fa-check"),p.find('a[data-sort="'+config[x]+'"]').find("i").addClass("fa-check"),$("body").off("click",'[component="thread/sort"] a').on("click",'[component="thread/sort"] a',function(){function m(c,C){config[x]=c;const g=decodeURIComponent($.param(C));ajaxify.go(u+(g?"?"+g:""))}const f=$(this).attr("data-sort");if(app.user.uid){const c={settings:{}};c.settings[x]=f,y.put(`/users/${app.user.uid}/settings`,c).then(()=>{m(f,utils.params())})}else{const c=utils.params();c.sort=f,m(f,c)}})},v}.apply(w,k),h!==void 0&&(E.exports=h)}}]);
