"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[7424,9126,3014,999],{9872:(w,E,p)=>{var h,g;h=[p(85233),p(32230),p(86569)],g=function(m,f){const d={_capsState:!1};return d.init=function(){const l=$("#login-error-notify"),e=$("#login"),t=$("#login-form");e.on("click",function(n){if(n.preventDefault(),!$("#username").val()||!$("#password").val())l.find("p").translateText("[[error:invalid-username-or-password]]"),l.show();else{if(l.hide(),e.hasClass("disabled"))return;e.addClass("disabled"),m.fire("action:app.login"),t.ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},beforeSend:function(){app.flags._login=!0},success:function(u){m.fire("action:app.loggedIn",u);const r=utils.urlToLocation(u.next).pathname,a=utils.params({url:u.next});a.loggedin=!0,delete a.register;const C=decodeURIComponent($.param(a));window.location.href=r+"?"+C},error:function(u){let r=u.responseText;const a=u.responseJSON;u.status===403&&u.responseText==="Forbidden"?window.location.href=config.relative_path+"/login?error=csrf-invalid":a&&a.hasOwnProperty("banned_until")&&(r=a.banned_until?f.compile("error:user-banned-reason-until",new Date(a.banned_until).toLocaleString(),a.reason):"[[error:user-banned-reason, "+a.reason+"]]"),l.find("p").translateText(r),l.show(),e.removeClass("disabled"),$("#password:focus").length&&$("#password").select()}})}}),d.capsLockCheck(document.querySelector("#password"),document.querySelector("#caps-lock-warning")),$("#login-error-notify button").on("click",function(n){return n.preventDefault(),l.hide(),!1}),$("#content #username").val()?$("#content #password").val("").focus():$("#content #username").focus(),$("#content #noscript").val("false")},d.capsLockCheck=(l,e)=>{const t=n=>{e.classList[n?"remove":"add"]("hidden"),e.parentNode.classList[n?"add":"remove"]("has-warning")};l&&(l.addEventListener("keyup",function(n){if(d._capsState&&n.key==="CapsLock"){t(!1),d._capsState=!d._capsState;return}d._capsState=n.getModifierState&&n.getModifierState("CapsLock"),t(d._capsState)}),d._capsState&&t(!0))},d}.apply(E,h),g!==void 0&&(w.exports=g)},70935:(w,E,p)=>{var h,g;h=[p(32230),p(22568),p(74344),p(31369),p(9872),p(21322),p(86569)],g=function(m,f,d,l,e,t){const n={};let u=!1;const r="";n.init=function(){const s=$("#username"),i=$("#password"),c=$("#password-confirm"),y=$("#register");T(),$("#content #noscript").val("false");const S=utils.params();S.token&&$("#token").val(S.token),s.on("keyup",function(){$("#yourUsername").text(this.value.length>0?f(this.value):"username")}),s.on("blur",function(){s.val().length&&a(s.val())}),i.on("blur",function(){i.val().length&&C(i.val(),c.val())}),c.on("blur",function(){c.val().length&&o(i.val(),c.val())});function k(D){u=!1,C(i.val(),c.val()),o(i.val(),c.val()),a(s.val(),D)}e.capsLockCheck(document.querySelector("#password"),document.querySelector("#caps-lock-warning")),y.on("click",function(D){const L=$(this),N=$("#register-error-notify");N.addClass("hidden"),D.preventDefault(),k(function(){u||(L.addClass("disabled"),L.parents("form").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},success:function(_){if(L.removeClass("disabled"),!!_)if(_.next){const x=utils.urlToLocation(_.next).pathname,b=utils.params({url:_.next});b.registered=!0;const O=decodeURIComponent($.param(b));window.location.href=x+"?"+O}else _.message&&m.translate(_.message,function(x){l.alert(x),ajaxify.go("/")})},error:function(_){m.translate(_.responseText,config.defaultLang,function(x){_.status===403&&_.responseText==="Forbidden"?window.location.href=config.relative_path+"/register?error=csrf-invalid":(N.find("p").text(x),N.removeClass("hidden"),L.removeClass("disabled"))})}}))})}),$("#username").focus()};function a(s,i){i=i||function(){};const c=$("#username-notify"),y=f(s);s.length<ajaxify.data.minimumUsernameLength||y.length<ajaxify.data.minimumUsernameLength?v(c,"[[error:username-too-short]]"):s.length>ajaxify.data.maximumUsernameLength?v(c,"[[error:username-too-long]]"):!utils.isUserNameValid(s)||!y?v(c,"[[error:invalid-username]]"):Promise.allSettled([d.head(`/users/bySlug/${s}`,{}),d.head(`/groups/${s}`,{})]).then(S=>{S.every(k=>k.status==="rejected")?A(c,r):v(c,"[[error:username-taken]]"),i()})}function C(s,i){const c=$("#password-notify"),y=$("#password-confirm-notify");try{if(utils.assertPasswordValidity(s,t),s===$("#username").val())throw new Error("[[user:password_same_as_username]]");A(c,r)}catch(S){v(c,S.message)}s!==i&&i!==""&&v(y,"[[user:change_password_error_match]]")}function o(s,i){const c=$("#password-notify"),y=$("#password-confirm-notify");!s||c.hasClass("alert-error")||(s!==i?v(y,"[[user:change_password_error_match]]"):A(y,r))}function v(s,i){m.translate(i,function(c){s.html(c),s.parent().removeClass("register-success").addClass("register-danger"),s.show()}),u=!0}function A(s,i){m.translate(i,function(c){s.html(c),s.parent().removeClass("register-danger").addClass("register-success"),s.show()})}function T(){if(!app.user.uid&&config.defaultLang!==config.userLang){const s=$('[component="register/local"]'),i=$('<input type="hidden" name="userLang" value="'+config.userLang+'" />');s.append(i)}}return n}.apply(E,h),g!==void 0&&(w.exports=g)},74344:(w,E,p)=>{var h,g;h=[p(85233)],g=(m=>{const f={},d=config.relative_path+"/api/v3";function l(e,t){e.url=e.url.startsWith("/api")?config.relative_path+e.url:d+e.url;async function n(u){({options:e}=await m.fire("filter:api.options",{options:e})),$.ajax(e).done(r=>{u(null,r&&r.hasOwnProperty("status")&&r.hasOwnProperty("response")?r.response:r||{})}).fail(r=>{let a;r.responseJSON&&(a=r.responseJSON.status&&r.responseJSON.status.message?r.responseJSON.status.message:r.responseJSON.error),u(new Error(a||r.statusText))})}if(typeof t=="function"){n(t);return}return new Promise((u,r)=>{n(function(a,C){a?r(a):u(C)})})}return f.get=(e,t,n)=>l({url:e+(t&&Object.keys(t).length?"?"+$.param(t):"")},n),f.head=(e,t,n)=>l({url:e+(t&&Object.keys(t).length?"?"+$.param(t):""),method:"head"},n),f.post=(e,t,n)=>l({url:e,method:"post",data:JSON.stringify(t||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},n),f.patch=(e,t,n)=>l({url:e,method:"patch",data:JSON.stringify(t||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},n),f.put=(e,t,n)=>l({url:e,method:"put",data:JSON.stringify(t||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},n),f.del=(e,t,n)=>l({url:e,method:"delete",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},n),f.delete=f.del,f}).apply(E,h),g!==void 0&&(w.exports=g)},22568:(w,E,p)=>{var h,g,m;(function(f){g=[p(20648)],h=f,m=typeof h=="function"?h.apply(E,g):h,m!==void 0&&(w.exports=m)})(function(f){const d=f("[^\\p{L}\\s\\d\\-_]","g"),l=/[^\w\s\d\-_]/g,e=/^\s+|\s+$/g,t=/\s+/g,n=/-+/g,u=/-$/g,r=/^-/g,a=/^[\w\d\s.,\-@]+$/;return function(o,v){return o?(o=String(o).replace(e,""),a.test(o)?o=o.replace(l,"-"):o=f.replace(o,d,"-"),o=v?o:o.toLocaleLowerCase(),o=o.replace(t,"-"),o=o.replace(n,"-"),o=o.replace(u,""),o=o.replace(r,""),o):""}})}}]);
