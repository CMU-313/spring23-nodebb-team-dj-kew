"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[792,1352],{21352:(g,v,r)=>{var m,l;m=[r(60447),r(85233),r(7927)],l=function(c,C,y){const p={};p.init=function(e){const o=e.closest("[data-pid]"),s=o.data("pid"),t=e.find('[component="post/replies/open"]'),i=e.find('[component="post/replies/loading"]'),n=e.find('[component="post/replies/close"]');t.is(":not(.hidden)")&&i.is(".hidden")?(t.addClass("hidden"),i.removeClass("hidden"),socket.emit("posts.getReplies",s,function(a,d){if(i.addClass("hidden"),a)return t.removeClass("hidden"),y.error(a);n.removeClass("hidden"),c.modifyPostsByPrivileges(d);const P={posts:d,privileges:ajaxify.data.privileges,"downvote:disabled":ajaxify.data["downvote:disabled"],"reputation:disabled":ajaxify.data["reputation:disabled"],loggedIn:!!app.user.uid,hideReplies:config.hasOwnProperty("showNestedReplies")?!config.showNestedReplies:!0};app.parseAndTranslate("topic","posts",P,function(h){const f=$("<div>",{component:"post/replies"}).html(h).hide();e.attr("data-target-component")?o.find('[component="'+e.attr("data-target-component")+'"]').html(f):f.insertAfter(e),f.slideDown("fast"),c.onNewPostsAddedToDom(h),C.fire("action:posts.loaded",{posts:d})})})):n.is(":not(.hidden)")&&(n.addClass("hidden"),t.removeClass("hidden"),i.addClass("hidden"),o.find('[component="post/replies"]').slideUp("fast",function(){$(this).remove()}))},p.onNewPost=function(e){const o=e.posts[0];o&&(u(o,1),e.hideReplies=config.hasOwnProperty("showNestedReplies")?!config.showNestedReplies:!0,app.parseAndTranslate("topic","posts",e,function(s){const t=$('[component="post"][data-pid="'+o.toPid+'"] [component="post/replies"]').first();t.length&&(config.topicPostSort==="newest_to_oldest"?t.prepend(s):t.append(s),c.onNewPostsAddedToDom(s))}))},p.onPostPurged=function(e){u(e,-1)};function u(e,o){const s=$('[component="post"][data-pid="'+e.toPid+'"]').find('[component="post/reply-count"]').first(),t=s.find('[component="post/reply-count/text"]'),i=s.find('[component="post/reply-count/avatars"]'),n=Math.max(0,parseInt(t.attr("data-replies"),10)+o),a=s.find(".timeago").attr("title",e.timestampISO);t.attr("data-replies",n),s.toggleClass("hidden",n<=0),n>1?t.translateText("[[topic:replies_to_this_post, "+n+"]]"):t.translateText("[[topic:one_reply_to_this_post]]"),!i.find('[data-uid="'+e.uid+'"]').length&&n<7&&app.parseAndTranslate("topic","posts",{posts:[{replies:{users:[e.user]}}]},function(d){i.prepend(d.find('[component="post/reply-count/avatars"] [component="avatar/picture"]'))}),i.addClass("hasMore"),a.data("timeago",null).timeago()}return p}.apply(v,m),l!==void 0&&(g.exports=l)}}]);
