"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[4222,7214,9617,6503,6721,3014,8253,8786,5655,8306,831,6193,7073],{68118:(y,v,g)=>{var m,d;m=[g(7073),g(86193),g(66603),g(85233),g(7927)],d=function(o,l,a,p,u){const h={};h.init=function(){const r=$("#results").attr("data-search-query"),c=$("#search-in");c.on("change",function(){f(c.val())}),o.highlightMatches(r,$(".search-result-text p, .search-result-text.search-result-title a")),$("#advanced-search").off("submit").on("submit",function(s){return s.preventDefault(),o.query(t(),function(){$("#search-input").val("")}),!1}),n(),i(),e()};function t(){const r=$("#advanced-search"),c={in:$("#search-in").val()};return c.term=$("#search-input").val(),(c.in==="posts"||c.in==="titlesposts"||c.in==="titles")&&(c.matchWords=r.find("#match-words-filter").val(),c.by=r.find("#posted-by-user").tagsinput("items"),c.categories=r.find("#posted-in-categories").val(),c.searchChildren=r.find("#search-children").is(":checked"),c.hasTags=r.find("#has-tags").tagsinput("items"),c.replies=r.find("#reply-count").val(),c.repliesFilter=r.find("#reply-count-filter").val(),c.timeFilter=r.find("#post-time-filter").val(),c.timeRange=r.find("#post-time-range").val(),c.sortBy=r.find("#post-sort-by").val(),c.sortDirection=r.find("#post-sort-direction").val(),c.showAs=r.find("#show-as-topics").is(":checked")?"topics":"posts"),p.fire("action:search.getSearchDataFromDOM",{form:r,data:c}),c}function f(r){const c=r.indexOf("posts")===-1&&r.indexOf("titles")===-1;$(".post-search-item").toggleClass("hide",c)}function e(){const r=utils.params({disableToType:!0}),c=o.getSearchPreferences(),s=utils.merge(c,r);if(s){if(ajaxify.data.term&&$("#search-input").val(ajaxify.data.term),s.in=s.in||ajaxify.data.searchDefaultIn,$("#search-in").val(s.in),f(s.in),s.matchWords&&$("#match-words-filter").val(s.matchWords),s.by&&(s.by=Array.isArray(s.by)?s.by:[s.by],s.by.forEach(function(E){$("#posted-by-user").tagsinput("add",E)})),s.categories&&$("#posted-in-categories").val(s.categories),s.searchChildren&&$("#search-children").prop("checked",!0),s.hasTags&&(s.hasTags=Array.isArray(s.hasTags)?s.hasTags:[s.hasTags],s.hasTags.forEach(function(E){$("#has-tags").tagsinput("add",E)})),s.replies&&($("#reply-count").val(s.replies),$("#reply-count-filter").val(s.repliesFilter)),s.timeRange&&($("#post-time-range").val(s.timeRange),$("#post-time-filter").val(s.timeFilter)),(s.sortBy||ajaxify.data.searchDefaultSortBy)&&$("#post-sort-by").val(s.sortBy||ajaxify.data.searchDefaultSortBy),$("#post-sort-direction").val(s.sortDirection||"desc"),s.showAs){const E=s.showAs==="topics",b=s.showAs==="posts";$("#show-as-topics").prop("checked",E).parent().toggleClass("active",E),$("#show-as-posts").prop("checked",b).parent().toggleClass("active",b)}p.fire("action:search.fillOutForm",{form:s})}}function n(){$("#save-preferences").on("click",function(){return a.setItem("search-preferences",JSON.stringify(t())),u.success("[[search:search-preferences-saved]]"),!1}),$("#clear-preferences").on("click",function(){a.removeItem("search-preferences");const r=$("#search-input").val();return $("#advanced-search")[0].reset(),$("#search-input").val(r),u.success("[[search:search-preferences-cleared]]"),!1})}function i(){const r=$("#posted-by-user");r.tagsinput({confirmKeys:[13,44],trimValue:!0}),app.user.privileges["search:users"]&&l.user(r.siblings(".bootstrap-tagsinput").find("input"));const c=$("#has-tags");c.tagsinput({confirmKeys:[13,44],trimValue:!0}),app.user.privileges["search:tags"]&&l.tag(c.siblings(".bootstrap-tagsinput").find("input"))}return h}.apply(v,m),d!==void 0&&(y.exports=d)},7927:(y,v,g)=>{var m,d;m=[g(32230),g(7237),g(85233)],d=function(o,l,a){const p={};p.alert=function(e){e.alert_id="alert_button_"+(e.alert_id?e.alert_id:new Date().getTime()),e.title=e.title&&e.title.trim()||"",e.message=e.message?e.message.trim():"",e.type=e.type||"info";const n=$("#"+e.alert_id);n.length?h(n,e):u(e)},p.success=function(e,n){p.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:e,type:"success",timeout:n||5e3})},p.error=function(e,n){if(e=e&&e.message||e,e==="[[error:revalidate-failure]]"){socket.disconnect(),app.reconnect();return}p.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:e,type:"danger",timeout:n||1e4})},p.remove=function(e){$("#alert_button_"+e).remove()};function u(e){app.parseAndTranslate("alert",e,function(n){let i=$("#"+e.alert_id);if(i.length)return h(i,e);i=n,i.fadeIn(200),l.get("toaster/tray").prepend(i),typeof e.closefn=="function"&&i.find("button").on("click",function(){return e.closefn(),t(i),!1}),e.timeout&&f(i,e),typeof e.clickfn=="function"&&i.addClass("pointer").on("click",function(r){$(r.target).is(".close")||e.clickfn(i,e),t(i)}),a.fire("action:alert.new",{alert:i,params:e})})}function h(e,n){e.find("strong").translateHtml(n.title),e.find("p").translateHtml(n.message),e.attr("class","alert alert-dismissable alert-"+n.type+" clearfix"),clearTimeout(parseInt(e.attr("timeoutId"),10)),n.timeout&&f(e,n),a.fire("action:alert.update",{alert:e,params:n}),e.off("click").removeClass("pointer"),typeof n.clickfn=="function"&&e.addClass("pointer").on("click",function(i){$(i.target).is(".close")||n.clickfn(),t(e)})}function t(e){e.fadeOut(500,function(){$(this).remove()})}function f(e,n){const i=n.timeout,r=setTimeout(function(){t(e),typeof n.timeoutfn=="function"&&n.timeoutfn(e,n)},i);e.attr("timeoutId",r),e.css("transition-property","none"),e.removeClass("animate"),setTimeout(function(){e.css("transition-property",""),e.css("transition","width "+(i+450)+"ms linear, background-color "+(i+450)+"ms ease-in"),e.addClass("animate"),a.fire("action:alert.animate",{alert:e,params:n})},50),e.on("mouseenter",function(){$(this).css("transition-duration",0)})}return p}.apply(v,m),d!==void 0&&(y.exports=d)},74344:(y,v,g)=>{var m,d;m=[g(85233)],d=(o=>{const l={},a=config.relative_path+"/api/v3";function p(u,h){u.url=u.url.startsWith("/api")?config.relative_path+u.url:a+u.url;async function t(f){({options:u}=await o.fire("filter:api.options",{options:u})),$.ajax(u).done(e=>{f(null,e&&e.hasOwnProperty("status")&&e.hasOwnProperty("response")?e.response:e||{})}).fail(e=>{let n;e.responseJSON&&(n=e.responseJSON.status&&e.responseJSON.status.message?e.responseJSON.status.message:e.responseJSON.error),f(new Error(n||e.statusText))})}if(typeof h=="function"){t(h);return}return new Promise((f,e)=>{t(function(n,i){n?e(n):f(i)})})}return l.get=(u,h,t)=>p({url:u+(h&&Object.keys(h).length?"?"+$.param(h):"")},t),l.head=(u,h,t)=>p({url:u+(h&&Object.keys(h).length?"?"+$.param(h):""),method:"head"},t),l.post=(u,h,t)=>p({url:u,method:"post",data:JSON.stringify(h||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},t),l.patch=(u,h,t)=>p({url:u,method:"patch",data:JSON.stringify(h||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},t),l.put=(u,h,t)=>p({url:u,method:"put",data:JSON.stringify(h||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},t),l.del=(u,h,t)=>p({url:u,method:"delete",data:JSON.stringify(h),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},t),l.delete=l.del,l}).apply(v,m),d!==void 0&&(y.exports=d)},86193:(y,v,g)=>{var m,d;m=[g(74344),g(7927)],d=function(o,l){const a={},p={delay:200};a.init=h=>{const{input:t,source:f,onSelect:e,delay:n}={...p,...h};app.loadJQueryUI(function(){t.autocomplete({delay:n,open:function(){$(this).autocomplete("widget").css("z-index",100005)},select:function(i,r){u(t,e,i,r)},source:f})})},a.user=function(h,t,f){typeof t=="function"&&(f=t,t={}),t=t||{},a.init({input:h,onSelect:f,source:(e,n)=>{t.query=e.term,o.get("/api/users",t,function(i,r){if(i)return l.error(i);if(r&&r.users){const c=r.users.map(function(s){const E=$("<div></div>").html(s.username).text();return s&&{label:E,value:E,user:{uid:s.uid,name:s.username,slug:s.userslug,username:s.username,userslug:s.userslug,picture:s.picture,banned:s.banned,"icon:text":s["icon:text"],"icon:bgColor":s["icon:bgColor"]}}});n(c)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},a.group=function(h,t){a.init({input:h,onSelect:t,source:(f,e)=>{socket.emit("groups.search",{query:f.term},function(n,i){if(n)return l.error(n);if(i&&i.length){const r=i.map(function(c){return c&&{label:c.name,value:c.name,group:c}});e(r)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},a.tag=function(h,t){a.init({input:h,onSelect:t,delay:100,source:(f,e)=>{socket.emit("topics.autocompleteTags",{query:f.term,cid:ajaxify.data.cid||0},function(n,i){if(n)return l.error(n);i&&e(i),$(".ui-autocomplete a").attr("data-ajaxify","false")})}})};function u(h,t,f,e){t=t||function(){};const n=jQuery.Event("keypress");n.which=13,n.keyCode=13,setTimeout(function(){h.trigger(n)},100),t(f,e)}return a}.apply(v,m),d!==void 0&&(y.exports=d)},7237:(y,v,g)=>{var m;m=function(){const d={};return d.core={"topic/teaser":function(o){return o?$('[component="category/topic"][data-tid="'+o+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(o,l){return $('[component="topic"][data-'+o+'="'+l+'"]')},post:function(o,l){return $('[component="post"][data-'+o+'="'+l+'"]')},"post/content":function(o){return $('[component="post"][data-pid="'+o+'"] [component="post/content"]')},"post/header":function(o){return $('[component="post"][data-pid="'+o+'"] [component="post/header"]')},"post/anchor":function(o){return $('[component="post"][data-index="'+o+'"] [component="post/anchor"]')},"post/vote-count":function(o){return $('[component="post"][data-pid="'+o+'"] [component="post/vote-count"]')},"post/bookmark-count":function(o){return $('[component="post"][data-pid="'+o+'"] [component="post/bookmark-count"]')},"user/postcount":function(o){return $('[component="user/postcount"][data-uid="'+o+'"]')},"user/reputation":function(o){return $('[component="user/reputation"][data-uid="'+o+'"]')},"category/topic":function(o,l){return $('[component="category/topic"][data-'+o+'="'+l+'"]')},"categories/category":function(o,l){return $('[component="categories/category"][data-'+o+'="'+l+'"]')},"chat/message":function(o){return $('[component="chat/message"][data-mid="'+o+'"]')},"chat/message/body":function(o){return $('[component="chat/message"][data-mid="'+o+'"] [component="chat/message/body"]')},"chat/recent/room":function(o){return $('[component="chat/recent/room"][data-roomid="'+o+'"]')}},d.get=function(){const o=Array.prototype.slice.call(arguments,1);return d.core[arguments[0]]&&o.length?d.core[arguments[0]].apply(this,o):$('[component="'+arguments[0]+'"]')},d}.call(v,g,v,y),m!==void 0&&(y.exports=m)},7073:(y,v,g)=>{var m,d;m=[g(32230),g(66603),g(85233),g(7927)],d=function(o,l,a,p){const u={current:{}};u.init=function(t){if(!config.searchEnabled)return;t=t||{in:config.searchDefaultInQuick||"titles"};const f=$("#search-button"),e=$("#search-fields"),n=$("#search-fields input"),i=$("#quick-search-container");$("#search-form .advanced-search-link").off("mousedown").on("mousedown",function(){ajaxify.go("/search")}),$("#search-form").off("submit").on("submit",function(){n.blur()}),n.off("blur").on("blur",function(){setTimeout(function(){n.is(":focus")||(e.addClass("hidden"),f.removeClass("hidden"))},200)}),n.off("focus");const r={inputEl:n,resultEl:i};u.enableQuickSearch({searchOptions:t,searchElements:r}),f.off("click").on("click",function(c){return!config.loggedIn&&!app.user.privileges["search:content"]?(p.alert({message:"[[error:search-requires-login]]",timeout:3e3}),ajaxify.go("login"),!1):(c.stopPropagation(),u.showAndFocusInput(),!1)}),$("#search-form").off("submit").on("submit",function(){const c=$(this).find("input"),s=u.getSearchPreferences();return s.term=c.val(),s.in=t.in,a.fire("action:search.submit",{searchOptions:s,searchElements:r}),u.query(s,function(){c.val("")}),!1})},u.enableQuickSearch=function(t){if(!config.searchEnabled||!app.user.privileges["search:content"])return;const f=Object.assign({in:config.searchDefaultInQuick||"titles"},t.searchOptions),e=t.searchElements.resultEl,n=t.searchElements.inputEl;let i=n.val();const r=e.find(".filter-category");function c(){ajaxify.data.template.category&&ajaxify.data.cid&&o.translate("[[search:search-in-category, "+ajaxify.data.name+"]]",function(_){const x=$("<div></div>").html(_).text();r.find(".name").text(x)}),r.toggleClass("hidden",!(ajaxify.data.template.category&&ajaxify.data.cid))}function s(){t.searchOptions=Object.assign({},f),t.searchOptions.term=n.val(),c(),ajaxify.data.template.category&&ajaxify.data.cid&&r.find('input[type="checkbox"]').is(":checked")&&(t.searchOptions.categories=[ajaxify.data.cid],t.searchOptions.searchChildren=!0),e.removeClass("hidden").find(".quick-search-results-container").html(""),e.find(".loading-indicator").removeClass("hidden"),a.fire("action:search.quick.start",t),t.searchOptions.searchOnly=1,u.api(t.searchOptions,function(_){if(e.find(".loading-indicator").addClass("hidden"),!_.posts||t.hideOnNoMatches&&!_.posts.length)return e.addClass("hidden").find(".quick-search-results-container").html("");_.posts.forEach(function(x){const C=$("<div>"+x.content+"</div>").text(),S=n.val().toLowerCase().replace(/^in:topic-\d+/,""),A=Math.max(0,C.toLowerCase().indexOf(S)-40);x.snippet=utils.escapeHTML((A>0?"...":"")+C.slice(A,A+80)+(C.length-A>80?"...":""))}),app.parseAndTranslate("partials/quick-search-results",_,function(x){x.length&&x.find(".timeago").timeago(),e.toggleClass("hidden",!x.length||!n.is(":focus")).find(".quick-search-results-container").html(x.length?x:"");const C=e.find(".quick-search-results .quick-search-title, .quick-search-results .snippet");u.highlightMatches(t.searchOptions.term,C),a.fire("action:search.quick.complete",{data:_,options:t})})})}e.find('.filter-category input[type="checkbox"]').on("change",function(){n.focus(),s()}),n.off("keyup").on("keyup",utils.debounce(function(){if(n.val().length<3){e.addClass("hidden"),i=n.val();return}if(n.val()!==i){if(i=n.val(),!n.is(":focus"))return e.addClass("hidden");s()}},500));let E=!1;e.on("mousedown",function(){$(window).one("mouseup",function(){e.addClass("hidden")}),E=!0}),n.on("blur",function(){!n.is(":focus")&&!E&&!e.hasClass("hidden")&&e.addClass("hidden")});let b=!1;a.on("action:ajaxify.end",function(){ajaxify.isCold()||(b=!0)}),n.on("focus",function(){E=!1;const _=n.val();i=_,_&&e.find("#quick-search-results").children().length&&(c(),b?(s(),b=!1):e.removeClass("hidden"),n[0].setSelectionRange(_.startsWith("in:topic")?_.indexOf(" ")+1:0,_.length))}),n.off("refresh").on("refresh",function(){s()})},u.showAndFocusInput=function(){$("#search-fields").removeClass("hidden"),$("#search-button").addClass("hidden"),$("#search-fields input").focus()},u.query=function(t,f){f=f||function(){},ajaxify.go("search?"+h(t)),f()},u.api=function(t,f){const e=config.relative_path+"/api/search?"+h(t);t.searchOnly=void 0;const n=config.relative_path+"/search?"+h(t);$.get(e,function(i){i.url=n,f(i)})};function h(t){const f=t.in||"titles",e=t.by||"";let n=t.term.replace(/^[ ?#]*/,"");try{n=encodeURIComponent(n)}catch{return p.error("[[error:invalid-search-term]]")}const i={term:n,in:f};return t.matchWords&&(i.matchWords=t.matchWords),e&&e.length&&(f==="posts"||f==="titles"||f==="titlesposts")&&(i.by=e),t.categories&&t.categories.length&&(i.categories=t.categories,t.searchChildren&&(i.searchChildren=t.searchChildren)),t.hasTags&&t.hasTags.length&&(i.hasTags=t.hasTags),parseInt(t.replies,10)>0&&(i.replies=t.replies,i.repliesFilter=t.repliesFilter||"atleast"),t.timeRange&&(i.timeRange=t.timeRange,i.timeFilter=t.timeFilter||"newer"),t.sortBy&&(i.sortBy=t.sortBy,i.sortDirection=t.sortDirection),t.showAs&&(i.showAs=t.showAs),t.searchOnly&&(i.searchOnly=t.searchOnly),a.fire("action:search.createQueryString",{query:i,data:t}),decodeURIComponent($.param(i))}return u.getSearchPreferences=function(){try{return JSON.parse(l.getItem("search-preferences")||"{}")}catch{return{}}},u.highlightMatches=function(t,f){if(!t||!f.length)return;t=utils.escapeHTML(t.replace(/^"/,"").replace(/"$/,"").trim());const e=t.split(" ").map(function(i){return utils.escapeRegexChars(i)}).join("|"),n=new RegExp("("+e+")","gi");f.each(function(){const i=$(this),r=[];i.find("*").each(function(){$(this).after("<!-- "+r.length+" -->"),r.push($("<div></div>").append($(this)))}),i.html(i.html().replace(n,function(c,s){return'<strong class="search-match">'+s+"</strong>"})),r.forEach(function(c,s){i.html(i.html().replace("<!-- "+s+" -->",function(){return c.html()}))})}),$(".search-result-text").find("img:not(.not-responsive)").addClass("img-responsive")},u}.apply(v,m),d!==void 0&&(y.exports=d)},66603:(y,v,g)=>{var m;m=function(){function d(){this._store={},this._keys=[]}d.prototype.isMock=!0,d.prototype.setItem=function(a,p){a=String(a),this._keys.indexOf(a)===-1&&this._keys.push(a),this._store[a]=p},d.prototype.getItem=function(a){return a=String(a),this._keys.indexOf(a)===-1?null:this._store[a]},d.prototype.removeItem=function(a){a=String(a),this._keys=this._keys.filter(function(p){return p!==a}),this._store[a]=null},d.prototype.clear=function(){this._keys=[],this._store={}},d.prototype.key=function(a){return a=parseInt(a,10)||0,this._keys[a]},Object.defineProperty&&Object.defineProperty(d.prototype,"length",{get:function(){return this._keys.length}});let o;const l=Date.now().toString();try{if(o=window.localStorage,o.setItem(l,l),o.getItem(l)!==l)throw Error("localStorage behaved unexpectedly");return o.removeItem(l),o}catch(a){console.warn(a),console.warn("localStorage failed, falling back on sessionStorage");try{if(o=window.sessionStorage,o.setItem(l,l),o.getItem(l)!==l)throw Error("sessionStorage behaved unexpectedly");return o.removeItem(l),o}catch(p){return console.warn(p),console.warn("sessionStorage failed, falling back on memory storage"),new d}}}.call(v,g,v,y),m!==void 0&&(y.exports=m)}}]);
