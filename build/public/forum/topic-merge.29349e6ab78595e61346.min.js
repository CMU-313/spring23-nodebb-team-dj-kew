"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[5962,7214,9617,6503,6721,3014,8786,5655,8306,831,28,7073],{90028:(E,k,g)=>{var p,u;p=[g(7073),g(7927),g(74344)],u=function(r,s,c){const l={};let i,a,t={};l.init=function(f){f=f||function(){},!i&&app.parseAndTranslate("partials/merge_topics_modal",{},function(h){i=h,$("body").append(i),a=i.find("#merge_topics_confirm"),i.find(".close,#merge_topics_cancel").on("click",m),$("#content").on("click",'[component="topic/select"]',d),n(),a.on("click",function(){e(a)}),r.enableQuickSearch({searchElements:{inputEl:i.find(".topic-search-input"),resultEl:i.find(".quick-search-container")},searchOptions:{in:"titles"}}),i.on("click","[data-tid]",function(){return $(this).attr("data-tid")&&l.addTopic($(this).attr("data-tid")),!1}),f()})},l.addTopic=function(f,h){h=h||function(){},c.get(`/topics/${f}`,{}).then(function(y){const v=y?y.title:"No title";t[f]?delete t[f]:t[f]=v,o(),n(),h()}).catch(s.error)};function d(f){if(!i)return;const h=$(this).parents('[component="category/topic"]').attr("data-tid");return l.addTopic(h),f.preventDefault(),f.stopPropagation(),!1}function e(f){f.attr("disabled",!0);const h=Object.keys(t),y={};i.find(".merge-main-topic-radio").is(":checked")?y.mainTid=i.find(".merge-main-topic-select").val():i.find(".merge-new-title-radio").is(":checked")&&(y.newTopicTitle=i.find(".merge-new-title-input").val()),socket.emit("topics.merge",{tids:h,options:y},function(v,_){if(f.removeAttr("disabled"),v)return s.error(v);ajaxify.go("/topic/"+_),m()})}function n(){if(!i)return;const f=Object.keys(t);f.sort(function(y,v){return y-v});const h=f.map(function(y){return{tid:y,title:t[y]}});f.length?app.parseAndTranslate("partials/merge_topics_modal",{config,topics:h},function(y){i.find(".topics-section").html(y.find(".topics-section").html()),i.find(".merge-main-topic-select").html(y.find(".merge-main-topic-select").html())}):i.find(".topics-section").translateHtml("[[error:no-topics-selected]]")}function o(){Object.keys(t).length?a.removeAttr("disabled"):a.attr("disabled",!0)}function m(){i&&(i.remove(),i=null),t={},$("#content").off("click",'[component="topic/select"]',d)}return l}.apply(k,p),u!==void 0&&(E.exports=u)},7927:(E,k,g)=>{var p,u;p=[g(32230),g(7237),g(85233)],u=function(r,s,c){const l={};l.alert=function(e){e.alert_id="alert_button_"+(e.alert_id?e.alert_id:new Date().getTime()),e.title=e.title&&e.title.trim()||"",e.message=e.message?e.message.trim():"",e.type=e.type||"info";const n=$("#"+e.alert_id);n.length?a(n,e):i(e)},l.success=function(e,n){l.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:e,type:"success",timeout:n||5e3})},l.error=function(e,n){if(e=e&&e.message||e,e==="[[error:revalidate-failure]]"){socket.disconnect(),app.reconnect();return}l.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:e,type:"danger",timeout:n||1e4})},l.remove=function(e){$("#alert_button_"+e).remove()};function i(e){app.parseAndTranslate("alert",e,function(n){let o=$("#"+e.alert_id);if(o.length)return a(o,e);o=n,o.fadeIn(200),s.get("toaster/tray").prepend(o),typeof e.closefn=="function"&&o.find("button").on("click",function(){return e.closefn(),t(o),!1}),e.timeout&&d(o,e),typeof e.clickfn=="function"&&o.addClass("pointer").on("click",function(m){$(m.target).is(".close")||e.clickfn(o,e),t(o)}),c.fire("action:alert.new",{alert:o,params:e})})}function a(e,n){e.find("strong").translateHtml(n.title),e.find("p").translateHtml(n.message),e.attr("class","alert alert-dismissable alert-"+n.type+" clearfix"),clearTimeout(parseInt(e.attr("timeoutId"),10)),n.timeout&&d(e,n),c.fire("action:alert.update",{alert:e,params:n}),e.off("click").removeClass("pointer"),typeof n.clickfn=="function"&&e.addClass("pointer").on("click",function(o){$(o.target).is(".close")||n.clickfn(),t(e)})}function t(e){e.fadeOut(500,function(){$(this).remove()})}function d(e,n){const o=n.timeout,m=setTimeout(function(){t(e),typeof n.timeoutfn=="function"&&n.timeoutfn(e,n)},o);e.attr("timeoutId",m),e.css("transition-property","none"),e.removeClass("animate"),setTimeout(function(){e.css("transition-property",""),e.css("transition","width "+(o+450)+"ms linear, background-color "+(o+450)+"ms ease-in"),e.addClass("animate"),c.fire("action:alert.animate",{alert:e,params:n})},50),e.on("mouseenter",function(){$(this).css("transition-duration",0)})}return l}.apply(k,p),u!==void 0&&(E.exports=u)},74344:(E,k,g)=>{var p,u;p=[g(85233)],u=(r=>{const s={},c=config.relative_path+"/api/v3";function l(i,a){i.url=i.url.startsWith("/api")?config.relative_path+i.url:c+i.url;async function t(d){({options:i}=await r.fire("filter:api.options",{options:i})),$.ajax(i).done(e=>{d(null,e&&e.hasOwnProperty("status")&&e.hasOwnProperty("response")?e.response:e||{})}).fail(e=>{let n;e.responseJSON&&(n=e.responseJSON.status&&e.responseJSON.status.message?e.responseJSON.status.message:e.responseJSON.error),d(new Error(n||e.statusText))})}if(typeof a=="function"){t(a);return}return new Promise((d,e)=>{t(function(n,o){n?e(n):d(o)})})}return s.get=(i,a,t)=>l({url:i+(a&&Object.keys(a).length?"?"+$.param(a):"")},t),s.head=(i,a,t)=>l({url:i+(a&&Object.keys(a).length?"?"+$.param(a):""),method:"head"},t),s.post=(i,a,t)=>l({url:i,method:"post",data:JSON.stringify(a||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},t),s.patch=(i,a,t)=>l({url:i,method:"patch",data:JSON.stringify(a||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},t),s.put=(i,a,t)=>l({url:i,method:"put",data:JSON.stringify(a||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},t),s.del=(i,a,t)=>l({url:i,method:"delete",data:JSON.stringify(a),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},t),s.delete=s.del,s}).apply(k,p),u!==void 0&&(E.exports=u)},7237:(E,k,g)=>{var p;p=function(){const u={};return u.core={"topic/teaser":function(r){return r?$('[component="category/topic"][data-tid="'+r+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(r,s){return $('[component="topic"][data-'+r+'="'+s+'"]')},post:function(r,s){return $('[component="post"][data-'+r+'="'+s+'"]')},"post/content":function(r){return $('[component="post"][data-pid="'+r+'"] [component="post/content"]')},"post/header":function(r){return $('[component="post"][data-pid="'+r+'"] [component="post/header"]')},"post/anchor":function(r){return $('[component="post"][data-index="'+r+'"] [component="post/anchor"]')},"post/vote-count":function(r){return $('[component="post"][data-pid="'+r+'"] [component="post/vote-count"]')},"post/bookmark-count":function(r){return $('[component="post"][data-pid="'+r+'"] [component="post/bookmark-count"]')},"user/postcount":function(r){return $('[component="user/postcount"][data-uid="'+r+'"]')},"user/reputation":function(r){return $('[component="user/reputation"][data-uid="'+r+'"]')},"category/topic":function(r,s){return $('[component="category/topic"][data-'+r+'="'+s+'"]')},"categories/category":function(r,s){return $('[component="categories/category"][data-'+r+'="'+s+'"]')},"chat/message":function(r){return $('[component="chat/message"][data-mid="'+r+'"]')},"chat/message/body":function(r){return $('[component="chat/message"][data-mid="'+r+'"] [component="chat/message/body"]')},"chat/recent/room":function(r){return $('[component="chat/recent/room"][data-roomid="'+r+'"]')}},u.get=function(){const r=Array.prototype.slice.call(arguments,1);return u.core[arguments[0]]&&r.length?u.core[arguments[0]].apply(this,r):$('[component="'+arguments[0]+'"]')},u}.call(k,g,k,E),p!==void 0&&(E.exports=p)},7073:(E,k,g)=>{var p,u;p=[g(32230),g(66603),g(85233),g(7927)],u=function(r,s,c,l){const i={current:{}};i.init=function(t){if(!config.searchEnabled)return;t=t||{in:config.searchDefaultInQuick||"titles"};const d=$("#search-button"),e=$("#search-fields"),n=$("#search-fields input"),o=$("#quick-search-container");$("#search-form .advanced-search-link").off("mousedown").on("mousedown",function(){ajaxify.go("/search")}),$("#search-form").off("submit").on("submit",function(){n.blur()}),n.off("blur").on("blur",function(){setTimeout(function(){n.is(":focus")||(e.addClass("hidden"),d.removeClass("hidden"))},200)}),n.off("focus");const m={inputEl:n,resultEl:o};i.enableQuickSearch({searchOptions:t,searchElements:m}),d.off("click").on("click",function(f){return!config.loggedIn&&!app.user.privileges["search:content"]?(l.alert({message:"[[error:search-requires-login]]",timeout:3e3}),ajaxify.go("login"),!1):(f.stopPropagation(),i.showAndFocusInput(),!1)}),$("#search-form").off("submit").on("submit",function(){const f=$(this).find("input"),h=i.getSearchPreferences();return h.term=f.val(),h.in=t.in,c.fire("action:search.submit",{searchOptions:h,searchElements:m}),i.query(h,function(){f.val("")}),!1})},i.enableQuickSearch=function(t){if(!config.searchEnabled||!app.user.privileges["search:content"])return;const d=Object.assign({in:config.searchDefaultInQuick||"titles"},t.searchOptions),e=t.searchElements.resultEl,n=t.searchElements.inputEl;let o=n.val();const m=e.find(".filter-category");function f(){ajaxify.data.template.category&&ajaxify.data.cid&&r.translate("[[search:search-in-category, "+ajaxify.data.name+"]]",function(_){const C=$("<div></div>").html(_).text();m.find(".name").text(C)}),m.toggleClass("hidden",!(ajaxify.data.template.category&&ajaxify.data.cid))}function h(){t.searchOptions=Object.assign({},d),t.searchOptions.term=n.val(),f(),ajaxify.data.template.category&&ajaxify.data.cid&&m.find('input[type="checkbox"]').is(":checked")&&(t.searchOptions.categories=[ajaxify.data.cid],t.searchOptions.searchChildren=!0),e.removeClass("hidden").find(".quick-search-results-container").html(""),e.find(".loading-indicator").removeClass("hidden"),c.fire("action:search.quick.start",t),t.searchOptions.searchOnly=1,i.api(t.searchOptions,function(_){if(e.find(".loading-indicator").addClass("hidden"),!_.posts||t.hideOnNoMatches&&!_.posts.length)return e.addClass("hidden").find(".quick-search-results-container").html("");_.posts.forEach(function(C){const x=$("<div>"+C.content+"</div>").text(),S=n.val().toLowerCase().replace(/^in:topic-\d+/,""),O=Math.max(0,x.toLowerCase().indexOf(S)-40);C.snippet=utils.escapeHTML((O>0?"...":"")+x.slice(O,O+80)+(x.length-O>80?"...":""))}),app.parseAndTranslate("partials/quick-search-results",_,function(C){C.length&&C.find(".timeago").timeago(),e.toggleClass("hidden",!C.length||!n.is(":focus")).find(".quick-search-results-container").html(C.length?C:"");const x=e.find(".quick-search-results .quick-search-title, .quick-search-results .snippet");i.highlightMatches(t.searchOptions.term,x),c.fire("action:search.quick.complete",{data:_,options:t})})})}e.find('.filter-category input[type="checkbox"]').on("change",function(){n.focus(),h()}),n.off("keyup").on("keyup",utils.debounce(function(){if(n.val().length<3){e.addClass("hidden"),o=n.val();return}if(n.val()!==o){if(o=n.val(),!n.is(":focus"))return e.addClass("hidden");h()}},500));let y=!1;e.on("mousedown",function(){$(window).one("mouseup",function(){e.addClass("hidden")}),y=!0}),n.on("blur",function(){!n.is(":focus")&&!y&&!e.hasClass("hidden")&&e.addClass("hidden")});let v=!1;c.on("action:ajaxify.end",function(){ajaxify.isCold()||(v=!0)}),n.on("focus",function(){y=!1;const _=n.val();o=_,_&&e.find("#quick-search-results").children().length&&(f(),v?(h(),v=!1):e.removeClass("hidden"),n[0].setSelectionRange(_.startsWith("in:topic")?_.indexOf(" ")+1:0,_.length))}),n.off("refresh").on("refresh",function(){h()})},i.showAndFocusInput=function(){$("#search-fields").removeClass("hidden"),$("#search-button").addClass("hidden"),$("#search-fields input").focus()},i.query=function(t,d){d=d||function(){},ajaxify.go("search?"+a(t)),d()},i.api=function(t,d){const e=config.relative_path+"/api/search?"+a(t);t.searchOnly=void 0;const n=config.relative_path+"/search?"+a(t);$.get(e,function(o){o.url=n,d(o)})};function a(t){const d=t.in||"titles",e=t.by||"";let n=t.term.replace(/^[ ?#]*/,"");try{n=encodeURIComponent(n)}catch{return l.error("[[error:invalid-search-term]]")}const o={term:n,in:d};return t.matchWords&&(o.matchWords=t.matchWords),e&&e.length&&(d==="posts"||d==="titles"||d==="titlesposts")&&(o.by=e),t.categories&&t.categories.length&&(o.categories=t.categories,t.searchChildren&&(o.searchChildren=t.searchChildren)),t.hasTags&&t.hasTags.length&&(o.hasTags=t.hasTags),parseInt(t.replies,10)>0&&(o.replies=t.replies,o.repliesFilter=t.repliesFilter||"atleast"),t.timeRange&&(o.timeRange=t.timeRange,o.timeFilter=t.timeFilter||"newer"),t.sortBy&&(o.sortBy=t.sortBy,o.sortDirection=t.sortDirection),t.showAs&&(o.showAs=t.showAs),t.searchOnly&&(o.searchOnly=t.searchOnly),c.fire("action:search.createQueryString",{query:o,data:t}),decodeURIComponent($.param(o))}return i.getSearchPreferences=function(){try{return JSON.parse(s.getItem("search-preferences")||"{}")}catch{return{}}},i.highlightMatches=function(t,d){if(!t||!d.length)return;t=utils.escapeHTML(t.replace(/^"/,"").replace(/"$/,"").trim());const e=t.split(" ").map(function(o){return utils.escapeRegexChars(o)}).join("|"),n=new RegExp("("+e+")","gi");d.each(function(){const o=$(this),m=[];o.find("*").each(function(){$(this).after("<!-- "+m.length+" -->"),m.push($("<div></div>").append($(this)))}),o.html(o.html().replace(n,function(f,h){return'<strong class="search-match">'+h+"</strong>"})),m.forEach(function(f,h){o.html(o.html().replace("<!-- "+h+" -->",function(){return f.html()}))})}),$(".search-result-text").find("img:not(.not-responsive)").addClass("img-responsive")},i}.apply(k,p),u!==void 0&&(E.exports=u)},66603:(E,k,g)=>{var p;p=function(){function u(){this._store={},this._keys=[]}u.prototype.isMock=!0,u.prototype.setItem=function(c,l){c=String(c),this._keys.indexOf(c)===-1&&this._keys.push(c),this._store[c]=l},u.prototype.getItem=function(c){return c=String(c),this._keys.indexOf(c)===-1?null:this._store[c]},u.prototype.removeItem=function(c){c=String(c),this._keys=this._keys.filter(function(l){return l!==c}),this._store[c]=null},u.prototype.clear=function(){this._keys=[],this._store={}},u.prototype.key=function(c){return c=parseInt(c,10)||0,this._keys[c]},Object.defineProperty&&Object.defineProperty(u.prototype,"length",{get:function(){return this._keys.length}});let r;const s=Date.now().toString();try{if(r=window.localStorage,r.setItem(s,s),r.getItem(s)!==s)throw Error("localStorage behaved unexpectedly");return r.removeItem(s),r}catch(c){console.warn(c),console.warn("localStorage failed, falling back on sessionStorage");try{if(r=window.sessionStorage,r.setItem(s,s),r.getItem(s)!==s)throw Error("sessionStorage behaved unexpectedly");return r.removeItem(s),r}catch(l){return console.warn(l),console.warn("sessionStorage failed, falling back on memory storage"),new u}}}.call(k,g,k,E),p!==void 0&&(E.exports=p)}}]);
