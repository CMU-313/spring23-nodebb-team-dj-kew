"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[2586,6922,560,3382],{25142:(N,M,i)=>{var P,d;P=[i(85233),i(7927)],d=function(_,v){const u={};let T,w=0,r=!1,y,I=0;u.init=function(f,b){const p=$("body");typeof f=="function"?(T=f,y=p):(T=b,y=f||p),w=$(window).scrollTop(),$(window).off("scroll",B).on("scroll",B),p.height()<=$(window).height()&&T(1)};function B(){I&&clearTimeout(I),I=setTimeout(function(){I=0,l()},60)}function l(){const f=utils.findBootstrapEnvironment(),b=(f==="xs"||f==="sm")&&$("html").hasClass("composing");if(r||b)return;const p=$(window).scrollTop(),h=$(window).height(),g=y.height()-h,C=y.offset()?y.offset().top:0,S=100*(p-C)/(g<=0?h:g),F=15,R=85,k=p>w?1:-1;(S<F&&p<w||S>R&&p>w||S<0&&k>0&&g<0)&&T(k),w=p}return u.loadMore=function(f,b,p){if(r)return;r=!0;const h={method:f,data:b};_.fire("action:infinitescroll.loadmore",h),socket.emit(h.method,h.data,function(g,C){if(g)return r=!1,v.error(g);p(C,function(){r=!1})})},u.loadMoreXhr=function(f,b){if(r)return;r=!0;const p=config.relative_path+"/api"+location.pathname.replace(new RegExp("^"+config.relative_path),""),h={url:p,data:f};_.fire("action:infinitescroll.loadmore.xhr",h),$.get(p,f,function(g){b(g,function(){r=!1})}).fail(function(g){r=!1,v.error(String(g.responseJSON||g.statusText))})},u.removeExtra=function(f,b,p){let h=$();if(f.length<=p)return h;const g=f.length-p;if(b>0){const C=$(document).height(),S=$(window).scrollTop();h=f.slice(0,g).remove(),$(window).scrollTop(S+($(document).height()-C))}else h=f.slice(f.length-g).remove();return h},u}.apply(M,P),d!==void 0&&(N.exports=d)},47720:(N,M)=>{var i,P;i=[],P=function(){const d={};return d.wrapImagesInLinks=function(_){_.find('[component="post/content"] img:not(.emoji)').each(function(){const v=$(this);let u=v.attr("src")||"";const T=v.attr("alt")||"",w=/-resized(\.[\w]+)?$/;if(u==="about:blank")return;utils.isRelativeUrl(u)&&w.test(u)&&(u=u.replace(w,"$1"));const r=u.split(".").slice(1).pop(),y=T.split("/").pop(),I=y.split(".").slice(1).pop();v.parent().is("a")||v.wrap('<a href="'+u+'" '+(!r&&I?' download="'+y+'" ':"")+' target="_blank" rel="noopener">')})},d}.apply(M,i),P!==void 0&&(N.exports=P)},60447:(N,M,i)=>{var P,d;P=[i(78989),i(25142),i(54939),i(47720),i(42840),i(7237),i(32230),i(85233),i(59265)],d=function(_,v,u,T,w,r,y,I,B){const l={};l.signaturesShown={},l.onNewPost=function(t){!t||!t.posts||!t.posts.length||parseInt(t.posts[0].tid,10)!==parseInt(ajaxify.data.tid,10)||(t.loggedIn=!!app.user.uid,t.privileges=ajaxify.data.privileges,t.posts[0].timestamp=t.posts[0].topic.scheduled?t.posts[0].timestamp:Date.now()-1e3,t.posts[0].timestampISO=utils.toISOString(t.posts[0].timestamp),l.modifyPostsByPrivileges(t.posts),f(t.posts),b(t.posts),ajaxify.data.postcount+=1,u.updatePostCount(ajaxify.data.postcount),config.usePagination?p(t):g(t),i.e(1352).then(function(){var e=[i(21352)];(function(n){n.onNewPost(t)}).apply(null,e)}).catch(i.oe))},l.modifyPostsByPrivileges=function(t){t.forEach(function(e){e.selfPost=!!app.user.uid&&parseInt(e.uid,10)===parseInt(app.user.uid,10),e.topicOwnerPost=parseInt(e.uid,10)===parseInt(ajaxify.data.uid,10),e.display_edit_tools=ajaxify.data.privileges["posts:edit"]&&e.selfPost||ajaxify.data.privileges.isAdminOrMod,e.display_delete_tools=ajaxify.data.privileges["posts:delete"]&&e.selfPost||ajaxify.data.privileges.isAdminOrMod,e.display_moderator_tools=e.display_edit_tools||e.display_delete_tools,e.display_move_tools=ajaxify.data.privileges.isAdminOrMod,e.display_post_menu=ajaxify.data.privileges.isAdminOrMod||e.selfPost&&!ajaxify.data.locked&&!e.deleted||e.selfPost&&e.deleted&&parseInt(e.deleterUid,10)===parseInt(app.user.uid,10)||(app.user.uid||ajaxify.data.postSharing.length)&&!e.deleted})};function f(t){for(let e=0;e<t.length;e+=1){const n=r.get("user/postcount",t[e].uid);n.html(parseInt(n.attr("data-postcount"),10)+1),utils.addCommasToNumbers(n)}}function b(t){config.topicPostSort==="newest_to_oldest"&&(t[0].index=1,r.get("post").not("[data-index=0]").each(function(){const e=parseInt($(this).attr("data-index"),10)+1;$(this).attr("data-index",e)}))}function p(t){function e(){C(t.posts[0])}const n=t.posts;ajaxify.data.pagination.pageCount=Math.max(1,Math.ceil(n[0].topic.postcount/config.postsPerPage));const o=config.topicPostSort==="oldest_to_newest"||config.topicPostSort==="most_votes"?1:-1;if(ajaxify.data.pagination.currentPage===ajaxify.data.pagination.pageCount&&o===1||ajaxify.data.pagination.currentPage===1&&o===-1){const c=$('[component="post"]:not([data-index=0]), [component="topic/event"]');S(t,c,o,!1,e)}else ajaxify.data.scrollToMyPost&&parseInt(n[0].uid,10)===parseInt(app.user.uid,10)?setTimeout(function(){_.loadPage(ajaxify.data.pagination.pageCount,e)},250):h()}function h(){$.get(config.relative_path+"/api/topic/pagination/"+ajaxify.data.tid,{page:ajaxify.data.pagination.currentPage},function(t){app.parseAndTranslate("partials/paginator",t,function(e){$('[component="pagination"]').after(e).remove()})})}function g(t){const e=config.topicPostSort==="oldest_to_newest"||config.topicPostSort==="most_votes"?1:-1,n=$('[component="post"][data-index="'+(t.posts[0].index-1)+'"]').length;if(!n&&(!t.posts[0].selfPost||!ajaxify.data.scrollToMyPost))return;if(!n&&t.posts[0].selfPost)return ajaxify.go("post/"+t.posts[0].pid);const o=$('[component="topic"]>[component="post"]:not([data-index=0]), [component="topic"]>[component="topic/event"]');S(t,o,e,!1,function(s){s&&s.addClass("new"),C(t.posts[0])})}function C(t){t.selfPost&&ajaxify.data.scrollToMyPost&&w.scrollBottom(t.index)}function S(t,e,n,o,s){if(s=s||function(){},!t||t.posts&&!t.posts.length)return s();function c(){const m=$('[component="post"].new');if(m.length===t.posts.length){let E=!0;if(m.each(function(x,D){parseInt($(D).attr("data-pid"),10)!==parseInt(t.posts[x].pid,10)&&(E=!1)}),E){m.each(function(){$(this).removeClass("new")}),t.posts.length=0;return}}m.length&&t.posts.length>1&&t.posts.forEach(function(E){const x=r.get("post","pid",E.pid);x.hasClass("new")&&x.remove()}),t.posts=t.posts.filter(function(E){return E.index===-1||$('[component="post"][data-pid="'+E.pid+'"]').length===0})}if(c(),!t.posts.length)return s();let a,A;n>0&&e.length?a=e.last():n<0&&e.length&&(A=e.first()),I.fire("action:posts.loading",{posts:t.posts,after:a,before:A}),app.parseAndTranslate("topic","posts",Object.assign({},ajaxify.data,t),function(m){if(m=m.filter(function(){const x=$(this),D=x.attr("data-pid"),W=parseInt(x.attr("data-index"),10);return!x.is('[component="post"]')||W===-1||D&&$('[component="post"][data-pid="'+D+'"]').length===0}),a)m.insertAfter(a);else if(A){const x=$(document).height(),D=$(window).scrollTop();m.insertBefore(A),(o||D>0)&&$(window).scrollTop(D+($(document).height()-x))}else r.get("topic").append(m);const E=v.removeExtra($('[component="post"]'),n,Math.max(20,config.postsPerPage*2));k(E),I.fire("action:posts.loaded",{posts:t.posts}),l.onNewPostsAddedToDom(m),s(m)})}l.loadMorePosts=function(t){if(!r.get("topic").length||w.scrollActive)return;const e=r.get("topic").find(r.get("post").not("[data-index=0]").not(".new")),n=t>0?e.last():e.first(),o=parseInt(n.attr("data-index"),10)||0,s=ajaxify.data.tid;if(!utils.isNumber(s)||!utils.isNumber(o)||t<0&&r.get("post","index",0).length)return;const c=$(".loading-indicator");c.is(":animated")||c.fadeIn(),v.loadMore("topics.loadMore",{tid:s,after:o+(t>0?1:0),count:config.postsPerPage,direction:t,topicPostSort:config.topicPostSort},function(a,A){if(c.fadeOut(),a&&a.posts&&a.posts.length){const m=$('[component="post"]:not([data-index=0]):not(.new), [component="topic/event"]');S(a,m,t,!0,A)}else w.update(),A()})},l.onTopicPageLoad=function(t){j(t),T.wrapImagesInLinks(t),R(t),l.showBottomPostBar(),t.find('[component="post/content"] img:not(.not-responsive)').addClass("img-responsive"),l.addBlockquoteEllipses(t),L(t),F()},l.addTopicEvents=function(t){if(config.topicPostSort==="most_votes")return;const e=B.renderEvents.call(ajaxify.data,t);y.translate(e,n=>{if(config.topicPostSort==="oldest_to_newest")$('[component="topic"]').append(n);else if(config.topicPostSort==="newest_to_oldest"){const o=$('[component="topic"] [component="post"][data-index="0"]');o.length?$(n).insertAfter(o):$('[component="topic"]').prepend(n)}$('[component="topic/event"] .timeago').timeago()})};function F(){const t=ajaxify.data.necroThreshold*24*60*60*1e3;if(!t||config.topicPostSort!=="newest_to_oldest"&&config.topicPostSort!=="oldest_to_newest")return;$('[component="post"]').toArray().forEach(function(n){n=$(n);const o=n.prev('[component="post"]');if(n.is(":has(.necro-post)")||!o.length||config.topicPostSort==="newest_to_oldest"&&parseInt(o.attr("data-index"),10)===0)return;const s=n.attr("data-timestamp")-o.attr("data-timestamp");if(Math.abs(s)>=t){const c=$.timeago.settings.strings.suffixAgo,a=$.timeago.settings.strings.prefixAgo,A=$.timeago.settings.strings.suffixFromNow,m=$.timeago.settings.strings.prefixFromNow;$.timeago.settings.strings.suffixAgo="",$.timeago.settings.strings.prefixAgo="",$.timeago.settings.strings.suffixFromNow="",$.timeago.settings.strings.prefixFromNow="";const E=(s>0?"[[topic:timeago_later,":"[[topic:timeago_earlier,")+$.timeago.inWords(s)+"]]";$.timeago.settings.strings.suffixAgo=c,$.timeago.settings.strings.prefixAgo=a,$.timeago.settings.strings.suffixFromNow=A,$.timeago.settings.strings.prefixFromNow=m,app.parseAndTranslate("partials/topic/necro-post",{text:E},function(x){x.attr("data-necro-post-index",o.attr("data-index")),x.insertBefore(n)})}})}function R(t){ajaxify.data["signatures:hideDuplicates"]&&t.each((e,n)=>{const o=$(n).find('[component="post/signature"]'),s=o.attr("data-uid");l.signaturesShown[s]?o.addClass("hidden"):l.signaturesShown[s]=!0})}function k(t){t.each((e,n)=>{$(`[data-necro-post-index="${$(n).attr("data-index")}"]`).remove()})}function j(t){if(app.user.uid||!ajaxify.data.privateUploads)return;const e=document.createElement("a");e.className="login-required",e.href=config.relative_path+"/login",y.translate("[[topic:login-to-view]]",function(n){e.appendChild(document.createTextNode(n)),t.each(function(o,s){$(s).find('[component="post/content"] img').each(function(c,a){a=$(a),a.attr("src").startsWith(config.relative_path+config.upload_url)&&a.replaceWith(e.cloneNode(!0))})})})}l.onNewPostsAddedToDom=function(t){l.onTopicPageLoad(t),app.createUserTooltips(t),utils.addCommasToNumbers(t.find(".formatted-number")),utils.makeNumbersHumanReadable(t.find(".human-readable-number")),t.find(".timeago").timeago()},l.showBottomPostBar=function(){const t=r.get("post","index",0),e=$(".post-bar-placeholder"),n=$('[component="post"]');t.length&&n.length>1&&$(".post-bar").length<2&&e.length?($(".post-bar").clone().insertAfter(e),e.remove()):t.length&&n.length<2&&t.find(".post-bar").remove()};function L(t){t.each(function(){$(this).hasClass("deleted")&&u.toggle($(this).attr("data-pid"),!0)})}return l.addBlockquoteEllipses=function(t){t.find('[component="post/content"] > blockquote > blockquote').each(function(){const n=$(this);n.find(":hidden:not(br)").length&&!n.find(".toggle").length&&n.append('<i class="fa fa-angle-down pointer toggle"></i>')})},l}.apply(M,P),d!==void 0&&(N.exports=d)},11120:N=>{N.exports=function(M,i,P){i.setGlobal("true",!0),i.setGlobal("false",!1);const d={displayMenuItem:v,buildMetaTag:u,buildLinkTag:T,stringify:w,escape:r,stripTags:y,generateCategoryBackground:I,generateChildrenCategories:B,generateTopicClass:l,membershipBtn:f,spawnPrivilegeStates:b,localeToHTML:p,renderTopicImage:h,renderTopicEvents:g,renderEvents:C,renderDigestAvatar:S,userAgentIcons:F,buildAvatar:R,register:L,getPredictionColor:k,formatPrediction:j,__escape:_};function _(t){return t}function v(t,e){const n=t.navigation[e];return!(!n||n.route.match("/users")&&t.user&&!t.user.privileges["view:users"]||n.route.match("/tags")&&t.user&&!t.user.privileges["view:tags"]||n.route.match("/groups")&&t.user&&!t.user.privileges["view:groups"])}function u(t){const e=t.name?'name="'+t.name+'" ':"",n=t.property?'property="'+t.property+'" ':"",o=t.content?'content="'+t.content.replace(/\n/g," ")+'" ':"";return"<meta "+e+n+o+`/>
	`}function T(t){const e=["link","rel","as","type","href","sizes","title","crossorigin"],[n,o,s,c,a,A,m,E]=e.map(x=>t[x]?`${x}="${t[x]}" `:"");return"<link "+n+o+s+c+A+m+a+E+`/>
	`}function w(t){return JSON.stringify(t).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")}function r(t){return M.escapeHTML(t)}function y(t){return M.stripHTMLTags(t)}function I(t){if(!t)return"";const e=[];return t.bgColor&&e.push("background-color: "+t.bgColor),t.color&&e.push("color: "+t.color),t.backgroundImage&&(e.push("background-image: url("+t.backgroundImage+")"),t.imageClass&&e.push("background-size: "+t.imageClass)),e.join("; ")+";"}function B(t){let e="";return!t||!t.children||!t.children.length||(t.children.forEach(function(n){if(n&&!n.isSection){const o=n.link?n.link:P+"/category/"+n.slug;e+='<span class="category-children-item pull-left"><div role="presentation" class="icon pull-left" style="'+I(n)+'"><i class="fa fa-fw '+n.icon+'"></i></div><a href="'+o+'"><small>'+n.name+"</small></a></span>"}}),e=e&&'<span class="category-children">'+e+"</span>"),e}function l(t){return["locked","pinned","deleted","unread","scheduled"].filter(n=>!!t[n]).join(" ")}function f(t){return t.isMember&&t.name!=="administrators"?'<button class="btn btn-danger" data-action="leave" data-group="'+t.displayName+'"'+(t.disableLeave?" disabled":"")+'><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>':t.isPending&&t.name!=="administrators"?'<button class="btn btn-warning disabled"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>':t.isInvited?'<button class="btn btn-link" data-action="rejectInvite" data-group="'+t.displayName+'">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="'+t.name+'"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>':!t.disableJoinRequests&&t.name!=="administrators"?'<button class="btn btn-success" data-action="join" data-group="'+t.displayName+'"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>':""}function b(t,e){const n=[];for(const o in e)e.hasOwnProperty(o)&&n.push({name:o,state:e[o]});return n.map(function(o){const s=["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"],c=["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"],a=["groups:moderate"],A=t==="guests"&&(s.includes(o.name)||o.name.startsWith("groups:admin:"))||t==="spiders"&&!c.includes(o.name)||t==="Global Moderators"&&a.includes(o.name);return'<td class="text-center" data-privilege="'+o.name+'" data-value="'+o.state+'"><input autocomplete="off" type="checkbox"'+(o.state?" checked":"")+(A?' disabled="disabled"':"")+" /></td>"}).join("")}function p(t,e){return t=t||e||"en-GB",t.replace("_","-")}function h(t){return t.thumb?'<img src="'+t.thumb+'" class="img-circle user-img" title="'+t.user.username+'" />':'<img component="user/picture" data-uid="'+t.user.uid+'" src="'+t.user.picture+'" class="user-img" title="'+t.user.username+'" />'}function g(t,e){if(e==="most_votes")return"";const n=this.posts[t].eventStart,o=this.posts[t].eventEnd,s=this.events.filter(c=>c.timestamp>=n&&c.timestamp<o);return s.length?C.call(this,s):""}function C(t){return t.reduce((e,n)=>(e+=`<li component="topic/event" class="timeline-event" data-topic-event-id="${n.id}" data-topic-event-type="${n.type}">
                <div class="timeline-badge">
                    <i class="fa ${n.icon||"fa-circle"}"></i>
                </div>
                <span class="timeline-text">
                    ${n.href?`<a href="${P}${n.href}">${n.text}</a>`:n.text}&nbsp;
                </span>
            `,n.user&&(n.user.system?e+='<span class="timeline-text">[[global:system-user]]</span>&nbsp;':e+=`<span><a href="${P}/user/${n.user.userslug}">${R(n.user,"xs",!0)}&nbsp;${n.user.username}</a></span>&nbsp;`),e+=`<span class="timeago timeline-text" title="${n.timestampISO}"></span>`,this.privileges.isAdminOrMod&&(e+=`&nbsp;<span component="topic/event/delete" data-topic-event-id="${n.id}" data-topic-event-type="${n.type} class="timeline-text pointer" title="[[topic:delete-event]]"><i class="fa fa-trash"></i></span>`),e),"")}function S(t){return t.teaser?t.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+t.teaser.user.picture+'" title="'+t.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+t.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+t.teaser.user["icon:text"]+"</div>":t.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+t.user.picture+'" title="'+t.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+t.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+t.user["icon:text"]+"</div>"}function F(t){let e="";switch(t.platform){case"Linux":e+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":e+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":e+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":e+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":e+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":e+='<i class="fa fa-fw fa-mobile"></i>';break;default:e+='<i class="fa fa-fw fa-question-circle"></i>';break}switch(t.browser){case"Chrome":e+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":e+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":e+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":e+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":e+='<i class="fa fa-fw fa-edge"></i>';break;default:e+='<i class="fa fa-fw fa-question-circle"></i>';break}return e}function R(t,e,n,o,s){t||(t=this);const c=['alt="'+t.username+'"','title="'+t.username+'"','data-uid="'+t.uid+'"','loading="lazy"'],a=[];return o=o||"",["xs","sm","sm2x","md","lg","xl"].includes(e)?o+=" avatar-"+e:isNaN(parseInt(e,10))?o+=" avatar-sm":a.push("width: "+e+"px;","height: "+e+"px;","line-height: "+e+"px;","font-size: "+parseInt(e,10)/16+"rem;"),c.unshift('class="avatar '+o+(n?" avatar-rounded":"")+'"'),s?c.push('component="'+s+'"'):c.push('component="avatar/'+(t.picture?"picture":"icon")+'"'),t.picture?"<img "+c.join(" ")+' src="'+t.picture+'" style="'+a.join(" ")+'" />':(a.push("background-color: "+t["icon:bgColor"]+";"),"<span "+c.join(" ")+' style="'+a.join(" ")+'">'+t["icon:text"]+"</span>")}function k(t){return t===1?'"background-color: rgb(0, 255, 0);"':'"background-color: rgb(255, 0, 0);"'}function j(t){return t===1?"Good":"Poor"}function L(){Object.keys(d).forEach(function(t){i.registerHelper(t,d[t])})}return d}},59265:(N,M,i)=>{var P,d;const _=i(11120);P=[i(96795),i(59006)],d=function(v,u){return _(v,u,config.relative_path)}.apply(M,P),d!==void 0&&(N.exports=d)}}]);
