"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[6753],{45561:(x,A,s)=>{var y,l;y=[s(7237),s(32230),s(59006),s(59494),s(997),s(74344),s(31369),s(7927)],l=function(p,j,E,f,u,c,g,o){const i={};i.init=function(){$("#state").val(ajaxify.data.state).removeAttr("disabled"),$("#assignee").val(ajaxify.data.assignee).removeAttr("disabled"),$("#content > div").on("click","[data-action]",function(){const r=this.getAttribute("data-action"),e=$(this).parents("[data-uid]").attr("data-uid"),a=document.getElementById("note");switch(r){case"assign":$("#assignee").val(app.user.uid);case"update":{const t=$("#attributes").serializeArray().reduce((n,d)=>(n[d.name]=d.value,n),{});c.put(`/flags/${ajaxify.data.flagId}`,t).then(({history:n})=>{o.success("[[flags:updated]]"),i.reloadHistory(n)}).catch(o.error);break}case"appendNote":c.post(`/flags/${ajaxify.data.flagId}/notes`,{note:a.value,datetime:parseInt(a.getAttribute("data-datetime"),10)}).then(t=>{o.success("[[flags:note-added]]"),i.reloadNotes(t.notes),i.reloadHistory(t.history),a.removeAttribute("data-datetime")}).catch(o.error);break;case"delete-note":{const t=parseInt(this.closest("[data-datetime]").getAttribute("data-datetime"),10);g.confirm("[[flags:delete-note-confirm]]",function(n){n&&c.delete(`/flags/${ajaxify.data.flagId}/notes/${t}`,{}).then(d=>{o.success("[[flags:note-deleted]]"),i.reloadNotes(d.notes),i.reloadHistory(d.history)}).catch(o.error)});break}case"chat":s.e(3216).then(function(){var t=[s(93216)];(function(n){n.newChat(e)}).apply(null,t)}).catch(s.oe);break;case"ban":f.banAccount(e,ajaxify.refresh);break;case"unban":f.unbanAccount(e);break;case"mute":f.muteAccount(e,ajaxify.refresh);break;case"unmute":f.unmuteAccount(e);break;case"delete-account":u.account(e,ajaxify.refresh);break;case"delete-content":u.content(e,ajaxify.refresh);break;case"delete-all":u.purge(e,ajaxify.refresh);break;case"delete-post":h("delete",c.del,`/posts/${ajaxify.data.target.pid}/state`);break;case"purge-post":h("purge",c.del,`/posts/${ajaxify.data.target.pid}`);break;case"restore-post":h("restore",c.put,`/posts/${ajaxify.data.target.pid}/state`);break;case"prepare-edit":{const t=this.closest("[data-index]"),n=t.getAttribute("data-index"),d=document.getElementById("note");d.value=ajaxify.data.notes[n].content,d.setAttribute("data-datetime",ajaxify.data.notes[n].datetime);const m=t.parentElement.children;for(const b in m)m.hasOwnProperty(b)&&m[b].classList.remove("editing");t.classList.add("editing"),d.focus();break}case"delete-flag":{g.confirm("[[flags:delete-flag-confirm]]",function(t){t&&c.delete(`/flags/${ajaxify.data.flagId}`,{}).then(()=>{o.success("[[flags:flag-deleted]]"),ajaxify.go("flags")}).catch(o.error)});break}}})};function h(r,e,a){j.translate("[[topic:post_"+r+"_confirm]]",function(t){g.confirm(t,function(n){n&&e(a).then(ajaxify.refresh).catch(o.error)})})}return i.reloadNotes=function(r){ajaxify.data.notes=r,E.render("flags/detail",{notes:r},"notes").then(function(e){const a=p.get("flag/notes");a.empty(),a.html(e),a.find("span.timeago").timeago(),document.getElementById("note").value=""})},i.reloadHistory=function(r){app.parseAndTranslate("flags/detail","history",{history:r},function(e){const a=p.get("flag/history");a.empty(),a.html(e),a.find("span.timeago").timeago()})},i}.apply(A,y),l!==void 0&&(x.exports=l)}}]);
