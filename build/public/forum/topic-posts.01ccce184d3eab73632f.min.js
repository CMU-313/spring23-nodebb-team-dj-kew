"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[2586,6922,560,3382],{25142:(k,N,r)=>{var v,g;v=[r(85233),r(7927)],g=function(D,P){const u={};let T,w=0,c=!1,b,I=0;u.init=function(f,A){const p=$("body");typeof f=="function"?(T=f,b=p):(T=A,b=f||p),w=$(window).scrollTop(),$(window).off("scroll",F).on("scroll",F),p.height()<=$(window).height()&&T(1)};function F(){I&&clearTimeout(I),I=setTimeout(function(){I=0,l()},60)}function l(){const f=utils.findBootstrapEnvironment(),A=(f==="xs"||f==="sm")&&$("html").hasClass("composing");if(c||A)return;const p=$(window).scrollTop(),x=$(window).height(),m=b.height()-x,C=b.offset()?b.offset().top:0,S=100*(p-C)/(m<=0?x:m),L=15,j=85,B=p>w?1:-1;(S<L&&p<w||S>j&&p>w||S<0&&B>0&&m<0)&&T(B),w=p}return u.loadMore=function(f,A,p){if(c)return;c=!0;const x={method:f,data:A};D.fire("action:infinitescroll.loadmore",x),socket.emit(x.method,x.data,function(m,C){if(m)return c=!1,P.error(m);p(C,function(){c=!1})})},u.loadMoreXhr=function(f,A){if(c)return;c=!0;const p=config.relative_path+"/api"+location.pathname.replace(new RegExp("^"+config.relative_path),""),x={url:p,data:f};D.fire("action:infinitescroll.loadmore.xhr",x),$.get(p,f,function(m){A(m,function(){c=!1})}).fail(function(m){c=!1,P.error(String(m.responseJSON||m.statusText))})},u.removeExtra=function(f,A,p){let x=$();if(f.length<=p)return x;const m=f.length-p;if(A>0){const C=$(document).height(),S=$(window).scrollTop();x=f.slice(0,m).remove(),$(window).scrollTop(S+($(document).height()-C))}else x=f.slice(f.length-m).remove();return x},u}.apply(N,v),g!==void 0&&(k.exports=g)},47720:(k,N)=>{var r,v;r=[],v=function(){const g={};return g.wrapImagesInLinks=function(D){D.find('[component="post/content"] img:not(.emoji)').each(function(){const P=$(this);let u=P.attr("src")||"";const T=P.attr("alt")||"",w=/-resized(\.[\w]+)?$/;if(u==="about:blank")return;utils.isRelativeUrl(u)&&w.test(u)&&(u=u.replace(w,"$1"));const c=u.split(".").slice(1).pop(),b=T.split("/").pop(),I=b.split(".").slice(1).pop();P.parent().is("a")||P.wrap('<a href="'+u+'" '+(!c&&I?' download="'+b+'" ':"")+' target="_blank" rel="noopener">')})},g}.apply(N,r),v!==void 0&&(k.exports=v)},60447:(k,N,r)=>{var v,g;v=[r(78989),r(25142),r(54939),r(47720),r(42840),r(7237),r(32230),r(85233),r(59265)],g=function(D,P,u,T,w,c,b,I,F){const l={};l.signaturesShown={},l.onNewPost=function(t){!t||!t.posts||!t.posts.length||parseInt(t.posts[0].tid,10)!==parseInt(ajaxify.data.tid,10)||(t.loggedIn=!!app.user.uid,t.privileges=ajaxify.data.privileges,t.posts[0].timestamp=t.posts[0].topic.scheduled?t.posts[0].timestamp:Date.now()-1e3,t.posts[0].timestampISO=utils.toISOString(t.posts[0].timestamp),l.modifyPostsByPrivileges(t.posts),f(t.posts),A(t.posts),ajaxify.data.postcount+=1,u.updatePostCount(ajaxify.data.postcount),config.usePagination?p(t):m(t),r.e(1352).then(function(){var n=[r(21352)];(function(o){o.onNewPost(t)}).apply(null,n)}).catch(r.oe))},l.modifyPostsByPrivileges=function(t){t.forEach(function(n){n.selfPost=!!app.user.uid&&parseInt(n.uid,10)===parseInt(app.user.uid,10),n.topicOwnerPost=parseInt(n.uid,10)===parseInt(ajaxify.data.uid,10),n.display_edit_tools=ajaxify.data.privileges["posts:edit"]&&n.selfPost||ajaxify.data.privileges.isAdminOrMod,n.display_delete_tools=ajaxify.data.privileges["posts:delete"]&&n.selfPost||ajaxify.data.privileges.isAdminOrMod,n.display_moderator_tools=n.display_edit_tools||n.display_delete_tools,n.display_move_tools=ajaxify.data.privileges.isAdminOrMod,n.display_post_menu=ajaxify.data.privileges.isAdminOrMod||n.selfPost&&!ajaxify.data.locked&&!n.deleted||n.selfPost&&n.deleted&&parseInt(n.deleterUid,10)===parseInt(app.user.uid,10)||(app.user.uid||ajaxify.data.postSharing.length)&&!n.deleted})};function f(t){for(let n=0;n<t.length;n+=1){const o=c.get("user/postcount",t[n].uid);o.html(parseInt(o.attr("data-postcount"),10)+1),utils.addCommasToNumbers(o)}}function A(t){config.topicPostSort==="newest_to_oldest"&&(t[0].index=1,c.get("post").not("[data-index=0]").each(function(){const n=parseInt($(this).attr("data-index"),10)+1;$(this).attr("data-index",n)}))}function p(t){function n(){C(t.posts[0])}const o=t.posts;ajaxify.data.pagination.pageCount=Math.max(1,Math.ceil(o[0].topic.postcount/config.postsPerPage));const i=config.topicPostSort==="oldest_to_newest"||config.topicPostSort==="most_votes"?1:-1;if(ajaxify.data.pagination.currentPage===ajaxify.data.pagination.pageCount&&i===1||ajaxify.data.pagination.currentPage===1&&i===-1){const y=$('[component="post"]:not([data-index=0]), [component="topic/event"]');S(t,y,i,!1,n)}else ajaxify.data.scrollToMyPost&&parseInt(o[0].uid,10)===parseInt(app.user.uid,10)?setTimeout(function(){D.loadPage(ajaxify.data.pagination.pageCount,n)},250):x()}function x(){$.get(config.relative_path+"/api/topic/pagination/"+ajaxify.data.tid,{page:ajaxify.data.pagination.currentPage},function(t){app.parseAndTranslate("partials/paginator",t,function(n){$('[component="pagination"]').after(n).remove()})})}function m(t){const n=config.topicPostSort==="oldest_to_newest"||config.topicPostSort==="most_votes"?1:-1,o=$('[component="post"][data-index="'+(t.posts[0].index-1)+'"]').length;if(!o&&(!t.posts[0].selfPost||!ajaxify.data.scrollToMyPost))return;if(!o&&t.posts[0].selfPost)return ajaxify.go("post/"+t.posts[0].pid);const i=$('[component="topic"]>[component="post"]:not([data-index=0]), [component="topic"]>[component="topic/event"]');S(t,i,n,!1,function(a){a&&a.addClass("new"),C(t.posts[0])})}function C(t){t.selfPost&&ajaxify.data.scrollToMyPost&&w.scrollBottom(t.index)}function S(t,n,o,i,a){if(a=a||function(){},!t||t.posts&&!t.posts.length)return a();function y(){const d=$('[component="post"].new');if(d.length===t.posts.length){let _=!0;if(d.each(function(E,R){parseInt($(R).attr("data-pid"),10)!==parseInt(t.posts[E].pid,10)&&(_=!1)}),_){d.each(function(){$(this).removeClass("new")}),t.posts.length=0;return}}d.length&&t.posts.length>1&&t.posts.forEach(function(_){const E=c.get("post","pid",_.pid);E.hasClass("new")&&E.remove()}),t.posts=t.posts.filter(function(_){return _.index===-1||$('[component="post"][data-pid="'+_.pid+'"]').length===0})}if(y(),!t.posts.length)return a();let h,M;o>0&&n.length?h=n.last():o<0&&n.length&&(M=n.first()),I.fire("action:posts.loading",{posts:t.posts,after:h,before:M}),app.parseAndTranslate("topic","posts",Object.assign({},ajaxify.data,t),function(d){if(d=d.filter(function(){const E=$(this),R=E.attr("data-pid"),W=parseInt(E.attr("data-index"),10);return!E.is('[component="post"]')||W===-1||R&&$('[component="post"][data-pid="'+R+'"]').length===0}),h)d.insertAfter(h);else if(M){const E=$(document).height(),R=$(window).scrollTop();d.insertBefore(M),(i||R>0)&&$(window).scrollTop(R+($(document).height()-E))}else c.get("topic").append(d);const _=P.removeExtra($('[component="post"]'),o,Math.max(20,config.postsPerPage*2));B(_),I.fire("action:posts.loaded",{posts:t.posts}),l.onNewPostsAddedToDom(d),a(d)})}l.loadMorePosts=function(t){if(!c.get("topic").length||w.scrollActive)return;const n=c.get("topic").find(c.get("post").not("[data-index=0]").not(".new")),o=t>0?n.last():n.first(),i=parseInt(o.attr("data-index"),10)||0,a=ajaxify.data.tid;if(!utils.isNumber(a)||!utils.isNumber(i)||t<0&&c.get("post","index",0).length)return;const y=$(".loading-indicator");y.is(":animated")||y.fadeIn(),P.loadMore("topics.loadMore",{tid:a,after:i+(t>0?1:0),count:config.postsPerPage,direction:t,topicPostSort:config.topicPostSort},function(h,M){if(y.fadeOut(),h&&h.posts&&h.posts.length){const d=$('[component="post"]:not([data-index=0]):not(.new), [component="topic/event"]');S(h,d,t,!0,M)}else w.update(),M()})},l.onTopicPageLoad=function(t){e(t),T.wrapImagesInLinks(t),j(t),l.showBottomPostBar(),t.find('[component="post/content"] img:not(.not-responsive)').addClass("img-responsive"),l.addBlockquoteEllipses(t),s(t),L()},l.addTopicEvents=function(t){if(config.topicPostSort==="most_votes")return;const n=F.renderEvents.call(ajaxify.data,t);b.translate(n,o=>{if(config.topicPostSort==="oldest_to_newest")$('[component="topic"]').append(o);else if(config.topicPostSort==="newest_to_oldest"){const i=$('[component="topic"] [component="post"][data-index="0"]');i.length?$(o).insertAfter(i):$('[component="topic"]').prepend(o)}$('[component="topic/event"] .timeago').timeago()})};function L(){const t=ajaxify.data.necroThreshold*24*60*60*1e3;if(!t||config.topicPostSort!=="newest_to_oldest"&&config.topicPostSort!=="oldest_to_newest")return;$('[component="post"]').toArray().forEach(function(o){o=$(o);const i=o.prev('[component="post"]');if(o.is(":has(.necro-post)")||!i.length||config.topicPostSort==="newest_to_oldest"&&parseInt(i.attr("data-index"),10)===0)return;const a=o.attr("data-timestamp")-i.attr("data-timestamp");if(Math.abs(a)>=t){const y=$.timeago.settings.strings.suffixAgo,h=$.timeago.settings.strings.prefixAgo,M=$.timeago.settings.strings.suffixFromNow,d=$.timeago.settings.strings.prefixFromNow;$.timeago.settings.strings.suffixAgo="",$.timeago.settings.strings.prefixAgo="",$.timeago.settings.strings.suffixFromNow="",$.timeago.settings.strings.prefixFromNow="";const _=(a>0?"[[topic:timeago_later,":"[[topic:timeago_earlier,")+$.timeago.inWords(a)+"]]";$.timeago.settings.strings.suffixAgo=y,$.timeago.settings.strings.prefixAgo=h,$.timeago.settings.strings.suffixFromNow=M,$.timeago.settings.strings.prefixFromNow=d,app.parseAndTranslate("partials/topic/necro-post",{text:_},function(E){E.attr("data-necro-post-index",i.attr("data-index")),E.insertBefore(o)})}})}function j(t){ajaxify.data["signatures:hideDuplicates"]&&t.each((n,o)=>{const i=$(o).find('[component="post/signature"]'),a=i.attr("data-uid");l.signaturesShown[a]?i.addClass("hidden"):l.signaturesShown[a]=!0})}function B(t){t.each((n,o)=>{$(`[data-necro-post-index="${$(o).attr("data-index")}"]`).remove()})}function e(t){if(app.user.uid||!ajaxify.data.privateUploads)return;const n=document.createElement("a");n.className="login-required",n.href=config.relative_path+"/login",b.translate("[[topic:login-to-view]]",function(o){n.appendChild(document.createTextNode(o)),t.each(function(i,a){$(a).find('[component="post/content"] img').each(function(y,h){h=$(h),h.attr("src").startsWith(config.relative_path+config.upload_url)&&h.replaceWith(n.cloneNode(!0))})})})}l.onNewPostsAddedToDom=function(t){l.onTopicPageLoad(t),app.createUserTooltips(t),utils.addCommasToNumbers(t.find(".formatted-number")),utils.makeNumbersHumanReadable(t.find(".human-readable-number")),t.find(".timeago").timeago()},l.showBottomPostBar=function(){const t=c.get("post","index",0),n=$(".post-bar-placeholder"),o=$('[component="post"]');t.length&&o.length>1&&$(".post-bar").length<2&&n.length?($(".post-bar").clone().insertAfter(n),n.remove()):t.length&&o.length<2&&t.find(".post-bar").remove()};function s(t){t.each(function(){$(this).hasClass("deleted")&&u.toggle($(this).attr("data-pid"),!0)})}return l.addBlockquoteEllipses=function(t){t.find('[component="post/content"] > blockquote > blockquote').each(function(){const o=$(this);o.find(":hidden:not(br)").length&&!o.find(".toggle").length&&o.append('<i class="fa fa-angle-down pointer toggle"></i>')})},l}.apply(N,v),g!==void 0&&(k.exports=g)},11120:k=>{k.exports=function(N,r,v){r.setGlobal("true",!0),r.setGlobal("false",!1);const g={displayMenuItem:P,buildMetaTag:u,buildLinkTag:T,stringify:w,escape:c,stripTags:b,generateCategoryBackground:I,generateChildrenCategories:F,generateTopicClass:l,membershipBtn:f,spawnPrivilegeStates:A,localeToHTML:p,renderTopicImage:x,renderTopicEvents:m,renderEvents:C,renderDigestAvatar:S,userAgentIcons:L,buildAvatar:j,register:B,__escape:D};function D(e){return e}function P(e,s){const t=e.navigation[s];return!(!t||t.route.match("/users")&&e.user&&!e.user.privileges["view:users"]||t.route.match("/tags")&&e.user&&!e.user.privileges["view:tags"]||t.route.match("/groups")&&e.user&&!e.user.privileges["view:groups"])}function u(e){const s=e.name?'name="'+e.name+'" ':"",t=e.property?'property="'+e.property+'" ':"",n=e.content?'content="'+e.content.replace(/\n/g," ")+'" ':"";return"<meta "+s+t+n+`/>
	`}function T(e){const s=["link","rel","as","type","href","sizes","title","crossorigin"],[t,n,o,i,a,y,h,M]=s.map(d=>e[d]?`${d}="${e[d]}" `:"");return"<link "+t+n+o+i+y+h+a+M+`/>
	`}function w(e){return JSON.stringify(e).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")}function c(e){return N.escapeHTML(e)}function b(e){return N.stripHTMLTags(e)}function I(e){if(!e)return"";const s=[];return e.bgColor&&s.push("background-color: "+e.bgColor),e.color&&s.push("color: "+e.color),e.backgroundImage&&(s.push("background-image: url("+e.backgroundImage+")"),e.imageClass&&s.push("background-size: "+e.imageClass)),s.join("; ")+";"}function F(e){let s="";return!e||!e.children||!e.children.length||(e.children.forEach(function(t){if(t&&!t.isSection){const n=t.link?t.link:v+"/category/"+t.slug;s+='<span class="category-children-item pull-left"><div role="presentation" class="icon pull-left" style="'+I(t)+'"><i class="fa fa-fw '+t.icon+'"></i></div><a href="'+n+'"><small>'+t.name+"</small></a></span>"}}),s=s&&'<span class="category-children">'+s+"</span>"),s}function l(e){return["locked","pinned","deleted","unread","scheduled"].filter(t=>!!e[t]).join(" ")}function f(e){return e.isMember&&e.name!=="administrators"?'<button class="btn btn-danger" data-action="leave" data-group="'+e.displayName+'"'+(e.disableLeave?" disabled":"")+'><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>':e.isPending&&e.name!=="administrators"?'<button class="btn btn-warning disabled"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>':e.isInvited?'<button class="btn btn-link" data-action="rejectInvite" data-group="'+e.displayName+'">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="'+e.name+'"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>':!e.disableJoinRequests&&e.name!=="administrators"?'<button class="btn btn-success" data-action="join" data-group="'+e.displayName+'"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>':""}function A(e,s){const t=[];for(const n in s)s.hasOwnProperty(n)&&t.push({name:n,state:s[n]});return t.map(function(n){const o=["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"],i=["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"],a=["groups:moderate"],y=e==="guests"&&(o.includes(n.name)||n.name.startsWith("groups:admin:"))||e==="spiders"&&!i.includes(n.name)||e==="Global Moderators"&&a.includes(n.name);return'<td class="text-center" data-privilege="'+n.name+'" data-value="'+n.state+'"><input autocomplete="off" type="checkbox"'+(n.state?" checked":"")+(y?' disabled="disabled"':"")+" /></td>"}).join("")}function p(e,s){return e=e||s||"en-GB",e.replace("_","-")}function x(e){return e.thumb?'<img src="'+e.thumb+'" class="img-circle user-img" title="'+e.user.username+'" />':'<img component="user/picture" data-uid="'+e.user.uid+'" src="'+e.user.picture+'" class="user-img" title="'+e.user.username+'" />'}function m(e,s){if(s==="most_votes")return"";const t=this.posts[e].eventStart,n=this.posts[e].eventEnd,o=this.events.filter(i=>i.timestamp>=t&&i.timestamp<n);return o.length?C.call(this,o):""}function C(e){return e.reduce((s,t)=>(s+=`<li component="topic/event" class="timeline-event" data-topic-event-id="${t.id}" data-topic-event-type="${t.type}">
                <div class="timeline-badge">
                    <i class="fa ${t.icon||"fa-circle"}"></i>
                </div>
                <span class="timeline-text">
                    ${t.href?`<a href="${v}${t.href}">${t.text}</a>`:t.text}&nbsp;
                </span>
            `,t.user&&(t.user.system?s+='<span class="timeline-text">[[global:system-user]]</span>&nbsp;':s+=`<span><a href="${v}/user/${t.user.userslug}">${j(t.user,"xs",!0)}&nbsp;${t.user.username}</a></span>&nbsp;`),s+=`<span class="timeago timeline-text" title="${t.timestampISO}"></span>`,this.privileges.isAdminOrMod&&(s+=`&nbsp;<span component="topic/event/delete" data-topic-event-id="${t.id}" data-topic-event-type="${t.type} class="timeline-text pointer" title="[[topic:delete-event]]"><i class="fa fa-trash"></i></span>`),s),"")}function S(e){return e.teaser?e.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+e.teaser.user.picture+'" title="'+e.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+e.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+e.teaser.user["icon:text"]+"</div>":e.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+e.user.picture+'" title="'+e.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+e.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+e.user["icon:text"]+"</div>"}function L(e){let s="";switch(e.platform){case"Linux":s+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":s+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":s+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":s+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":s+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":s+='<i class="fa fa-fw fa-mobile"></i>';break;default:s+='<i class="fa fa-fw fa-question-circle"></i>';break}switch(e.browser){case"Chrome":s+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":s+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":s+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":s+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":s+='<i class="fa fa-fw fa-edge"></i>';break;default:s+='<i class="fa fa-fw fa-question-circle"></i>';break}return s}function j(e,s,t,n,o){e||(e=this);const i=['alt="'+e.username+'"','title="'+e.username+'"','data-uid="'+e.uid+'"','loading="lazy"'],a=[];return n=n||"",["xs","sm","sm2x","md","lg","xl"].includes(s)?n+=" avatar-"+s:isNaN(parseInt(s,10))?n+=" avatar-sm":a.push("width: "+s+"px;","height: "+s+"px;","line-height: "+s+"px;","font-size: "+parseInt(s,10)/16+"rem;"),i.unshift('class="avatar '+n+(t?" avatar-rounded":"")+'"'),o?i.push('component="'+o+'"'):i.push('component="avatar/'+(e.picture?"picture":"icon")+'"'),e.picture?"<img "+i.join(" ")+' src="'+e.picture+'" style="'+a.join(" ")+'" />':(a.push("background-color: "+e["icon:bgColor"]+";"),"<span "+i.join(" ")+' style="'+a.join(" ")+'">'+e["icon:text"]+"</span>")}function B(){Object.keys(g).forEach(function(e){r.registerHelper(e,g[e])})}return g}},59265:(k,N,r)=>{var v,g;const D=r(11120);v=[r(96795),r(59006)],g=function(P,u){return D(P,u,config.relative_path)}.apply(N,v),g!==void 0&&(k.exports=g)}}]);
