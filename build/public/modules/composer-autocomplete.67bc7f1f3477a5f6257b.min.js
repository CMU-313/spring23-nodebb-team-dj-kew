"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[8894,2735],{2585:(f,m,v)=>{var u,c;u=[v(83713),v(70675),v(88207),v(62336)],c=function(p,{Textcomplete:t},{TextareaEditor:n},{ContenteditableEditor:r}){var i={_active:{}};return $(window).on("action:composer.discard",function(l,e){i._active.hasOwnProperty(e.post_uuid)&&(i._active[e.post_uuid].destroy(),delete i._active[e.post_uuid])}),i.init=function(l,e){var a=l.find(".write"),d="composer-autocomplete-dropdown-"+e,s;if(a.length){var o={element:a,strategies:[],options:{style:{"z-index":2e4},className:d+" dropdown-menu textcomplete-dropdown"}};a.on("keyup",function(){clearTimeout(s),s=setTimeout(function(){var g=document.querySelector("."+d);if(g){var w=g.getBoundingClientRect(),h=parseFloat(g.style.marginTop,10)||0,x=window.innerHeight+h-10-w.bottom;g.style.marginTop=Math.min(x,0)+"px"}},0)}),$(window).trigger("composer:autocomplete:init",o),i._active[e]=i.setup(o),o.element.on("textComplete:select",function(){p.render(l)})}},i.setup=function({element:l,strategies:e,options:a}){const d=l.get(0);if(d){var s;d.nodeName==="TEXTAREA"?s=new n(d):d.nodeName==="DIV"&&d.getAttribute("contenteditable")==="true"&&(s=new r(d)),d.setAttribute("dir",document.querySelector("html").getAttribute("data-dir"));var o=new t(s,e,{dropdown:a});return o.on("rendered",function(){o.dropdown.items.length&&o.dropdown.items[0].activate()}),o}},i}.apply(m,u),c!==void 0&&(f.exports=c)},83713:(f,m,v)=>{var u,c;u=[v(85233)],c=function(p){var t={};return t.render=function(n,r){if(r=r||function(){},!n.find(".preview-container").is(":visible"))return r();var i=n.find("textarea");socket.emit("plugins.composer.renderPreview",i.val(),function(l,e){l||(e=$("<div>"+e+"</div>"),e.find("img:not(.not-responsive)").addClass("img-responsive"),n.find(".preview").html(e),p.fire("action:composer.preview"),r())})},t.matchScroll=function(n){if(n.find(".preview-container").is(":visible")){var r=n.find("textarea"),i=n.find(".preview");if(r.length&&i.length){var l=r[0].scrollHeight-r.height();if(l===0)return;var e=r.scrollTop()/l;i.scrollTop(Math.max(i[0].scrollHeight-i.height(),0)*e)}}},t.handleToggler=function(n){t.env=utils.findBootstrapEnvironment();var r=n.find(".write-container .toggle-preview"),i=n.find(".preview-container .toggle-preview"),l=$(".preview-container"),e=$(".write-container");function a(){s(!1),t.env!=="xs"&&t.env!=="sm"&&localStorage.setItem("composer:previewToggled",!0)}function d(){s(!0),t.env!=="xs"&&t.env!=="sm"&&localStorage.removeItem("composer:previewToggled")}function s(o){t.env==="xs"||t.env==="sm"?(l.toggleClass("hide",!1),e.toggleClass("maximized",!1),r.toggleClass("hide",!0),l.toggleClass("hidden-xs hidden-sm",!o),e.toggleClass("hidden-xs hidden-sm",o),o&&t.render(n)):(l.toggleClass("hide",!o),e.toggleClass("maximized",!o),r.toggleClass("hide",o)),t.matchScroll(n)}t.toggle=s,i.on("click",function(){a(),n.find(".write").focus()}),r.on("click",function(){d(),n.find(".write").focus()}),localStorage.getItem("composer:previewToggled")||t.env==="xs"||t.env==="sm"?a():d()},t}.apply(m,u),c!==void 0&&(f.exports=c)}}]);
