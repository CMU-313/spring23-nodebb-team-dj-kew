"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[6721,7214,6503,8786,5655,8306,7073],{7927:(v,_,g)=>{var h,s;h=[g(32230),g(7237),g(85233)],s=function(o,c,r){const u={};u.alert=function(e){e.alert_id="alert_button_"+(e.alert_id?e.alert_id:new Date().getTime()),e.title=e.title&&e.title.trim()||"",e.message=e.message?e.message.trim():"",e.type=e.type||"info";const n=$("#"+e.alert_id);n.length?C(n,e):f(e)},u.success=function(e,n){u.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:e,type:"success",timeout:n||5e3})},u.error=function(e,n){if(e=e&&e.message||e,e==="[[error:revalidate-failure]]"){socket.disconnect(),app.reconnect();return}u.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:e,type:"danger",timeout:n||1e4})},u.remove=function(e){$("#alert_button_"+e).remove()};function f(e){app.parseAndTranslate("alert",e,function(n){let i=$("#"+e.alert_id);if(i.length)return C(i,e);i=n,i.fadeIn(200),c.get("toaster/tray").prepend(i),typeof e.closefn=="function"&&i.find("button").on("click",function(){return e.closefn(),t(i),!1}),e.timeout&&a(i,e),typeof e.clickfn=="function"&&i.addClass("pointer").on("click",function(l){$(l.target).is(".close")||e.clickfn(i,e),t(i)}),r.fire("action:alert.new",{alert:i,params:e})})}function C(e,n){e.find("strong").translateHtml(n.title),e.find("p").translateHtml(n.message),e.attr("class","alert alert-dismissable alert-"+n.type+" clearfix"),clearTimeout(parseInt(e.attr("timeoutId"),10)),n.timeout&&a(e,n),r.fire("action:alert.update",{alert:e,params:n}),e.off("click").removeClass("pointer"),typeof n.clickfn=="function"&&e.addClass("pointer").on("click",function(i){$(i.target).is(".close")||n.clickfn(),t(e)})}function t(e){e.fadeOut(500,function(){$(this).remove()})}function a(e,n){const i=n.timeout,l=setTimeout(function(){t(e),typeof n.timeoutfn=="function"&&n.timeoutfn(e,n)},i);e.attr("timeoutId",l),e.css("transition-property","none"),e.removeClass("animate"),setTimeout(function(){e.css("transition-property",""),e.css("transition","width "+(i+450)+"ms linear, background-color "+(i+450)+"ms ease-in"),e.addClass("animate"),r.fire("action:alert.animate",{alert:e,params:n})},50),e.on("mouseenter",function(){$(this).css("transition-duration",0)})}return u}.apply(_,h),s!==void 0&&(v.exports=s)},7237:(v,_,g)=>{var h;h=function(){const s={};return s.core={"topic/teaser":function(o){return o?$('[component="category/topic"][data-tid="'+o+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(o,c){return $('[component="topic"][data-'+o+'="'+c+'"]')},post:function(o,c){return $('[component="post"][data-'+o+'="'+c+'"]')},"post/content":function(o){return $('[component="post"][data-pid="'+o+'"] [component="post/content"]')},"post/header":function(o){return $('[component="post"][data-pid="'+o+'"] [component="post/header"]')},"post/anchor":function(o){return $('[component="post"][data-index="'+o+'"] [component="post/anchor"]')},"post/vote-count":function(o){return $('[component="post"][data-pid="'+o+'"] [component="post/vote-count"]')},"post/bookmark-count":function(o){return $('[component="post"][data-pid="'+o+'"] [component="post/bookmark-count"]')},"user/postcount":function(o){return $('[component="user/postcount"][data-uid="'+o+'"]')},"user/reputation":function(o){return $('[component="user/reputation"][data-uid="'+o+'"]')},"category/topic":function(o,c){return $('[component="category/topic"][data-'+o+'="'+c+'"]')},"categories/category":function(o,c){return $('[component="categories/category"][data-'+o+'="'+c+'"]')},"chat/message":function(o){return $('[component="chat/message"][data-mid="'+o+'"]')},"chat/message/body":function(o){return $('[component="chat/message"][data-mid="'+o+'"] [component="chat/message/body"]')},"chat/recent/room":function(o){return $('[component="chat/recent/room"][data-roomid="'+o+'"]')}},s.get=function(){const o=Array.prototype.slice.call(arguments,1);return s.core[arguments[0]]&&o.length?s.core[arguments[0]].apply(this,o):$('[component="'+arguments[0]+'"]')},s}.call(_,g,_,v),h!==void 0&&(v.exports=h)},7073:(v,_,g)=>{var h,s;h=[g(32230),g(66603),g(85233),g(7927)],s=function(o,c,r,u){const f={current:{}};f.init=function(t){if(!config.searchEnabled)return;t=t||{in:config.searchDefaultInQuick||"titles"};const a=$("#search-button"),e=$("#search-fields"),n=$("#search-fields input"),i=$("#quick-search-container");$("#search-form .advanced-search-link").off("mousedown").on("mousedown",function(){ajaxify.go("/search")}),$("#search-form").off("submit").on("submit",function(){n.blur()}),n.off("blur").on("blur",function(){setTimeout(function(){n.is(":focus")||(e.addClass("hidden"),a.removeClass("hidden"))},200)}),n.off("focus");const l={inputEl:n,resultEl:i};f.enableQuickSearch({searchOptions:t,searchElements:l}),a.off("click").on("click",function(m){return!config.loggedIn&&!app.user.privileges["search:content"]?(u.alert({message:"[[error:search-requires-login]]",timeout:3e3}),ajaxify.go("login"),!1):(m.stopPropagation(),f.showAndFocusInput(),!1)}),$("#search-form").off("submit").on("submit",function(){const m=$(this).find("input"),d=f.getSearchPreferences();return d.term=m.val(),d.in=t.in,r.fire("action:search.submit",{searchOptions:d,searchElements:l}),f.query(d,function(){m.val("")}),!1})},f.enableQuickSearch=function(t){if(!config.searchEnabled||!app.user.privileges["search:content"])return;const a=Object.assign({in:config.searchDefaultInQuick||"titles"},t.searchOptions),e=t.searchElements.resultEl,n=t.searchElements.inputEl;let i=n.val();const l=e.find(".filter-category");function m(){ajaxify.data.template.category&&ajaxify.data.cid&&o.translate("[[search:search-in-category, "+ajaxify.data.name+"]]",function(p){const y=$("<div></div>").html(p).text();l.find(".name").text(y)}),l.toggleClass("hidden",!(ajaxify.data.template.category&&ajaxify.data.cid))}function d(){t.searchOptions=Object.assign({},a),t.searchOptions.term=n.val(),m(),ajaxify.data.template.category&&ajaxify.data.cid&&l.find('input[type="checkbox"]').is(":checked")&&(t.searchOptions.categories=[ajaxify.data.cid],t.searchOptions.searchChildren=!0),e.removeClass("hidden").find(".quick-search-results-container").html(""),e.find(".loading-indicator").removeClass("hidden"),r.fire("action:search.quick.start",t),t.searchOptions.searchOnly=1,f.api(t.searchOptions,function(p){if(e.find(".loading-indicator").addClass("hidden"),!p.posts||t.hideOnNoMatches&&!p.posts.length)return e.addClass("hidden").find(".quick-search-results-container").html("");p.posts.forEach(function(y){const E=$("<div>"+y.content+"</div>").text(),k=n.val().toLowerCase().replace(/^in:topic-\d+/,""),b=Math.max(0,E.toLowerCase().indexOf(k)-40);y.snippet=utils.escapeHTML((b>0?"...":"")+E.slice(b,b+80)+(E.length-b>80?"...":""))}),app.parseAndTranslate("partials/quick-search-results",p,function(y){y.length&&y.find(".timeago").timeago(),e.toggleClass("hidden",!y.length||!n.is(":focus")).find(".quick-search-results-container").html(y.length?y:"");const E=e.find(".quick-search-results .quick-search-title, .quick-search-results .snippet");f.highlightMatches(t.searchOptions.term,E),r.fire("action:search.quick.complete",{data:p,options:t})})})}e.find('.filter-category input[type="checkbox"]').on("change",function(){n.focus(),d()}),n.off("keyup").on("keyup",utils.debounce(function(){if(n.val().length<3){e.addClass("hidden"),i=n.val();return}if(n.val()!==i){if(i=n.val(),!n.is(":focus"))return e.addClass("hidden");d()}},500));let x=!1;e.on("mousedown",function(){$(window).one("mouseup",function(){e.addClass("hidden")}),x=!0}),n.on("blur",function(){!n.is(":focus")&&!x&&!e.hasClass("hidden")&&e.addClass("hidden")});let I=!1;r.on("action:ajaxify.end",function(){ajaxify.isCold()||(I=!0)}),n.on("focus",function(){x=!1;const p=n.val();i=p,p&&e.find("#quick-search-results").children().length&&(m(),I?(d(),I=!1):e.removeClass("hidden"),n[0].setSelectionRange(p.startsWith("in:topic")?p.indexOf(" ")+1:0,p.length))}),n.off("refresh").on("refresh",function(){d()})},f.showAndFocusInput=function(){$("#search-fields").removeClass("hidden"),$("#search-button").addClass("hidden"),$("#search-fields input").focus()},f.query=function(t,a){a=a||function(){},ajaxify.go("search?"+C(t)),a()},f.api=function(t,a){const e=config.relative_path+"/api/search?"+C(t);t.searchOnly=void 0;const n=config.relative_path+"/search?"+C(t);$.get(e,function(i){i.url=n,a(i)})};function C(t){const a=t.in||"titles",e=t.by||"";let n=t.term.replace(/^[ ?#]*/,"");try{n=encodeURIComponent(n)}catch{return u.error("[[error:invalid-search-term]]")}const i={term:n,in:a};return t.matchWords&&(i.matchWords=t.matchWords),e&&e.length&&(a==="posts"||a==="titles"||a==="titlesposts")&&(i.by=e),t.categories&&t.categories.length&&(i.categories=t.categories,t.searchChildren&&(i.searchChildren=t.searchChildren)),t.hasTags&&t.hasTags.length&&(i.hasTags=t.hasTags),parseInt(t.replies,10)>0&&(i.replies=t.replies,i.repliesFilter=t.repliesFilter||"atleast"),t.timeRange&&(i.timeRange=t.timeRange,i.timeFilter=t.timeFilter||"newer"),t.sortBy&&(i.sortBy=t.sortBy,i.sortDirection=t.sortDirection),t.showAs&&(i.showAs=t.showAs),t.searchOnly&&(i.searchOnly=t.searchOnly),r.fire("action:search.createQueryString",{query:i,data:t}),decodeURIComponent($.param(i))}return f.getSearchPreferences=function(){try{return JSON.parse(c.getItem("search-preferences")||"{}")}catch{return{}}},f.highlightMatches=function(t,a){if(!t||!a.length)return;t=utils.escapeHTML(t.replace(/^"/,"").replace(/"$/,"").trim());const e=t.split(" ").map(function(i){return utils.escapeRegexChars(i)}).join("|"),n=new RegExp("("+e+")","gi");a.each(function(){const i=$(this),l=[];i.find("*").each(function(){$(this).after("<!-- "+l.length+" -->"),l.push($("<div></div>").append($(this)))}),i.html(i.html().replace(n,function(m,d){return'<strong class="search-match">'+d+"</strong>"})),l.forEach(function(m,d){i.html(i.html().replace("<!-- "+d+" -->",function(){return m.html()}))})}),$(".search-result-text").find("img:not(.not-responsive)").addClass("img-responsive")},f}.apply(_,h),s!==void 0&&(v.exports=s)},66603:(v,_,g)=>{var h;h=function(){function s(){this._store={},this._keys=[]}s.prototype.isMock=!0,s.prototype.setItem=function(r,u){r=String(r),this._keys.indexOf(r)===-1&&this._keys.push(r),this._store[r]=u},s.prototype.getItem=function(r){return r=String(r),this._keys.indexOf(r)===-1?null:this._store[r]},s.prototype.removeItem=function(r){r=String(r),this._keys=this._keys.filter(function(u){return u!==r}),this._store[r]=null},s.prototype.clear=function(){this._keys=[],this._store={}},s.prototype.key=function(r){return r=parseInt(r,10)||0,this._keys[r]},Object.defineProperty&&Object.defineProperty(s.prototype,"length",{get:function(){return this._keys.length}});let o;const c=Date.now().toString();try{if(o=window.localStorage,o.setItem(c,c),o.getItem(c)!==c)throw Error("localStorage behaved unexpectedly");return o.removeItem(c),o}catch(r){console.warn(r),console.warn("localStorage failed, falling back on sessionStorage");try{if(o=window.sessionStorage,o.setItem(c,c),o.getItem(c)!==c)throw Error("sessionStorage behaved unexpectedly");return o.removeItem(c),o}catch(u){return console.warn(u),console.warn("sessionStorage failed, falling back on memory storage"),new s}}}.call(_,g,_,v),h!==void 0&&(v.exports=h)}}]);
