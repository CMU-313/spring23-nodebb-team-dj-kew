"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[3564],{50431:(l,a,p)=>{var f,u;f=[p(86569)],u=function(){const t={};t.show=function(e,s){const n=e.hasOwnProperty("fileSize")&&e.fileSize!==void 0?parseInt(e.fileSize,10):!1;app.parseAndTranslate("partials/modals/upload_file_modal",{showHelp:e.hasOwnProperty("showHelp")&&e.showHelp!==void 0?e.showHelp:!0,fileSize:n,title:e.title||"[[global:upload_file]]",description:e.description||"",button:e.button||"[[global:upload]]",accept:e.accept?e.accept.replace(/,/g,"&#44; "):""},function(r){r.modal("show"),r.on("hidden.bs.modal",function(){r.remove()});const i=r.find("#uploadForm");i.attr("action",e.route),i.find("#params").val(JSON.stringify(e.params)),r.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),i.submit()}),i.submit(function(){return m(r,n,s),!1})})},t.hideAlerts=function(e){$(e).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function m(e,s,n){o(e,"status","[[uploads:uploading-file]]"),e.find("#upload-progress-bar").css("width","0%"),e.find("#upload-progress-box").show().removeClass("hide");const r=e.find("#fileInput");if(!r.val())return o(e,"error","[[uploads:select-file-to-upload]]");if(!b(r[0],s))return o(e,"error","[[error:file-too-big, "+s+"]]");t.ajaxSubmit(e,n)}function o(e,s,n){t.hideAlerts(e),s==="error"&&e.find("#fileUploadSubmitBtn").removeClass("disabled"),e.find("#alert-"+s).translateText(n).removeClass("hide")}t.ajaxSubmit=function(e,s){e.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(r){r=c(r),o(e,"error",r.responseJSON?r.responseJSON.error||r.statusText:"error uploading, code : "+r.status)},uploadProgress:function(r,i,h,d){e.find("#upload-progress-bar").css("width",d+"%")},success:function(r){let i=c(r);r.hasOwnProperty("response")&&r.hasOwnProperty("status")&&r.status.code==="ok"&&(i=r.response.images),s(i[0].url),o(e,"success","[[uploads:upload-success]]"),setTimeout(function(){t.hideAlerts(e),e.modal("hide")},750)}})};function c(e){if(typeof e=="string")try{return $.parseJSON(e)}catch{return{error:"[[error:parse-error]]"}}return e}function b(e,s){return window.FileReader&&s?e.files[0].size<=s*1e3:!0}return t}.apply(a,f),u!==void 0&&(l.exports=u)}}]);
