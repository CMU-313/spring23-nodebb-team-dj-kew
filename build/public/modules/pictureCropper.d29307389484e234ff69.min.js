"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[2550,7214,6503,8786,5655],{7927:(g,h,u)=>{var m,f;m=[u(32230),u(7237),u(85233)],f=function(o,l,D){const d={};d.alert=function(t){t.alert_id="alert_button_"+(t.alert_id?t.alert_id:new Date().getTime()),t.title=t.title&&t.title.trim()||"",t.message=t.message?t.message.trim():"",t.type=t.type||"info";const n=$("#"+t.alert_id);n.length?e(n,t):y(t)},d.success=function(t,n){d.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:t,type:"success",timeout:n||5e3})},d.error=function(t,n){if(t=t&&t.message||t,t==="[[error:revalidate-failure]]"){socket.disconnect(),app.reconnect();return}d.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:t,type:"danger",timeout:n||1e4})},d.remove=function(t){$("#alert_button_"+t).remove()};function y(t){app.parseAndTranslate("alert",t,function(n){let s=$("#"+t.alert_id);if(s.length)return e(s,t);s=n,s.fadeIn(200),l.get("toaster/tray").prepend(s),typeof t.closefn=="function"&&s.find("button").on("click",function(){return t.closefn(),a(s),!1}),t.timeout&&i(s,t),typeof t.clickfn=="function"&&s.addClass("pointer").on("click",function(r){$(r.target).is(".close")||t.clickfn(s,t),a(s)}),D.fire("action:alert.new",{alert:s,params:t})})}function e(t,n){t.find("strong").translateHtml(n.title),t.find("p").translateHtml(n.message),t.attr("class","alert alert-dismissable alert-"+n.type+" clearfix"),clearTimeout(parseInt(t.attr("timeoutId"),10)),n.timeout&&i(t,n),D.fire("action:alert.update",{alert:t,params:n}),t.off("click").removeClass("pointer"),typeof n.clickfn=="function"&&t.addClass("pointer").on("click",function(s){$(s.target).is(".close")||n.clickfn(),a(t)})}function a(t){t.fadeOut(500,function(){$(this).remove()})}function i(t,n){const s=n.timeout,r=setTimeout(function(){a(t),typeof n.timeoutfn=="function"&&n.timeoutfn(t,n)},s);t.attr("timeoutId",r),t.css("transition-property","none"),t.removeClass("animate"),setTimeout(function(){t.css("transition-property",""),t.css("transition","width "+(s+450)+"ms linear, background-color "+(s+450)+"ms ease-in"),t.addClass("animate"),D.fire("action:alert.animate",{alert:t,params:n})},50),t.on("mouseenter",function(){$(this).css("transition-duration",0)})}return d}.apply(h,m),f!==void 0&&(g.exports=f)},7237:(g,h,u)=>{var m;m=function(){const f={};return f.core={"topic/teaser":function(o){return o?$('[component="category/topic"][data-tid="'+o+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(o,l){return $('[component="topic"][data-'+o+'="'+l+'"]')},post:function(o,l){return $('[component="post"][data-'+o+'="'+l+'"]')},"post/content":function(o){return $('[component="post"][data-pid="'+o+'"] [component="post/content"]')},"post/header":function(o){return $('[component="post"][data-pid="'+o+'"] [component="post/header"]')},"post/anchor":function(o){return $('[component="post"][data-index="'+o+'"] [component="post/anchor"]')},"post/vote-count":function(o){return $('[component="post"][data-pid="'+o+'"] [component="post/vote-count"]')},"post/bookmark-count":function(o){return $('[component="post"][data-pid="'+o+'"] [component="post/bookmark-count"]')},"user/postcount":function(o){return $('[component="user/postcount"][data-uid="'+o+'"]')},"user/reputation":function(o){return $('[component="user/reputation"][data-uid="'+o+'"]')},"category/topic":function(o,l){return $('[component="category/topic"][data-'+o+'="'+l+'"]')},"categories/category":function(o,l){return $('[component="categories/category"][data-'+o+'="'+l+'"]')},"chat/message":function(o){return $('[component="chat/message"][data-mid="'+o+'"]')},"chat/message/body":function(o){return $('[component="chat/message"][data-mid="'+o+'"] [component="chat/message/body"]')},"chat/recent/room":function(o){return $('[component="chat/recent/room"][data-roomid="'+o+'"]')}},f.get=function(){const o=Array.prototype.slice.call(arguments,1);return f.core[arguments[0]]&&o.length?f.core[arguments[0]].apply(this,o):$('[component="'+arguments[0]+'"]')},f}.call(h,u,h,g),m!==void 0&&(g.exports=m)},98192:(g,h,u)=>{var m,f;m=[u(7927)],f=function(o){const l={};l.show=function(e,a){const i=e.hasOwnProperty("fileSize")&&e.fileSize!==void 0?parseInt(e.fileSize,10):!1;app.parseAndTranslate("partials/modals/upload_file_modal",{showHelp:e.hasOwnProperty("showHelp")&&e.showHelp!==void 0?e.showHelp:!0,fileSize:i,title:e.title||"[[global:upload_file]]",description:e.description||"",button:e.button||"[[global:upload]]",accept:e.accept?e.accept.replace(/,/g,"&#44; "):""},function(t){t.modal("show"),t.on("hidden.bs.modal",function(){t.remove()});const n=t.find("#uploadForm");e.route&&n.attr("action",e.route),t.find("#fileUploadSubmitBtn").on("click",function(){return $(this).addClass("disabled"),e.uploadModal=t,y(e,a),!1})})},l.handleImageCrop=function(e,a){$("#crop-picture-modal").remove(),app.parseAndTranslate("modals/crop_picture",{url:utils.escapeHTML(e.url)},async function(i){i.modal({backdrop:"static"}).modal("show");const t=parseInt($(window).height()/2,10),n=document.getElementById("cropped-image");$(n).css("max-height",t);const s=(await u.e(1649).then(u.t.bind(u,33129,23))).default;let r=new s(n,{aspectRatio:e.aspectRatio,autoCropArea:1,viewMode:1,checkCrossOrigin:!0,cropmove:function(){e.restrictImageDimension&&(r.cropBoxData.width>e.imageDimension&&r.setCropBoxData({width:e.imageDimension}),r.cropBoxData.height>e.imageDimension&&r.setCropBoxData({height:e.imageDimension}))},ready:function(){if(!d(r,e))return i.modal("hide");if(e.restrictImageDimension){const c=n.width<n.height?n.width:n.height,p=c>e.imageDimension?e.imageDimension:c;r.setCropBoxData({width:p,height:p})}i.find(".rotate").on("click",function(){const c=this.getAttribute("data-degrees");r.rotate(c)}),i.find(".flip").on("click",function(){const c=this.getAttribute("data-option");this.getAttribute("data-method")==="scaleX"?r.scaleX(c):r.scaleY(c),this.setAttribute("data-option",c*-1)}),i.find(".reset").on("click",function(){r.reset()}),i.find(".crop-btn").on("click",function(){$(this).addClass("disabled");const c=d(r,e);c&&(i.find("#upload-progress-bar").css("width","0%"),i.find("#upload-progress-box").show().removeClass("hide"),D({data:e,imageData:c,progressBarEl:i.find("#upload-progress-bar")},function(p,C){if(p)return i.find("#upload-progress-box").hide(),i.find(".upload-btn").removeClass("disabled"),i.find(".crop-btn").removeClass("disabled"),o.error(p);a(C.url),i.modal("hide")}))}),i.find(".upload-btn").on("click",async function(){$(this).addClass("disabled"),r.destroy();const c=(await u.e(1649).then(u.t.bind(u,33129,23))).default;r=new c(n,{viewMode:1,autoCropArea:1,ready:function(){i.find(".crop-btn").trigger("click")}})})}})})};function D(e,a){const i={};i[e.data.paramName]=e.data.paramValue,i.method=e.data.socketMethod,i.size=e.imageData.length,i.progress=0;const t=1e5;function n(){const s=e.imageData.slice(i.progress,i.progress+t);socket.emit("uploads.upload",{chunk:s,params:i},function(r,c){if(r)return o.error(r);if(i.progress+t<i.size)return i.progress+=s.length,e.progressBarEl.css("width",(i.progress/i.size*100).toFixed(2)+"%"),setTimeout(n,100);e.progressBarEl.css("width","100%"),a(null,c)})}n()}function d(e,a){let i;try{i=a.imageType?e.getCroppedCanvas().toDataURL(a.imageType):e.getCroppedCanvas().toDataURL()}catch(t){["The operation is insecure.","Failed to execute 'toDataURL' on 'HTMLCanvasElement': Tainted canvases may not be exported."].indexOf(t.message)!==-1?o.error("[[error:cors-error]]"):o.error(t.message);return}return i}function y(e,a){function i(c,p){c==="error"&&e.uploadModal.find("#fileUploadSubmitBtn").removeClass("disabled"),e.uploadModal.find("#alert-"+c).translateText(p).removeClass("hide")}const t=e.uploadModal.find("#fileInput");if(!t.val())return i("error","[[uploads:select-file-to-upload]]");const n=t[0].files[0],s=e.hasOwnProperty("fileSize")&&e.fileSize!==void 0?parseInt(e.fileSize,10):!1;if(s&&n.size>s*1024)return i("error","[[error:file-too-big, "+s+"]]");if(n.name.endsWith(".gif")){u.e(3564).then(function(){var c=[u(50431)];(function(p){p.ajaxSubmit(e.uploadModal,a)}).apply(null,c)}).catch(u.oe);return}const r=new FileReader;r.addEventListener("load",function(){const c=r.result;e.uploadModal.modal("hide"),l.handleImageCrop({url:c,imageType:n.type,socketMethod:e.socketMethod,aspectRatio:e.aspectRatio,allowSkippingCrop:e.allowSkippingCrop,restrictImageDimension:e.restrictImageDimension,imageDimension:e.imageDimension,paramName:e.paramName,paramValue:e.paramValue},a)},!1),n&&r.readAsDataURL(n)}return l}.apply(h,m),f!==void 0&&(g.exports=f)}}]);
