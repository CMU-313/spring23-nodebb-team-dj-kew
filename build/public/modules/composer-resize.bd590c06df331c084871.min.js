"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[882,3034],{38259:(p,_,k)=>{var R,m;R=[k(27145)],m=function(I){var g={},f=0,e=.3,z=.05,y=992,B=$("body"),v=$(window),t=$('[component="navbar"]'),i=document.body,a=t[0];function o(){return localStorage.getItem("composer:resizeRatio")||.5}function s(n){localStorage.setItem("composer:resizeRatio",Math.min(n,1))}function c(){var n;a?n=a.getBoundingClientRect():n={bottom:0};var d=Math.max(n.bottom,0),r={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};return r.width=r.right,r.height=r.bottom,r.boundedTop=d,r.boundedHeight=r.bottom-d,r}function S(n,d){var r=c(),l=n[0],C=window.getComputedStyle(l),N=parseInt(C.getPropertyValue("min-height"),10),D=Math.max(N/window.innerHeight,e);if(r.width>=y){const M=(r.height-r.boundedHeight)/r.height;d=Math.min(Math.max(d,D+M),1);var x=d*r.boundedHeight/r.height;l.style.top=((1-x)*100).toString()+"%";var A=l.getBoundingClientRect();i.style.paddingBottom=(A.bottom-A.top).toString()+"px"}else n.removeAttr("style"),i.style.paddingBottom=0;n.ratio=d,l.style.visibility="visible",I.updateActive(n.attr("data-uuid"))}var w=S,F=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return F&&(w=function(n,d){F(function(){S(n,d),setTimeout(function(){v.trigger("action:composer.resize"),n.trigger("action:composer.resize")},0)})}),g.reposition=function(n){var d=o();d>=1-z&&(d=1,n.addClass("maximized")),w(n,d)},g.maximize=function(n,d){d?w(n,1):g.reposition(n)},g.handleResize=function(n){var d=0,r=0,l=0,C=n.find(".resizer"),N=C[0];function D(u){var E=N.getBoundingClientRect(),h=(E.top+E.bottom)/2;d=(h-u.clientY)/2,r=u.clientY,v.on("mousemove",x),v.on("mouseup",A),B.on("touchmove",M)}function x(u){var E=u.clientY-d,h=c(),b=(h.height-E)/h.boundedHeight;w(n,b)}function A(u){u.preventDefault(),l=u.clientY,n.find("textarea").focus(),v.off("mousemove",x),v.off("mouseup",A),B.off("touchmove",M);var E=l-d,h=c(),b=(h.height-E)/h.boundedHeight;l-r===0&&n.hasClass("maximized")?(n.removeClass("maximized"),b=!f||f>=1-z?.5:f,w(n,b)):l-r===0||b>=1-z?(w(n,1),n.addClass("maximized"),f=b):n.removeClass("maximized"),s(b)}function M(u){u.preventDefault(),x(u.touches[0])}C.on("mousedown",function(u){u.preventDefault(),D(u)}).on("touchstart",function(u){u.preventDefault(),D(u.touches[0])}).on("touchend",A)},g}.apply(_,R),m!==void 0&&(p.exports=m)},27145:(p,_,k)=>{p=k.nmd(p);var R,m;R=[k(59006),k(32230),k(85233)],m=function(I,g,f){const e={};e.init=function(){const t=this;I.render("modules/taskbar",{}).then(function(i){t.taskbar=$(i),t.tasklist=t.taskbar.find("ul"),$(document.body).append(t.taskbar),t.taskbar.on("click","li",async function(){const a=$(this),o=a.attr("data-module"),s=a.attr("data-uuid"),c=await app.require(o);return a.hasClass("active")?c.minimize(s):(y(),c.load(s),e.toggleNew(s,!1),e.tasklist.removeClass("active"),a.addClass("active")),!1})}),$(window).on("action:app.loggedOut",function(){e.closeAll()})},e.close=async function(t,i){const a=e.tasklist.find('[data-module="'+p+'"][data-uuid="'+i+'"]');let o="close";if(t==="chat"&&(o="closeByUUID"),a.length){const s=await app.require(t);s&&typeof s[o]=="function"&&s[o](i)}},e.closeAll=function(t){let i="[data-uuid]";t&&(i='[data-module="'+t+'"]'+i),e.tasklist.find(i).each(function(a,o){e.close(t||o.getAttribute("data-module"),o.getAttribute("data-uuid"))})},e.discard=function(t,i){e.tasklist.find('[data-module="'+t+'"][data-uuid="'+i+'"]').remove(),z()},e.push=function(t,i,a,o){o=o||function(){};const s=e.tasklist.find('li[data-uuid="'+i+'"]'),c={module:t,uuid:i,options:a,element:s};f.fire("filter:taskbar.push",c),!s.length&&c.module?B(c,o):o(s)},e.get=function(t){return $('[data-module="'+t+'"]').map(function(a,o){return $(o).data()})},e.minimize=function(t,i){e.tasklist.find('[data-module="'+t+'"][data-uuid="'+i+'"]').toggleClass("active",!1)},e.toggleNew=function(t,i,a){e.tasklist.find('[data-uuid="'+t+'"]').toggleClass("new",i),a||f.fire("action:taskbar.toggleNew",t)},e.updateActive=function(t){const i=e.tasklist.find("li");i.removeClass("active"),i.filter('[data-uuid="'+t+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+t+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},e.isActive=function(t){return e.tasklist.find('li[data-uuid="'+t+'"]').hasClass("active")};function z(){e.tasklist.find("li").length>0?e.taskbar.attr("data-active","1"):e.taskbar.removeAttr("data-active")}function y(){e.tasklist.find(".active").removeClass("active")}function B(t,i){g.translate(t.options.title,function(a){const o=$("<div></div>").text(a||"NodeBB Task").html(),s=$("<li></li>").addClass(t.options.className).html('<a href="#"'+(t.options.image?` style="background-image: url('`+t.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(t.options.icon?'<i class="fa '+t.options.icon+'"></i> ':"")+'<span aria-label="'+o+'" component="taskbar/title">'+o+"</span></a>").attr({title:o,"data-module":t.module,"data-uuid":t.uuid}).addClass(t.options.state!==void 0?t.options.state:"active");(!t.options.state||t.options.state==="active")&&y(),e.tasklist.append(s),z(),t.element=s,s.data(t),f.fire("action:taskbar.pushed",t),i(s)})}const v=function(t,i,a){switch(i){case"title":t.find('[component="taskbar/title"]').text(a);break;case"icon":t.find("i").attr("class","fa fa-"+a);break;case"image":t.find("a").css("background-image",a?'url("'+a.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":t.find("a").css("background-color",a);break}};return e.update=function(t,i,a){const o=e.tasklist.find('[data-module="'+t+'"][data-uuid="'+i+'"]');if(!o.length)return;const s=o.data();Object.keys(a).forEach(function(c){s[c]=a[c],v(o,c,a[c])}),o.data(s)},e}.apply(_,R),m!==void 0&&(p.exports=m)}}]);
