"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[9764,3564],{99764:(w,k,p)=>{var b,d;b=[p(50431),p(42441),p(85233),p(7927),p(18340)],d=function(c,y,u,g,S){const e={};e.populateTOC=function(){const t=$(".settings-header");if(t.length>1){t.each(function(){const o=$(this).text(),i=o.toLowerCase().replace(/ /g,"-").trim();$(this).prepend('<a name="'+i+'"></a>'),$(".section-content ul").append('<li><a href="#'+i+'">'+o+"</a></li>")});const a=$('a[name="'+window.location.hash.replace("#","")+'"]');a.length&&$("html, body").animate({scrollTop:a.offset().top+"px"},400)}else $(".content-header").parents(".row").remove()},e.prepare=function(t){const a=$("#content [data-field]"),o=a.length,i=$("#save"),m=$("#revert");let l,h,_,r;a.on("change",function(){app.flags=app.flags||{},app.flags._unsaved=!0});const x=["text","hidden","password","textarea","number"];for(l=0;l<o;l+=1)if(r=a.eq(l),h=r.attr("data-field"),_=r.attr("type"),app.config.hasOwnProperty(h))if(r.is("input")&&_==="checkbox"){const v=parseInt(app.config[h],10)===1;r.prop("checked",v),r.parents(".mdl-switch").toggleClass("is-checked",v)}else(r.is("textarea")||r.is("select")||r.is("input")&&x.indexOf(_)!==-1)&&r.val(app.config[h]);m.off("click").on("click",function(){ajaxify.refresh()}),i.off("click").on("click",function(v){v.preventDefault(),S.check(document.querySelectorAll("#content [data-field]"))&&n(a,function(A){if(A)return g.alert({alert_id:"config_status",timeout:2500,title:"[[admin/admin:changes-not-saved]]",message:`[[admin/admin:changes-not-saved-message, ${A.message}]]`,type:"danger"});app.flags._unsaved=!1,g.alert({alert_id:"config_status",timeout:2500,title:"[[admin/admin:changes-saved]]",message:"[[admin/admin:changes-saved-message]]",type:"success"}),u.fire("action:admin.settingsSaved")})}),y.bind("ctrl+s",function(v){i.click(),v.preventDefault()}),s(),f(),$("#clear-sitemap-cache").off("click").on("click",function(){return socket.emit("admin.settings.clearSitemapCache",function(){g.success("Sitemap Cache Cleared!")}),!1}),typeof t=="function"&&t(),setTimeout(function(){u.fire("action:admin.settingsLoaded")},0)};function s(){$('#content input[data-action="upload"]').each(function(){const t=$(this);t.on("click",function(){c.show({title:t.attr("data-title"),description:t.attr("data-description"),route:t.attr("data-route"),params:{},showHelp:t.attr("data-help")?t.attr("data-help")===1:void 0,accept:t.attr("data-accept")},function(a){$("#"+t.attr("data-target")).val(a)})})})}function f(){$('[data-field-type="tagsinput"]').tagsinput({confirmKeys:[13,44],trimValue:!0}),app.flags._unsaved=!1}e.remove=function(t){socket.emit("admin.config.remove",t)};function n(t,a){const o={};t.each(function(){const i=$(this),m=i.attr("data-field");let l,h;if(i.is("input"))switch(h=i.attr("type"),h){case"text":case"password":case"hidden":case"textarea":case"number":l=i.val();break;case"checkbox":l=i.prop("checked")?"1":"0";break}else(i.is("textarea")||i.is("select"))&&(l=i.val());o[m]=l}),socket.emit("admin.config.setMultiple",o,function(i){if(i)return a(i);for(const m in o)o.hasOwnProperty(m)&&(app.config[m]=o[m]);a()})}return e}.apply(k,b),d!==void 0&&(w.exports=d)},50431:(w,k,p)=>{var b,d;b=[p(86569)],d=function(){const c={};c.show=function(e,s){const f=e.hasOwnProperty("fileSize")&&e.fileSize!==void 0?parseInt(e.fileSize,10):!1;app.parseAndTranslate("partials/modals/upload_file_modal",{showHelp:e.hasOwnProperty("showHelp")&&e.showHelp!==void 0?e.showHelp:!0,fileSize:f,title:e.title||"[[global:upload_file]]",description:e.description||"",button:e.button||"[[global:upload]]",accept:e.accept?e.accept.replace(/,/g,"&#44; "):""},function(n){n.modal("show"),n.on("hidden.bs.modal",function(){n.remove()});const t=n.find("#uploadForm");t.attr("action",e.route),t.find("#params").val(JSON.stringify(e.params)),n.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),t.submit()}),t.submit(function(){return y(n,f,s),!1})})},c.hideAlerts=function(e){$(e).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function y(e,s,f){u(e,"status","[[uploads:uploading-file]]"),e.find("#upload-progress-bar").css("width","0%"),e.find("#upload-progress-box").show().removeClass("hide");const n=e.find("#fileInput");if(!n.val())return u(e,"error","[[uploads:select-file-to-upload]]");if(!S(n[0],s))return u(e,"error","[[error:file-too-big, "+s+"]]");c.ajaxSubmit(e,f)}function u(e,s,f){c.hideAlerts(e),s==="error"&&e.find("#fileUploadSubmitBtn").removeClass("disabled"),e.find("#alert-"+s).translateText(f).removeClass("hide")}c.ajaxSubmit=function(e,s){e.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(n){n=g(n),u(e,"error",n.responseJSON?n.responseJSON.error||n.statusText:"error uploading, code : "+n.status)},uploadProgress:function(n,t,a,o){e.find("#upload-progress-bar").css("width",o+"%")},success:function(n){let t=g(n);n.hasOwnProperty("response")&&n.hasOwnProperty("status")&&n.status.code==="ok"&&(t=n.response.images),s(t[0].url),u(e,"success","[[uploads:upload-success]]"),setTimeout(function(){c.hideAlerts(e),e.modal("hide")},750)}})};function g(e){if(typeof e=="string")try{return $.parseJSON(e)}catch{return{error:"[[error:parse-error]]"}}return e}function S(e,s){return window.FileReader&&s?e.files[0].size<=s*1e3:!0}return c}.apply(k,b),d!==void 0&&(w.exports=d)}}]);
