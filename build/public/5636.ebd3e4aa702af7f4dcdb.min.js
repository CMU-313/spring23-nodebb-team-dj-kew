"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[5636],{25636:(m,_,l)=>{var d,s;d=[l(7237),l(3547),l(7927)],s=function(g,t,a){const r={};let n,e,p;r.init=function(){p=ajaxify.data.tid,$(window).off("action:ajaxify.end",u).on("action:ajaxify.end",u),!n&&app.parseAndTranslate("partials/fork_thread_modal",{},function(f){n=f,e=n.find("#fork_thread_commit"),$("body").append(n),n.find(".close,#fork_thread_cancel").on("click",k),n.find("#fork-title").on("keyup",c),t.init(function(){c(),o()}),o(),e.on("click",i)})};function u(){(ajaxify.data.template.name!=="topic"||ajaxify.data.tid!==p)&&(k(),$(window).off("action:ajaxify.end",u))}function i(){e.attr("disabled",!0),socket.emit("topics.createTopicFromPosts",{title:n.find("#fork-title").val(),pids:t.pids,fromTid:p},function(f,h){function E(b){g.get("post","pid",b).fadeOut(500,function(){$(this).remove()})}if(e.removeAttr("disabled"),f)return a.error(f.message);a.alert({timeout:5e3,title:"[[global:alert.success]]",message:"[[topic:fork_success]]",type:"success",clickfn:function(){ajaxify.go("topic/"+h.slug)}}),t.pids.forEach(function(b){E(b)}),k()})}function o(){t.pids.length?n.find("#fork-pids").translateHtml("[[topic:fork_pid_count, "+t.pids.length+"]]"):n.find("#fork-pids").translateHtml("[[topic:fork_no_pids]]")}function c(){n.find("#fork-title").val().length&&t.pids.length?e.removeAttr("disabled"):e.attr("disabled",!0)}function k(){n&&(n.remove(),n=null,t.disable())}return r}.apply(_,d),s!==void 0&&(m.exports=s)},3547:(m,_,l)=>{var d,s;d=[l(7237)],s=function(g){const t={};let a;t.pids=[];let r=!1;t.init=function(i,o){t.pids.length=0,a=i,o=o||{},r=o.allowMainPostSelect||!1,$("#content").on("click",'[component="topic"] [component="post"]',n),p()};function n(i){i.stopPropagation();const o=$(this).attr("data-pid"),c=$('[component="topic"] [data-pid="'+o+'"]');!r&&parseInt($(this).attr("data-index"),10)===0||t.togglePostSelection(c,o)}t.disable=function(){t.pids.forEach(function(i){g.get("post","pid",i).toggleClass("bg-success",!1)}),$("#content").off("click",'[component="topic"] [component="post"]',n),u()},t.togglePostSelection=function(i,o){if(o){const c=t.pids.indexOf(o);c===-1?(t.pids.push(o),i.toggleClass("bg-success",!0)):(t.pids.splice(c,1),i.toggleClass("bg-success",!1)),t.pids.length&&t.pids.sort(function(k,f){return k-f}),typeof a=="function"&&a()}};function e(){return!1}function p(){$("#content").on("click",'[component="post"] button, [component="post"] a',e)}function u(){$("#content").off("click",'[component="post"] button, [component="post"] a',e)}return t}.apply(_,d),s!==void 0&&(m.exports=s)}}]);
