"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[8596,3014],{18596:(g,E,o)=>{var h,u;h=[o(7237),o(74344),o(7927)],u=function(p,r,d){const i={};i.init=function(){p.get("chat/search").on("keyup",utils.debounce(e,250))};function e(){const t=p.get("chat/search").val();if(!t)return $('[component="chat/search/list"]').empty();r.get("/api/users",{query:t,searchBy:"username",paginate:!1}).then(s).catch(d.error)}function s(t){const n=$('[component="chat/search/list"]');if(n.empty(),t.users=t.users.filter(function(c){return parseInt(c.uid,10)!==parseInt(app.user.uid,10)}),!t.users.length)return n.translateHtml("<li><div><span>[[users:no-users-found]]</span></div></li>");t.users.forEach(function(c){const l=a(n,c);f(l,c)}),n.parent().toggleClass("open",!0)}function a(t,n){function c(){return(n.picture?'<img src="'+n.picture+'" title="'+n.username+'" />':'<div class="user-icon" style="background-color: '+n["icon:bgColor"]+'">'+n["icon:text"]+"</div>")+'<i class="fa fa-circle status '+n.status+'"></i> '+n.username}const l=$('<li component="chat/search/user"></li>').attr("data-uid",n.uid).appendTo(t);return l.append(c()),l}function f(t,n){t.on("click",function(){socket.emit("modules.chats.hasPrivateChat",n.uid,function(c,l){if(c)return d.error(c);l?Promise.all([o.e(2441),o.e(4074),o.e(3216),o.e(524),o.e(1018)]).then(function(){var m=[o(30524)];(function(y){y.switchChat(l)}).apply(null,m)}).catch(o.oe):o.e(3216).then(function(){var m=[o(93216)];(function(y){y.newChat(n.uid)}).apply(null,m)}).catch(o.oe)})})}return i}.apply(E,h),u!==void 0&&(g.exports=u)},74344:(g,E,o)=>{var h,u;h=[o(85233)],u=(p=>{const r={},d=config.relative_path+"/api/v3";function i(e,s){e.url=e.url.startsWith("/api")?config.relative_path+e.url:d+e.url;async function a(f){({options:e}=await p.fire("filter:api.options",{options:e})),$.ajax(e).done(t=>{f(null,t&&t.hasOwnProperty("status")&&t.hasOwnProperty("response")?t.response:t||{})}).fail(t=>{let n;t.responseJSON&&(n=t.responseJSON.status&&t.responseJSON.status.message?t.responseJSON.status.message:t.responseJSON.error),f(new Error(n||t.statusText))})}if(typeof s=="function"){a(s);return}return new Promise((f,t)=>{a(function(n,c){n?t(n):f(c)})})}return r.get=(e,s,a)=>i({url:e+(s&&Object.keys(s).length?"?"+$.param(s):"")},a),r.head=(e,s,a)=>i({url:e+(s&&Object.keys(s).length?"?"+$.param(s):""),method:"head"},a),r.post=(e,s,a)=>i({url:e,method:"post",data:JSON.stringify(s||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},a),r.patch=(e,s,a)=>i({url:e,method:"patch",data:JSON.stringify(s||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},a),r.put=(e,s,a)=>i({url:e,method:"put",data:JSON.stringify(s||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},a),r.del=(e,s,a)=>i({url:e,method:"delete",data:JSON.stringify(s),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},a),r.delete=r.del,r}).apply(E,h),u!==void 0&&(g.exports=u)}}]);
